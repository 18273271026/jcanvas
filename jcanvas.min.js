/*
 jCanvas v6.1b
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
(function(c,S,W,Q,X,w,F,j,A){function C(){}function G(b){b?B(Y,b):G.prefs=Y=C.prototype=B({},O);return this}function J(b,a){b.fillStyle=a.fillStyle;b.strokeStyle=a.strokeStyle;b.lineWidth=a.strokeWidth;a.rounded?(b.lineCap="round",b.lineJoin="round"):(b.lineCap=a.strokeCap,b.lineJoin=a.strokeJoin,b.miterLimit=a.miterLimit);b.shadowOffsetX=a.shadowX;b.shadowOffsetY=a.shadowY;b.shadowBlur=a.shadowBlur;b.shadowColor=a.shadowColor;b.globalAlpha=a.opacity;b.globalCompositeOperation=a.compositing}function z(b){return b&&
b.getContext?b.getContext("2d"):j}function M(b,a){a.closed&&b.closePath();b.fill();"transparent"!==a.fillStyle&&(b.shadowColor="transparent");b.stroke();a.closed||b.closePath();a._toRad&&b.restore();a.mask&&(a.autosave&&b.save(),b.clip())}function Z(b,a){if(!a.translateX&&!a.translateY&&(a.x||a.y))a.translateX=a.x,a.translateY=a.y;a.translate&&(a.translateX=a.translateY=a.translate);b.translate(a.translateX,a.translateY)}function $(b,a){1!==a.scale&&(a.scaleX=a.scaleY=a.scale);b.translate(a.x,a.y);
b.scale(a.scaleX,a.scaleY);b.translate(-a.x,-a.y)}function aa(b,a){a._toRad=a.inDegrees?D/180:1;a.rotate=a.rotate||a.angle;b.translate(a.x,a.y);b.rotate(a.rotate*a._toRad);b.translate(-a.x,-a.y)}function I(b,a,d,g,i){d._toRad=d.inDegrees?D/180:1;a.save();i=i||g;!b&&!d.fromCenter&&(d.x+=g/2,d.y+=i/2);(d.rotate||d.angle)&&aa(a,d);(1!==d.scale||1!==d.scaleX||1!==d.scaleY)&&$(a,d);(d.translate||d.translateX||d.translateY)&&Z(a,d)}function T(b){b.draggable&&(b.translateX+=b.x,b.translateY+=b.y)}function R(b){var a;
E.elem===b?a=E.data:((a=c.data(b,"jCanvas"))||(a=c.data(b,"jCanvas",{layers:[],intersects:[],drag:{},event:{}})),E.elem=b,E.data=a);return a}function ba(b,a,d){d&&d.visible&&(d.method===c.fn.draw?d.fn.call(b[0],a):d.method&&d.method.call(b,d))}function H(b,a,d){var g,i,f,t="function"===typeof a,o,a=a||{};if(a.layer&&!a._layer){g=c(b);i=g.getLayers();t&&(a={method:c.fn.draw,fn:a});a=B(new C,a);if(!t){a.method=c.fn[a.method]||d;o=R(b);for(f in G.events)G.events.hasOwnProperty(f)&&a[f]&&(G.events[f](g,
o),a._event=w);if(a.draggable||a.cursor){a._event=w;b=["mousedown","mousemove","mouseup"];for(d=0;d<b.length;d+=1)f=b[d],G.events[f](g,o);o.mouseout||(g.bind("mouseout.jCanvas",function(){o.drag={};g.drawLayers()}),o.mouseout=w)}}a.layer=w;a._layer=w;a.index===A&&(a.index=i.length);i.splice(a.index,0,a)}}function ca(b){var a;for(a=0;a<K.length;a+=1)b[K[a]]=b["_"+K[a]]}function da(b,a){var d;for(d=0;d<K.length;d+=1)b["_"+K[d]]=b[K[d]],U[K[d]]=1,a&&delete b[K[d]]}function ea(b){var a,d,g=[],i=1;b.match(/^#?\w+$/i)&&
("transparent"===b&&(b="rgba(0,0,0,0)"),d=S.head,a=d.style.color,d.style.color=b,b=c.css(d,"color"),d.style.color=a);b.match(/^rgb/i)&&(g=b.match(/\d+/gi),b.match(/%/gi)&&(i=2.55),g[0]*=i,g[1]*=i,g[2]*=i,g[3]=g[3]!==A?X(g[3]):1);return g}function ha(b){var a=3,d;"object"!==typeof b.start&&(b.start=ea(b.start),b.end=ea(b.end));b.now=[];if(1!==b.start[3]||1!==b.end[3])a=4;for(d=0;d<a;d+=1)b.now[d]=b.start[d]+(b.end[d]-b.start[d])*b.pos,3>d&&(b.now[d]=P(b.now[d]));1!==b.start[3]||1!==b.end[3]?b.now=
"rgba("+b.now.join(",")+")":(b.now.slice(0,3),b.now="rgb("+b.now.join(",")+")");b.elem.nodeName?b.elem.style[b.prop]=b.now:b.elem[b.prop]=b.now}function N(b){G.events[b]=function(a,d){var g="mouseover"===b||"mouseout"===b?"mousemove":b,i=d.event;d[g]||(a.bind(g+".jCanvas",function(b){i.x=b.offsetX;i.y=b.offsetY;i.type=g;a.drawLayers(w);b.preventDefault()}),d[g]=w)}}function L(b,a,d){var b=R(b),g=b.event,a=a.isPointInPath(g.x,g.y);d.mouseX=g.x;d.mouseY=g.y;!a&&(d._hovered&&!d._fired)&&(d._mousedout=
w);a&&b.intersects.push(d)}function fa(b,a,d,g,i){var f=/\b(\d*\.?\d*)\w\w\b/gi,t;if(E.text===g.text&&E.font===g.font&&E.maxWidth===g.maxWidth&&E.lineHeight===g.lineHeight)g.width=E.width,g.height=E.height;else if(!a){g.width=d.measureText(i[0]).width;for(a=1;a<i.length;a+=1)t=d.measureText(i[a]).width,t>g.width&&(g.width=t);d=b.style.fontSize;if(a=g.font.match(f))b.style.fontSize=g.font.match(f)[0];g.height=X(c.css(b,"fontSize"))*i.length*g.lineHeight;b.style.fontSize=d}}var O,Y,B=c.extend,P=Q.round,
D=Q.PI,ga=Q.sin,V=Q.cos,ia=c.event.fix,E={},K,U;c.fn.jCanvas=G;G.version="6.1b";G.events={};O={angle:0,align:"center",autosave:w,baseline:"middle",bringToFront:F,ccw:F,closed:F,compositing:"source-over",cornerRadius:0,cropFromCenter:w,draggable:F,disableDrag:F,each:j,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:w,height:j,inDegrees:w,lineHeight:1,load:j,mask:F,maxWidth:j,method:j,miterLimit:10,opacity:1,projection:0,r1:j,r2:j,radius:0,repeat:"repeat",rotate:0,rounded:F,scale:1,
scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:j,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:j,sx:j,sy:j,text:"",translate:0,translateX:0,translateY:0,visible:w,width:j,x:0,y:0};G();G.extend=function(b){O=B(O,b.props);G();b.name&&(c.fn[b.name]=function d(g){var i,f,t,c=B(new C,g);for(f=0;f<this.length;f+=1)if(i=this[f],t=z(i))H(this[f],g,d),J(t,c),b.fn.call(i,t,c);return this});return c.fn[b.name]};
c.fn.getLayers=function(){var b=this[0];return!b||!b.getContext?[]:R(b).layers};c.fn.getLayer=function(b){var a=this.getLayers(),d=c.type(b),g,i;if(b&&b.layer)g=b;else if("number"===d)g=a[b];else for(i=0;i<a.length;i+=1)if(a[i].index=i,a[i].name===b||"regexp"===d&&a[i].name.match(b)){g=a[i];break}return g};c.fn.setLayer=function(b,a){var d,g;b===A&&(a=b,b=0);for(d=0;d<this.length;d+=1)g=c(this[d]).getLayer(b),B(g,a);return this};c.fn.removeLayer=function(b){var a,d,g;for(d=0;d<this.length;d+=1)a=
c(this[d]),g=a.getLayers(),(a=a.getLayer(b))&&g.splice(a.index,1);return this};c.fn.removeLayers=function(){var b,a;for(a=0;a<this.length;a+=1)b=c(this[a]).getLayers(),b.length=0;return this};c.fn.getLayerGroup=function(b){var a=this.getLayers(),d=c.type(b),g=[],i;for(i=0;i<a.length;i+=1)a[i].index=i,(a[i].group===b||"regexp"===d&&a[i].group.match(b))&&g.push(a[i]);return g};c.fn.setLayerGroup=function(b,a){var d,g=c.type(b),i,f;for(d=0;d<this.length;d+=1){i=c(this[d]).getLayers();for(f=0;f<i.length;f+=
1)(i[f].group===b||"regexp"===g&&i[f].group.match(b))&&B(i[f],a)}return this};c.fn.removeLayerGroup=function(b){var a,d=c.type(b),g,i;if(b!==A)for(a=0;a<this.length;a+=1){g=c(this[a]).getLayers();for(i=0;i<g.length;i+=1)if(g[i].group===b||"regexp"===d&&g[i].group.match(b))g.splice(i,1),i-=1}return this};c.fn.drawLayer=function(b){var a,d,g,i;for(a=0;a<this.length;a+=1)g=c(this[a]),d=z(this[a]),i=g.getLayer(b),ba(g,d,i);return this};c.fn.drawLayers=function(b){var a,d,g,i,f,t,o,s;for(d=0;d<this.length;d+=
1)if(a=c(this[d]),g=z(this[d])){g.clearRect(0,0,this[d].width,this[d].height);E.elem===this[d]?o=E.data:(o=R(this[d]),E.elem=this[d],E.data=o);i=o.layers;for(t=0;t<i.length;t+=1)if(f=i[t],f.index=t,b&&(f._fired=F),ba(a,g,f),f._mousedout)f._mousedout=F,f._fired=w,f._hovered=F,f.mouseout&&f.mouseout.call(this[d],f),f.cursor&&f._cursor&&a.css({cursor:f._cursor});f=o.intersects[o.intersects.length-1]||{};g=o.event;g=g.type;s=f[g];t=o.drag;if(f._event){if((f.mouseover||f.mouseout||f.cursor)&&!f._hovered&&
!f._fired)f._fired=w,f._hovered=w,f.mouseover&&f.mouseover.call(this[d],f),f.cursor&&(f._cursor=a.css("cursor"),a.css({cursor:f.cursor}));s&&!f._fired&&(f._fired=w,s.call(this[d],f));f.draggable&&(!f.disableDrag&&"mousedown"===g)&&(f.bringToFront&&(i.splice(f.index,1),f.index=i.push(f)),t.layer=f,t.dragging=w,t.startX=f.x,t.startY=f.y,t.endX=f.mouseX,t.endY=f.mouseY,f.dragstart&&f.dragstart.call(this[d],f))}if(t.layer&&(t.dragging&&"mouseup"===g&&(t.layer.dragstop&&t.layer.dragstop.call(this[d],t.layer),
o.drag={}),t.dragging&&"mousemove"===g))t.layer.x=t.layer.mouseX-(t.endX-t.startX),t.layer.y=t.layer.mouseY-(t.endY-t.startY),t.layer.drag&&t.layer.drag.call(this[d],t.layer)}o.intersects=[];return this};c.fn.addLayer=function(b){var a,d,b=b||{};for(a=0;a<this.length;a+=1)if(d=z(this[a]))b.layer=w,H(this[a],b);return this};K=["width","height","opacity","lineHeight"];U={};c.fn.animateLayer=function(){function b(a,b){return function(){ca(b);a.drawLayers();f[4]&&f[4].call(a[0],b)}}function a(a,b){return function(d,
g){ca(b);a.drawLayers();f[5]&&f[5].call(a[0],d,g,b)}}var d,g,i,f=[].slice.call(arguments,0);"object"===typeof f[0]&&!f[0].layer&&f.unshift(0);"object"===typeof f[2]?(f.splice(2,0,f[2].duration||j),f.splice(3,0,f[3].easing||j),f.splice(4,0,f[4].complete||j),f.splice(5,0,f[5].step||j)):(f[2]===A?(f.splice(2,0,j),f.splice(3,0,j),f.splice(4,0,j)):"function"===typeof f[2]&&(f.splice(2,0,j),f.splice(3,0,j)),f[3]===A)?(f[3]=j,f.splice(4,0,j)):"function"===typeof f[3]&&f.splice(3,0,j);f[1]=B({},f[1]);for(g=
0;g<this.length;g+=1)if(d=c(this[g]),i=z(this[g]))if((i=d.getLayer(f[0]))&&i.method!==c.fn.draw)da(i),da(f[1],w),i.style=U,c(i).animate(f[1],{duration:f[2],easing:c.easing[f[3]]?f[3]:j,complete:b(d,i),step:a(d,i)});return this};c.fn.animateLayerGroup=function(b){var a,d,g=[].slice.call(arguments,0),i,f;for(d=0;d<this.length;d+=1){a=c(this[d]);i=a.getLayerGroup(b);for(f=0;f<i.length;f+=1)a.animateLayer.apply(a,[i[f]].concat(g.slice(1)))}};c.fn.delayLayer=function(b,a){var d,g,a=a||0;for(d=0;d<this.length;d+=
1)g=c(this[d]).getLayer(b),c(g).delay(a);return this};c.fn.delayLayerGroup=function(b,a){var d,g,i,f,a=a||0;for(g=0;g<this.length;g+=1){d=c(this[g]);i=d.getLayerGroup(b);for(f=0;f<i.length;f+=1)d.delayLayer.call(d,b,a)}};c.fn.stopLayer=function(b,a){var d,g;for(d=0;d<this.length;d+=1)g=c(this[d]).getLayer(b),c(g).stop(a);return this};c.fn.stopLayerGroup=function(b,a){var d,g,i,f;for(g=0;g<this.length;g+=1){d=c(this[g]);i=d.getLayerGroup(b);for(f=0;f<i.length;f+=1)d.stopLayer.call(d,b,a)}};(function(b){var a;
for(a=0;a<b.length;a+=1)c.fx.step[b[a]]=ha})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));N("click");N("dblclick");N("mousedown");N("mouseup");N("mousemove");N("mouseover");N("mouseout");c.event.fix=function(b){var a,b=ia.call(c.event,b);if(b.pageX!==A&&b.offsetX===A&&(a=c(b.target).offset()))b.offsetX=b.pageX-a.left,b.offsetY=b.pageY-a.top;return b};c.fn.draw=function a(d){var g,i,
d=d||{};"function"===typeof d&&(d={fn:d});for(g=0;g<this.length;g+=1)if((i=z(this[g]))&&d.fn)H(this[g],d,a),d.fn.call(this[g],i);return this};c.fn.clearCanvas=function(a){for(var d,g=B(new C,a),a=0;a<this.length;a+=1)if(d=z(this[a]))I(a,d,g,g.width,g.height),!g.x||!g.y||!g.width||!g.height?d.clearRect(0,0,this[a].width,this[a].height):d.clearRect(g.x-g.width/2,g.y-g.height/2,g.width,g.height);return this};c.fn.saveCanvas=function(){var a,d;for(a=0;a<this.length;a+=1)(d=z(this[a]))&&d.save();return this};
c.fn.restoreCanvas=function(){var a,d;for(a=0;a<this.length;a+=1)(d=z(this[a]))&&d.restore();return this};c.fn.translateCanvas=function(a){for(var d,g=B(new C,a),a=0;a<this.length;a+=1)if(d=z(this[a]))g.autosave&&d.save(),Z(d,g);return this};c.fn.scaleCanvas=function(a){for(var d,g=B(new C,a),a=0;a<this.length;a+=1)if(d=z(this[a]))g.autosave&&d.save(),$(d,g);return this};c.fn.rotateCanvas=function(a){for(var d,g=B(new C,a),a=0;a<this.length;a+=1)if(d=z(this[a]))g.autosave&&d.save(),aa(d,g);return this};
c.fn.drawRect=function d(g){var i,f,c=B(new C,g),o,s,u,q,k;for(i=0;i<this.length;i+=1)if(f=z(this[i]))H(this[i],g,d),J(f,c),I(i,f,c,c.width,c.height),f.beginPath(),o=c.x-c.width/2,s=c.y-c.height/2,(k=c.cornerRadius)?(c.closed=w,u=c.x+c.width/2,q=c.y+c.height/2,0>u-o-2*k&&(k=(u-o)/2),0>q-s-2*k&&(k=(q-s)/2),f.moveTo(o+k,s),f.lineTo(u-k,s),f.arc(u-k,s+k,k,3*D/2,2*D,F),f.lineTo(u,q-k),f.arc(u-k,q-k,k,0,D/2,F),f.lineTo(o+k,q),f.arc(o+k,q-k,k,D/2,D,F),f.lineTo(o,s+k),f.arc(o+k,s+k,k,D,3*D/2,F)):f.rect(o,
s,c.width,c.height),c._event&&L(this[i],f,g),M(f,c);return this};c.fn.drawArc=function g(i){var f,c,o=B(new C,i),i=i||{};!o.inDegrees&&360===o.end&&(i.end=o.end=2*D);for(f=0;f<this.length;f+=1)if(c=z(this[f]))H(this[f],i,g),J(c,o),I(f,c,o,2*o.radius),c.beginPath(),c.arc(o.x,o.y,o.radius,o.start*o._toRad-D/2,o.end*o._toRad-D/2,o.ccw),o._event&&L(this[f],c,i),M(c,o);return this};c.fn.drawEllipse=function i(f){var c,o,s=B(new C,f),u=4*s.width/3,q=s.height;s.closed=w;for(c=0;c<this.length;c+=1)if(o=z(this[c]))H(this[c],
f,i),J(o,s),I(c,o,s,s.width,s.height),o.beginPath(),o.moveTo(s.x,s.y-q/2),o.bezierCurveTo(s.x-u/2,s.y-q/2,s.x-u/2,s.y+q/2,s.x,s.y+q/2),o.bezierCurveTo(s.x+u/2,s.y+q/2,s.x+u/2,s.y-q/2,s.x,s.y-q/2),s._event&&L(this[c],o,f),M(o,s);return this};c.fn.drawPolygon=function f(c){var o,s,u=B(new C,c),q=2*D/u.sides,k=D/u.sides,m=k+D/2,n=u.radius*V(q/2),p,j,l;u.closed=w;for(o=0;o<this.length;o+=1)if(s=z(this[o])){H(this[o],c,f);J(s,u);I(o,s,u,2*u.radius);s.beginPath();for(l=0;l<u.sides;l+=1)p=u.x+P(u.radius*
V(m)),j=u.y+P(u.radius*ga(m)),s.lineTo(p,j),u.projection&&(p=u.x+P((n+n*u.projection)*V(m+k)),j=u.y+P((n+n*u.projection)*ga(m+k)),s.lineTo(p,j)),m+=q;u._event&&L(this[o],s,c);M(s,u)}return this};c.fn.drawLine=function t(c){var j,u,q=B(new C,c),k,m,n;for(j=0;j<this.length;j+=1)if(u=z(this[j])){H(this[j],c,t);J(u,q);T(q);I(j,u,q,0);k=1;for(u.beginPath();w;)if(m=q["x"+k],n=q["y"+k],m!==A&&n!==A)u.lineTo(m,n),k+=1;else break;q._event&&L(this[j],u,c);M(u,q)}return this};c.fn.drawQuad=function o(c){var j,
q,k=B(new C,c),m,n,p,r,l;for(j=0;j<this.length;j+=1)if(q=z(this[j])){H(this[j],c,o);J(q,k);T(k);I(j,q,k,0);m=2;q.beginPath();for(q.moveTo(k.x1,k.y1);w;)if(n=k["x"+m],p=k["y"+m],r=k["cx"+(m-1)],l=k["cy"+(m-1)],n!==A&&p!==A&&r!==A&&l!==A)q.quadraticCurveTo(r,l,n,p),m+=1;else break;k._event&&L(this[j],q,c);M(q,k)}return this};c.fn.drawBezier=function s(c){var q,k,j=B(new C,c),n,p,r,l,h,v,x,y;for(q=0;q<this.length;q+=1)if(k=z(this[q])){H(this[q],c,s);J(k,j);T(j);I(q,k,j,0);n=2;p=1;k.beginPath();for(k.moveTo(j.x1,
j.y1);w;)if(r=j["x"+n],l=j["y"+n],h=j["cx"+p],v=j["cy"+p],x=j["cx"+(p+1)],y=j["cy"+(p+1)],r!==A&&l!==A&&h!==A&&v!==A&&x!==A&&y!==A)k.bezierCurveTo(h,v,x,y,r,l),n+=1,p+=2;else break;j._event&&L(this[q],k,c);M(k,j)}return this};c.fn.drawText=function u(q){var k,m,n=B(new C,q),p,r,l,h;for(k=0;k<this.length;k+=1)if(c(this[k]),m=z(this[k])){H(this[k],q,u);J(m,n);m.textBaseline=n.baseline;m.textAlign=n.align;m.font=n.font;if(!k&&n.maxWidth!==j){p=m;r=n.text;h=n.maxWidth;var v=n.text.split(" "),x=[],y="";
if(p.measureText(r).width<h)x=[r];else for(;0<v.length;)p.measureText(y+v[0]).width<h?y+=v.shift()+" ":(x.push(y),y=""),0===v.length&&x.push(y);p=x;p=p.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}else k||(p=(""+n.text).split("\n"));fa(this[k],k,m,n,p);I(k,m,n,n.width,n.height);k||(l=n.x,"left"===n.align?l-=n.width/2:"right"===n.align&&(l+=n.width/2));for(r=0;r<p.length;r+=1)m.shadowColor=n.shadowColor,h=n.y+r*n.height/p.length-(p.length-1)*n.height/p.length/2,m.fillText(p[r],l,h),"transparent"!==
n.fillStyle&&(m.shadowColor="transparent"),m.strokeText(p[r],n.x,h);n._event?(m.beginPath(),m.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),m.restore(),L(this[k],m,q),m.closePath()):m.restore()}E=n;return this};c.fn.measureText=function(c){var j;j=c!==A&&"object"!==typeof c?this.getLayer(c):B(new C,c);(c=z(this[0]))&&j.text!==A&&fa(this[0],e,c,j,j.text.split("\n"));return j};c.fn.drawImage=function q(c){function m(q,l,m){return function(){l||((y=v.width/v.height,h.width===j&&h.sWidth===j&&(c.width=
h.width=h.sWidth=v.width),h.height===j&&h.sHeight===j&&(c.height=h.height=h.sHeight=v.height),h.width===j&&h.sWidth!==j&&(h.width=h.sWidth),h.height===j&&h.sHeight!==j&&(h.height=h.sHeight),h.sWidth===j&&h.width!==j&&(c.sWidth=h.sWidth=v.width),h.sHeight===j&&h.height!==j&&(c.sHeight=h.sHeight=v.height),h.sx===j&&(h.sx=h.cropFromCenter?v.width/2:0),h.sy===j&&(h.sy=h.cropFromCenter?v.height/2:0),h.cropFromCenter||(h.sx+=h.sWidth/2,h.sy+=h.sHeight/2),h.sx+h.sWidth/2>v.width&&(h.sx=v.width-h.sWidth/
2),0>h.sx-h.sWidth/2&&(h.sx=h.sWidth/2),0>h.sy-h.sHeight/2&&(h.sy=h.sHeight/2),h.sy+h.sHeight/2>v.height&&(h.sy=v.height-h.sHeight/2),h.width!==j&&h.height===j)?c.height=h.height=h.width/y:h.width===j&&h.height!==j?c.width=h.width=h.height*y:h.width===j&&h.height===j&&(c.width=h.width=v.width,c.height=h.height=v.height));I(l,m,h,h.width,h.height);m.drawImage(v,h.sx-h.sWidth/2,h.sy-h.sHeight/2,h.sWidth,h.sHeight,h.x-h.width/2,h.y-h.height/2,h.width,h.height);h._event?(m.beginPath(),m.rect(h.x-h.width/
2,h.y-h.height/2,h.width,h.height),m.restore(),L(n[l],m,c),m.closePath()):m.restore();h.load&&h.load.call(q,c)}}var n=this,p,r,l,h=B(new C,c),v,x,y;x=h.source.getContext;h.source.src||x?(v=h.source,h.width=v.width,h.height=v.height):h.source&&(v=new W,v.src=h.source);for(r=0;r<n.length;r+=1)if(p=n[r],l=z(n[r]))H(n[r],c,q),J(l,h),v&&(v.complete||x?m(p,r,l)():v.onload=m(p,r,l));return n};c.fn.createPattern=c.fn.pattern=function(c){function k(){l=n.createPattern(r,p.repeat);p.load&&p.load.call(m[0],
l)}var m=this,n,p=B(new C,c),r,l;(n=z(m[0]))?"function"===typeof p.source?(r=S.createElement("canvas"),r.width=p.width,r.height=p.height,c=z(r),p.source.call(r,c),k()):(c=p.source.getContext,p.source.src||c?r=p.source:(r=new W,r.src=p.source),r.complete||c?k():r.onload=k):l=j;return l};c.fn.createGradient=c.fn.gradient=function(c){var k,c=B(new C,c),m=[],n,p,r,l,h,v,x;if(k=z(this[0])){c.x1=c.x1||0;c.y1=c.y1||0;c.x2=c.x2||0;c.y2=c.y2||0;k=c.r1!==j||c.r2!==j?k.createRadialGradient(c.x1,c.y1,c.r1,c.x2,
c.y2,c.r2):k.createLinearGradient(c.x1,c.y1,c.x2,c.y2);for(l=1;c["c"+l]!==A;l+=1)c["s"+l]!==A?m.push(c["s"+l]):m.push(j);n=m.length;m[0]===j&&(m[0]=0);m[n-1]===j&&(m[n-1]=1);for(l=0;l<n;l+=1){if(m[l]!==j){v=1;x=0;p=m[l];for(h=l+1;h<n;h+=1)if(m[h]!==j){r=m[h];break}else v+=1;p>r&&(m[h]=m[l])}else m[l]===j&&(x+=1,m[l]=p+x*((r-p)/v));k.addColorStop(m[l],c["c"+(l+1)])}}else k=j;return k};c.fn.setPixels=function k(c){var j,p,r,l=B(new C,c),h={},v,x,y,w;for(p=0;p<this.length;p+=1)if(j=this[p],r=z(j)){H(this[p],
c,k);I(p,r,l,l.width,l.height);if(!l.x||!l.y||!l.width||!l.height)l.width=j.width,l.height=j.height,l.x=l.width/2,l.y=l.height/2;v=r.getImageData(l.x-l.width/2,l.y-l.height/2,l.width,l.height);x=v.data;w=x.length;h=[];if(l.each)for(y=0;y<w;y+=4)h.r=x[y],h.g=x[y+1],h.b=x[y+2],h.a=x[y+3],l.each.call(j,h),x[y]=h.r,x[y+1]=h.g,x[y+2]=h.b,x[y+3]=h.a;r.putImageData(v,l.x-l.width/2,l.y-l.height/2);r.restore()}return this};c.fn.getCanvasImage=function(c,m){var n=this[0];return n&&n.toDataURL?n.toDataURL("image/"+
c,m):j};c.support.canvas=S.createElement("canvas").getContext!==A;G.defaults=O;c.jCanvas=G})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
