/*
 jCanvas v6.1b
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
(function(c,R,V,P,W,v,F,i,z){function B(){}function C(b){b?A(X,b):C.prefs=X=B.prototype=A({},N);return this}function I(b,a){b.fillStyle=a.fillStyle;b.strokeStyle=a.strokeStyle;b.lineWidth=a.strokeWidth;a.rounded?(b.lineCap="round",b.lineJoin="round"):(b.lineCap=a.strokeCap,b.lineJoin=a.strokeJoin,b.miterLimit=a.miterLimit);b.shadowOffsetX=a.shadowX;b.shadowOffsetY=a.shadowY;b.shadowBlur=a.shadowBlur;b.shadowColor=a.shadowColor;b.globalAlpha=a.opacity;b.globalCompositeOperation=a.compositing}function y(b){return b&&
b.getContext?b.getContext("2d"):i}function L(b,a){a.closed&&b.closePath();b.fill();"transparent"!==a.fillStyle&&(b.shadowColor="transparent");b.stroke();a.closed||b.closePath();a._toRad&&b.restore();a.mask&&(a.autosave&&b.save(),b.clip())}function Y(b,a){if(!a.translateX&&!a.translateY&&(a.x||a.y))a.translateX=a.x,a.translateY=a.y;a.translate&&(a.translateX=a.translateY=a.translate);b.translate(a.translateX,a.translateY)}function Z(b,a){1!==a.scale&&(a.scaleX=a.scaleY=a.scale);b.translate(a.x,a.y);
b.scale(a.scaleX,a.scaleY);b.translate(-a.x,-a.y)}function $(b,a){a._toRad=a.inDegrees?D/180:1;a.rotate=a.rotate||a.angle;b.translate(a.x,a.y);b.rotate(a.rotate*a._toRad);b.translate(-a.x,-a.y)}function H(b,a,d,f,h){d._toRad=d.inDegrees?D/180:1;a.save();h=h||f;!b&&!d.fromCenter&&(d.x+=f/2,d.y+=h/2);(d.rotate||d.angle)&&$(a,d);(1!==d.scale||1!==d.scaleX||1!==d.scaleY)&&Z(a,d);(d.translate||d.translateX||d.translateY)&&Y(a,d)}function S(b){b.draggable&&(b.translateX+=b.x,b.translateY+=b.y)}function Q(b){var a;
E.elem===b?a=E.data:((a=c.data(b,"jCanvas"))||(a=c.data(b,"jCanvas",{layers:[],intersects:[],drag:{},event:{}})),E.elem=b,E.data=a);return a}function aa(b,a,d){d&&d.visible&&(d.method===c.fn.draw?d.fn.call(b[0],a):d.method&&d.method.call(b,d))}function G(b,a,d){var f,h,e,s="function"===typeof a,n,a=a||{};if(a.layer&&!a._layer){f=c(b);h=f.getLayers();s&&(a={method:c.fn.draw,fn:a});a=A(new B,a);if(!s){a.method=c.fn[a.method]||d;n=Q(b);for(e in C.events)C.events.hasOwnProperty(e)&&a[e]&&(C.events[e](f,
n),a._event=v);if(a.draggable||a.cursor){a._event=v;b=["mousedown","mousemove","mouseup"];for(d=0;d<b.length;d+=1)e=b[d],C.events[e](f,n);n.mouseout||(f.bind("mouseout.jCanvas",function(){n.drag={};f.drawLayers()}),n.mouseout=v)}}a.layer=v;a._layer=v;a.index===z&&(a.index=h.length);h.splice(a.index,0,a)}}function ba(b){var a;for(a=0;a<J.length;a+=1)b[J[a]]=b["_"+J[a]]}function ca(b,a){var d;for(d=0;d<J.length;d+=1)b["_"+J[d]]=b[J[d]],T[J[d]]=1,a&&delete b[J[d]]}function da(b){var a,d,f=[],h=1;b.match(/^#?\w+$/i)&&
("transparent"===b&&(b="rgba(0,0,0,0)"),d=R.head,a=d.style.color,d.style.color=b,b=c.css(d,"color"),d.style.color=a);b.match(/^rgb/i)&&(f=b.match(/\d+/gi),b.match(/%/gi)&&(h=2.55),f[0]*=h,f[1]*=h,f[2]*=h,f[3]=f[3]!==z?W(f[3]):1);return f}function ga(b){var a=3,d;"object"!==typeof b.start&&(b.start=da(b.start),b.end=da(b.end));b.now=[];if(1!==b.start[3]||1!==b.end[3])a=4;for(d=0;d<a;d+=1)b.now[d]=b.start[d]+(b.end[d]-b.start[d])*b.pos,3>d&&(b.now[d]=O(b.now[d]));1!==b.start[3]||1!==b.end[3]?b.now=
"rgba("+b.now.join(",")+")":(b.now.slice(0,3),b.now="rgb("+b.now.join(",")+")");b.elem.nodeName?b.elem.style[b.prop]=b.now:b.elem[b.prop]=b.now}function M(b){C.events[b]=function(a,d){var f="mouseover"===b||"mouseout"===b?"mousemove":b,h=d.event;d[f]||(a.bind(f+".jCanvas",function(b){h.x=b.offsetX;h.y=b.offsetY;h.type=f;a.drawLayers(v);b.preventDefault()}),d[f]=v)}}function K(b,a,d){var b=Q(b),f=b.event,a=a.isPointInPath(f.x,f.y);d.mouseX=f.x;d.mouseY=f.y;!a&&(d._hovered&&!d._fired)&&(d._mousedout=
v);a&&b.intersects.push(d)}function ea(b,a,d,f,h){var e=/\b(\d*\.?\d*)\w\w\b/gi,s;if(E.text===f.text&&E.font===f.font&&E.maxWidth===f.maxWidth&&E.lineHeight===f.lineHeight)f.width=E.width,f.height=E.height;else if(!a){f.width=d.measureText(h[0]).width;for(a=1;a<h.length;a+=1)s=d.measureText(h[a]).width,s>f.width&&(f.width=s);d=b.style.fontSize;if(a=f.font.match(e))b.style.fontSize=f.font.match(e)[0];f.height=W(c.css(b,"fontSize"))*h.length*f.lineHeight;b.style.fontSize=d}}var N,X,A=c.extend,O=P.round,
D=P.PI,fa=P.sin,U=P.cos,ha=c.event.fix,E={},J,T;c.fn.jCanvas=C;C.version="6.1b";C.events={};N={angle:0,align:"center",autosave:v,baseline:"middle",bringToFront:F,ccw:F,closed:F,compositing:"source-over",cornerRadius:0,cropFromCenter:v,draggable:F,disableDrag:F,each:i,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:v,height:i,inDegrees:v,lineHeight:1,load:i,mask:F,maxWidth:i,method:i,miterLimit:10,opacity:1,projection:0,r1:i,r2:i,radius:0,repeat:"repeat",rotate:0,rounded:F,scale:1,
scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:i,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:i,sx:i,sy:i,text:"",translate:0,translateX:0,translateY:0,visible:v,width:i,x:0,y:0};C();C.extend=function(b){C.defaults=N=A(N,b.props);C();b.name&&(c.fn[b.name]=function d(f){var h,e,s,c=A(new B,f);for(e=0;e<this.length;e+=1)if(h=this[e],s=y(h))G(h,f,d),I(s,c),b.fn.call(h,s,c);return this});return c.fn[b.name]};
c.fn.getLayers=function(){var b=this[0];return!b||!b.getContext?[]:Q(b).layers};c.fn.getLayer=function(b){var a=this.getLayers(),d=c.type(b),f,h;if(b&&b.layer)f=b;else if("number"===d)f=a[b];else for(h=0;h<a.length;h+=1)if(a[h].index=h,a[h].name===b||"regexp"===d&&a[h].name.match(b)){f=a[h];break}return f};c.fn.setLayer=function(b,a){var d,f;b===z&&(a=b,b=0);for(d=0;d<this.length;d+=1)f=c(this[d]).getLayer(b),A(f,a);return this};c.fn.removeLayer=function(b){var a,d,f;for(d=0;d<this.length;d+=1)a=
c(this[d]),f=a.getLayers(),(a=a.getLayer(b))&&f.splice(a.index,1);return this};c.fn.removeLayers=function(){var b,a;for(a=0;a<this.length;a+=1)b=c(this[a]).getLayers(),b.length=0;return this};c.fn.getLayerGroup=function(b){var a=this.getLayers(),d=c.type(b),f=[],h;for(h=0;h<a.length;h+=1)a[h].index=h,(a[h].group===b||"regexp"===d&&a[h].group.match(b))&&f.push(a[h]);return f};c.fn.setLayerGroup=function(b,a){var d,f=c.type(b),h,e;for(d=0;d<this.length;d+=1){h=c(this[d]).getLayers();for(e=0;e<h.length;e+=
1)(h[e].group===b||"regexp"===f&&h[e].group.match(b))&&A(h[e],a)}return this};c.fn.removeLayerGroup=function(b){var a,d=c.type(b),f,h;if(b!==z)for(a=0;a<this.length;a+=1){f=c(this[a]).getLayers();for(h=0;h<f.length;h+=1)if(f[h].group===b||"regexp"===d&&f[h].group.match(b))f.splice(h,1),h-=1}return this};c.fn.drawLayer=function(b){var a,d,f,h;for(a=0;a<this.length;a+=1)f=c(this[a]),d=y(this[a]),h=f.getLayer(b),aa(f,d,h);return this};c.fn.drawLayers=function(b){var a,d,f,h,e,s,n,r;for(d=0;d<this.length;d+=
1)if(a=c(this[d]),f=y(this[d])){f.clearRect(0,0,this[d].width,this[d].height);E.elem===this[d]?n=E.data:(n=Q(this[d]),E.elem=this[d],E.data=n);h=n.layers;for(s=0;s<h.length;s+=1)if(e=h[s],e.index=s,b&&(e._fired=F),aa(a,f,e),e._mousedout)e._mousedout=F,e._fired=v,e._hovered=F,e.mouseout&&e.mouseout.call(this[d],e),e.cursor&&e._cursor&&a.css({cursor:e._cursor});e=n.intersects[n.intersects.length-1]||{};f=n.event;f=f.type;r=e[f];s=n.drag;if(e._event){if((e.mouseover||e.mouseout||e.cursor)&&!e._hovered&&
!e._fired)e._fired=v,e._hovered=v,e.mouseover&&e.mouseover.call(this[d],e),e.cursor&&(e._cursor=a.css("cursor"),a.css({cursor:e.cursor}));r&&!e._fired&&(e._fired=v,r.call(this[d],e));e.draggable&&(!e.disableDrag&&"mousedown"===f)&&(e.bringToFront&&(h.splice(e.index,1),e.index=h.push(e)),s.layer=e,s.dragging=v,s.startX=e.x,s.startY=e.y,s.endX=e.mouseX,s.endY=e.mouseY,e.dragstart&&e.dragstart.call(this[d],e))}if(s.layer&&(s.dragging&&"mouseup"===f&&(s.layer.dragstop&&s.layer.dragstop.call(this[d],s.layer),
n.drag={}),s.dragging&&"mousemove"===f))s.layer.x=s.layer.mouseX-(s.endX-s.startX),s.layer.y=s.layer.mouseY-(s.endY-s.startY),s.layer.drag&&s.layer.drag.call(this[d],s.layer)}n.intersects=[];return this};c.fn.addLayer=function(b){var a,d,b=b||{};for(a=0;a<this.length;a+=1)if(d=y(this[a]))b.layer=v,G(this[a],b);return this};J=["width","height","opacity","lineHeight"];T={};c.fn.animateLayer=function(){function b(a,b){return function(){ba(b);a.drawLayers();e[4]&&e[4].call(a[0],b)}}function a(a,b){return function(d,
f){ba(b);a.drawLayers();e[5]&&e[5].call(a[0],d,f,b)}}var d,f,h,e=[].slice.call(arguments,0);"object"===typeof e[0]&&!e[0].layer&&e.unshift(0);"object"===typeof e[2]?(e.splice(2,0,e[2].duration||i),e.splice(3,0,e[3].easing||i),e.splice(4,0,e[4].complete||i),e.splice(5,0,e[5].step||i)):(e[2]===z?(e.splice(2,0,i),e.splice(3,0,i),e.splice(4,0,i)):"function"===typeof e[2]&&(e.splice(2,0,i),e.splice(3,0,i)),e[3]===z)?(e[3]=i,e.splice(4,0,i)):"function"===typeof e[3]&&e.splice(3,0,i);e[1]=A({},e[1]);for(f=
0;f<this.length;f+=1)if(d=c(this[f]),h=y(this[f]))if((h=d.getLayer(e[0]))&&h.method!==c.fn.draw)ca(h),ca(e[1],v),h.style=T,c(h).animate(e[1],{duration:e[2],easing:c.easing[e[3]]?e[3]:i,complete:b(d,h),step:a(d,h)});return this};c.fn.animateLayerGroup=function(b){var a,d,f=[].slice.call(arguments,0),h,e;for(d=0;d<this.length;d+=1){a=c(this[d]);h=a.getLayerGroup(b);for(e=0;e<h.length;e+=1)a.animateLayer.apply(a,[h[e]].concat(f.slice(1)))}};c.fn.delayLayer=function(b,a){var d,f,a=a||0;for(d=0;d<this.length;d+=
1)f=c(this[d]).getLayer(b),c(f).delay(a);return this};c.fn.delayLayerGroup=function(b,a){var d,f,h,e,a=a||0;for(f=0;f<this.length;f+=1){d=c(this[f]);h=d.getLayerGroup(b);for(e=0;e<h.length;e+=1)d.delayLayer.call(d,b,a)}};c.fn.stopLayer=function(b,a){var d,f;for(d=0;d<this.length;d+=1)f=c(this[d]).getLayer(b),c(f).stop(a);return this};c.fn.stopLayerGroup=function(b,a){var d,f,h,e;for(f=0;f<this.length;f+=1){d=c(this[f]);h=d.getLayerGroup(b);for(e=0;e<h.length;e+=1)d.stopLayer.call(d,b,a)}};(function(b){var a;
for(a=0;a<b.length;a+=1)c.fx.step[b[a]]=ga})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));M("click");M("dblclick");M("mousedown");M("mouseup");M("mousemove");M("mouseover");M("mouseout");c.event.fix=function(b){var a,b=ha.call(c.event,b);if(b.pageX!==z&&b.offsetX===z&&(a=c(b.target).offset()))b.offsetX=b.pageX-a.left,b.offsetY=b.pageY-a.top;return b};c.fn.draw=function a(d){var f,h,
d=d||{};"function"===typeof d&&(d={fn:d});for(f=0;f<this.length;f+=1)if((h=y(this[f]))&&d.fn)G(this[f],d,a),d.fn.call(this[f],h);return this};c.fn.clearCanvas=function(a){for(var d,f=A(new B,a),a=0;a<this.length;a+=1)if(d=y(this[a]))H(a,d,f,f.width,f.height),!f.x||!f.y||!f.width||!f.height?d.clearRect(0,0,this[a].width,this[a].height):d.clearRect(f.x-f.width/2,f.y-f.height/2,f.width,f.height);return this};c.fn.saveCanvas=function(){var a,d;for(a=0;a<this.length;a+=1)(d=y(this[a]))&&d.save();return this};
c.fn.restoreCanvas=function(){var a,d;for(a=0;a<this.length;a+=1)(d=y(this[a]))&&d.restore();return this};c.fn.translateCanvas=function(a){for(var d,f=A(new B,a),a=0;a<this.length;a+=1)if(d=y(this[a]))f.autosave&&d.save(),Y(d,f);return this};c.fn.scaleCanvas=function(a){for(var d,f=A(new B,a),a=0;a<this.length;a+=1)if(d=y(this[a]))f.autosave&&d.save(),Z(d,f);return this};c.fn.rotateCanvas=function(a){for(var d,f=A(new B,a),a=0;a<this.length;a+=1)if(d=y(this[a]))f.autosave&&d.save(),$(d,f);return this};
c.fn.drawRect=function d(f){var h,e,c=A(new B,f),n,r,t,p,j;for(h=0;h<this.length;h+=1)if(e=y(this[h]))G(this[h],f,d),I(e,c),H(h,e,c,c.width,c.height),e.beginPath(),n=c.x-c.width/2,r=c.y-c.height/2,(j=c.cornerRadius)?(c.closed=v,t=c.x+c.width/2,p=c.y+c.height/2,0>t-n-2*j&&(j=(t-n)/2),0>p-r-2*j&&(j=(p-r)/2),e.moveTo(n+j,r),e.lineTo(t-j,r),e.arc(t-j,r+j,j,3*D/2,2*D,F),e.lineTo(t,p-j),e.arc(t-j,p-j,j,0,D/2,F),e.lineTo(n+j,p),e.arc(n+j,p-j,j,D/2,D,F),e.lineTo(n,r+j),e.arc(n+j,r+j,j,D,3*D/2,F)):e.rect(n,
r,c.width,c.height),c._event&&K(this[h],e,f),L(e,c);return this};c.fn.drawArc=function f(h){var e,c,n=A(new B,h),h=h||{};!n.inDegrees&&360===n.end&&(h.end=n.end=2*D);for(e=0;e<this.length;e+=1)if(c=y(this[e]))G(this[e],h,f),I(c,n),H(e,c,n,2*n.radius),c.beginPath(),c.arc(n.x,n.y,n.radius,n.start*n._toRad-D/2,n.end*n._toRad-D/2,n.ccw),n._event&&K(this[e],c,h),L(c,n);return this};c.fn.drawEllipse=function h(e){var c,n,r=A(new B,e),t=4*r.width/3,p=r.height;r.closed=v;for(c=0;c<this.length;c+=1)if(n=y(this[c]))G(this[c],
e,h),I(n,r),H(c,n,r,r.width,r.height),n.beginPath(),n.moveTo(r.x,r.y-p/2),n.bezierCurveTo(r.x-t/2,r.y-p/2,r.x-t/2,r.y+p/2,r.x,r.y+p/2),n.bezierCurveTo(r.x+t/2,r.y+p/2,r.x+t/2,r.y-p/2,r.x,r.y-p/2),r._event&&K(this[c],n,e),L(n,r);return this};c.fn.drawPolygon=function e(c){var n,r,t=A(new B,c),p=2*D/t.sides,j=D/t.sides,l=j+D/2,m=t.radius*U(p/2),o,i,k;t.closed=v;for(n=0;n<this.length;n+=1)if(r=y(this[n])){G(this[n],c,e);I(r,t);H(n,r,t,2*t.radius);r.beginPath();for(k=0;k<t.sides;k+=1)o=t.x+O(t.radius*
U(l)),i=t.y+O(t.radius*fa(l)),r.lineTo(o,i),t.projection&&(o=t.x+O((m+m*t.projection)*U(l+j)),i=t.y+O((m+m*t.projection)*fa(l+j)),r.lineTo(o,i)),l+=p;t._event&&K(this[n],r,c);L(r,t)}return this};c.fn.drawLine=function s(c){var i,t,p=A(new B,c),j,l,m;for(i=0;i<this.length;i+=1)if(t=y(this[i])){G(this[i],c,s);I(t,p);S(p);H(i,t,p,0);j=1;for(t.beginPath();v;)if(l=p["x"+j],m=p["y"+j],l!==z&&m!==z)t.lineTo(l,m),j+=1;else break;p._event&&K(this[i],t,c);L(t,p)}return this};c.fn.drawQuad=function n(c){var i,
p,j=A(new B,c),l,m,o,q,k;for(i=0;i<this.length;i+=1)if(p=y(this[i])){G(this[i],c,n);I(p,j);S(j);H(i,p,j,0);l=2;p.beginPath();for(p.moveTo(j.x1,j.y1);v;)if(m=j["x"+l],o=j["y"+l],q=j["cx"+(l-1)],k=j["cy"+(l-1)],m!==z&&o!==z&&q!==z&&k!==z)p.quadraticCurveTo(q,k,m,o),l+=1;else break;j._event&&K(this[i],p,c);L(p,j)}return this};c.fn.drawBezier=function r(c){var p,j,i=A(new B,c),m,o,q,k,g,u,w,x;for(p=0;p<this.length;p+=1)if(j=y(this[p])){G(this[p],c,r);I(j,i);S(i);H(p,j,i,0);m=2;o=1;j.beginPath();for(j.moveTo(i.x1,
i.y1);v;)if(q=i["x"+m],k=i["y"+m],g=i["cx"+o],u=i["cy"+o],w=i["cx"+(o+1)],x=i["cy"+(o+1)],q!==z&&k!==z&&g!==z&&u!==z&&w!==z&&x!==z)j.bezierCurveTo(g,u,w,x,q,k),m+=1,o+=2;else break;i._event&&K(this[p],j,c);L(j,i)}return this};c.fn.drawText=function t(p){var j,l,m=A(new B,p),o,q,k,g;for(j=0;j<this.length;j+=1)if(c(this[j]),l=y(this[j])){G(this[j],p,t);I(l,m);l.textBaseline=m.baseline;l.textAlign=m.align;l.font=m.font;if(!j&&m.maxWidth!==i){o=l;q=m.text;g=m.maxWidth;var u=m.text.split(" "),w=[],x="";
if(o.measureText(q).width<g)w=[q];else for(;0<u.length;)o.measureText(u[0]).width>g||o.measureText(x+u[0]).width<g?x+=u.shift()+" ":(w.push(x),x=""),0===u.length&&w.push(x);o=w;o=o.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}else j||(o=(""+m.text).split("\n"));ea(this[j],j,l,m,o);H(j,l,m,m.width,m.height);j||(k=m.x,"left"===m.align?k-=m.width/2:"right"===m.align&&(k+=m.width/2));for(q=0;q<o.length;q+=1)l.shadowColor=m.shadowColor,g=m.y+q*m.height/o.length-(o.length-1)*m.height/o.length/
2,l.fillText(o[q],k,g),"transparent"!==m.fillStyle&&(l.shadowColor="transparent"),l.strokeText(o[q],m.x,g);m._event?(l.beginPath(),l.rect(m.x-m.width/2,m.y-m.height/2,m.width,m.height),l.restore(),K(this[j],l,p),l.closePath()):l.restore()}E=m;return this};c.fn.measureText=function(c){var i;i=c!==z&&"object"!==typeof c?this.getLayer(c):A(new B,c);(c=y(this[0]))&&i.text!==z&&ea(this[0],0,c,i,i.text.split("\n"));return i};c.fn.drawImage=function p(c){function l(p,k,l){return function(){k||((x=u.width/
u.height,g.width===i&&g.sWidth===i&&(c.width=g.width=g.sWidth=u.width),g.height===i&&g.sHeight===i&&(c.height=g.height=g.sHeight=u.height),g.width===i&&g.sWidth!==i&&(g.width=g.sWidth),g.height===i&&g.sHeight!==i&&(g.height=g.sHeight),g.sWidth===i&&g.width!==i&&(c.sWidth=g.sWidth=u.width),g.sHeight===i&&g.height!==i&&(c.sHeight=g.sHeight=u.height),g.sx===i&&(g.sx=g.cropFromCenter?u.width/2:0),g.sy===i&&(g.sy=g.cropFromCenter?u.height/2:0),g.cropFromCenter||(g.sx+=g.sWidth/2,g.sy+=g.sHeight/2),g.sx+
g.sWidth/2>u.width&&(g.sx=u.width-g.sWidth/2),0>g.sx-g.sWidth/2&&(g.sx=g.sWidth/2),0>g.sy-g.sHeight/2&&(g.sy=g.sHeight/2),g.sy+g.sHeight/2>u.height&&(g.sy=u.height-g.sHeight/2),g.width!==i&&g.height===i)?c.height=g.height=g.width/x:g.width===i&&g.height!==i?c.width=g.width=g.height*x:g.width===i&&g.height===i&&(c.width=g.width=u.width,c.height=g.height=u.height));H(k,l,g,g.width,g.height);l.drawImage(u,g.sx-g.sWidth/2,g.sy-g.sHeight/2,g.sWidth,g.sHeight,g.x-g.width/2,g.y-g.height/2,g.width,g.height);
g._event?(l.beginPath(),l.rect(g.x-g.width/2,g.y-g.height/2,g.width,g.height),l.restore(),K(m[k],l,c),l.closePath()):l.restore();g.load&&g.load.call(p,c)}}var m=this,o,q,k,g=A(new B,c),u,w,x;w=g.source.getContext;g.source.src||w?(u=g.source,g.width=u.width,g.height=u.height):g.source&&(u=new V,u.src=g.source);for(q=0;q<m.length;q+=1)if(o=m[q],k=y(m[q]))G(m[q],c,p),I(k,g),u&&(u.complete||w?l(o,q,k)():u.onload=l(o,q,k));return m};c.fn.createPattern=c.fn.pattern=function(c){function j(){k=m.createPattern(q,
o.repeat);o.load&&o.load.call(l[0],k)}var l=this,m,o=A(new B,c),q,k;(m=y(l[0]))?"function"===typeof o.source?(q=R.createElement("canvas"),q.width=o.width,q.height=o.height,c=y(q),o.source.call(q,c),j()):(c=o.source.getContext,o.source.src||c?q=o.source:(q=new V,q.src=o.source),q.complete||c?j():q.onload=j):k=i;return k};c.fn.createGradient=c.fn.gradient=function(c){var j,c=A(new B,c),l=[],m,o,q,k,g,u,w;if(j=y(this[0])){c.x1=c.x1||0;c.y1=c.y1||0;c.x2=c.x2||0;c.y2=c.y2||0;j=c.r1!==i||c.r2!==i?j.createRadialGradient(c.x1,
c.y1,c.r1,c.x2,c.y2,c.r2):j.createLinearGradient(c.x1,c.y1,c.x2,c.y2);for(k=1;c["c"+k]!==z;k+=1)c["s"+k]!==z?l.push(c["s"+k]):l.push(i);m=l.length;l[0]===i&&(l[0]=0);l[m-1]===i&&(l[m-1]=1);for(k=0;k<m;k+=1){if(l[k]!==i){u=1;w=0;o=l[k];for(g=k+1;g<m;g+=1)if(l[g]!==i){q=l[g];break}else u+=1;o>q&&(l[g]=l[k])}else l[k]===i&&(w+=1,l[k]=o+w*((q-o)/u));j.addColorStop(l[k],c["c"+(k+1)])}}else j=i;return j};c.fn.setPixels=function j(c){var i,o,q,k=A(new B,c),g={},u,w,x,v;for(o=0;o<this.length;o+=1)if(i=this[o],
q=y(i)){G(this[o],c,j);H(o,q,k,k.width,k.height);if(!k.x||!k.y||!k.width||!k.height)k.width=i.width,k.height=i.height,k.x=k.width/2,k.y=k.height/2;u=q.getImageData(k.x-k.width/2,k.y-k.height/2,k.width,k.height);w=u.data;v=w.length;g=[];if(k.each)for(x=0;x<v;x+=4)g.r=w[x],g.g=w[x+1],g.b=w[x+2],g.a=w[x+3],k.each.call(i,g),w[x]=g.r,w[x+1]=g.g,w[x+2]=g.b,w[x+3]=g.a;q.putImageData(u,k.x-k.width/2,k.y-k.height/2);q.restore()}return this};c.fn.getCanvasImage=function(c,l){var m=this[0];return m&&m.toDataURL?
m.toDataURL("image/"+c,l):i};c.support.canvas=R.createElement("canvas").getContext!==z;C.defaults=N;c.jCanvas=C})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
