/*
 jCanvas v6.1b
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
(function(d,S,aa,Q,ba,u,D,g,y){var M,N,T,U,V,W,X,Y;function A(){}function E(c){c?z(ca,c):E.prefs=ca=A.prototype=z({},O);return this}function H(c,a){c.fillStyle=a.fillStyle;c.strokeStyle=a.strokeStyle;c.lineWidth=a.strokeWidth;a.rounded?(c.lineCap="round",c.lineJoin="round"):(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=a.opacity;c.globalCompositeOperation=
a.compositing}function x(c){return c&&c.getContext?c.getContext("2d"):g}function K(c,a){a.closed&&c.closePath();c.fill();"transparent"!==a.fillStyle&&(c.shadowColor="transparent");c.stroke();a.closed||c.closePath();a._toRad&&c.restore();a.mask&&(a.autosave&&c.save(),c.clip())}function da(c,a){if(!a.translateX&&!a.translateY&&(a.x||a.y))a.translateX=a.x,a.translateY=a.y;a.translate&&(a.translateX=a.translateY=a.translate);c.translate(a.translateX,a.translateY)}function ea(c,a){1!==a.scale&&(a.scaleX=
a.scaleY=a.scale);c.translate(a.x,a.y);c.scale(a.scaleX,a.scaleY);c.translate(-a.x,-a.y)}function fa(c,a){a._toRad=a.inDegrees?C/180:1;a.rotate=a.rotate||a.angle;c.translate(a.x,a.y);c.rotate(a.rotate*a._toRad);c.translate(-a.x,-a.y)}function G(c,a,b,e,i){b._toRad=b.inDegrees?C/180:1;a.save();i=i||e;!c&&!b.fromCenter&&(b.x+=e/2,b.y+=i/2);(b.rotate||b.angle)&&fa(a,b);(1!==b.scale||1!==b.scaleX||1!==b.scaleY)&&ea(a,b);(b.translate||b.translateX||b.translateY)&&da(a,b)}function R(c){var a;M===c?a=N:
((a=d.data(c,"jCanvas"))||(a=d.data(c,"jCanvas",{layers:[],intersects:[],drag:{},event:{}})),M=c,N=a);return a}function ga(c,a,b){b&&b.visible&&(b.method===d.fn.draw?b.fn.call(c[0],a):b.method&&b.method.call(c,b))}function F(c,a,b){var e,i,f,B="function"===typeof a,p,a=a||{};if(a.layer&&!a._layer){e=d(c);i=e.getLayers();B&&(a={method:d.fn.draw,fn:a});a=z(new A,a);if(!B){a.method=d.fn[a.method]||b;p=R(c);for(f in E.events)E.events.hasOwnProperty(f)&&a[f]&&(E.events[f](e,p),a._event=u);if(a.draggable){a._event=
u;c=["mousedown","mousemove","mouseup"];for(b=0;b<c.length;b+=1)f=c[b],E.events[f](e,p);p.mouseout||(e.bind("mouseout.jCanvas",function(){p.drag={};e.drawLayers()}),p.mouseout=u)}}a.layer=u;a._layer=u;a.index===y&&(a.index=i.length);i.splice(a.index,0,a)}}function ha(c){var a;for(a=0;a<J.length;a+=1)c[J[a]]=c["_"+J[a]]}function ia(c){var a;for(a=0;a<J.length;a+=1)c["_"+J[a]]=c[J[a]],Z[J[a]]=1}function ja(c){var a,b,e=[],i=1;c.match(/^#?[a-z0-9]+$/i)&&("transparent"===c&&(c="rgba(0,0,0,0)"),b=S.head,
a=b.style.color,b.style.color=c,c=d.css(b,"color"),b.style.color=a);c.match(/^rgb/i)&&(e=c.match(/[0-9]+/gi),c.match(/%/gi)&&(i=2.55),e[0]*=i,e[1]*=i,e[2]*=i,e[3]=e[3]!==y?ba(e[3]):1);return e}function ma(c){var a=3,b;"object"!==typeof c.start&&(c.start=ja(c.start),c.end=ja(c.end));c.now=[];if(1!==c.start[3]||1!==c.end[3])a=4;for(b=0;b<a;b+=1)c.now[b]=c.start[b]+(c.end[b]-c.start[b])*c.pos,3>b&&(c.now[b]=P(c.now[b]));1!==c.start[3]||1!==c.end[3]?c.now="rgba("+c.now.join(",")+")":(c.now.slice(0,3),
c.now="rgb("+c.now.join(",")+")");c.elem.nodeName?c.elem.style[c.prop]=c.now:c.elem[c.prop]=c.now}function L(c){E.events[c]=function(a,b){var e="mouseover"===c||"mouseout"===c?"mousemove":c,i=b.event;b[e]||(a.bind(e+".jCanvas",function(b){i.x=b.offsetX;i.y=b.offsetY;i.type=e;a.drawLayers(u);b.preventDefault()}),b[e]=u)}}function I(c,a,b){var c=R(c),e=c.event,a=a.isPointInPath(e.x,e.y);b.mouseX=e.x;b.mouseY=e.y;!a&&(b._hovered&&!b._fired)&&(b._mousedout=u);a&&c.intersects.push(b)}function ka(c,a,b,
e){var i,f=/\b(\d*\.?\d*)\w\w\b/gi,B;if(T===b.text&&U===b.font&&V===b.maxWidth&&W===b.lineHeight)b.width=X,b.height=Y;else{b.width=a.measureText(e[0]).width;for(i=1;i<e.length;i+=1)B=a.measureText(e[i]).width,B>b.width&&(b.width=B);a=c.style.fontSize;if(i=b.font.match(f))c.style.fontSize=b.font.match(f)[0];b.height=ba(d.css(c,"fontSize"))*e.length*b.lineHeight;c.style.fontSize=a}}var O,ca,z=d.extend,P=Q.round,C=Q.PI,la=Q.sin,$=Q.cos,na=d.event.fix;Y=X=W=V=U=T=N=M=void 0;var J,Z;d.fn.jCanvas=E;E.version=
"6.1b";E.events={};O={angle:0,align:"center",autosave:u,baseline:"middle",bringToFront:D,ccw:D,closed:D,compositing:"source-over",cornerRadius:0,cropFromCenter:u,draggable:D,disableDrag:D,each:g,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:u,height:g,inDegrees:u,lineHeight:1,load:g,mask:D,maxWidth:g,method:g,miterLimit:10,opacity:1,projection:0,r1:g,r2:g,radius:0,repeat:"repeat",rotate:0,rounded:D,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,
sHeight:g,sides:3,source:"",start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:g,sx:g,sy:g,text:"",translate:0,translateX:0,translateY:0,visible:u,width:g,x:0,y:0};E();E.extend=function(c){O=z(O,c.props);E();c.name&&(d.fn[c.name]=function b(e){var i,f,d,p=z(new A,e);for(f=0;f<this.length;f+=1)if(i=this[f],d=x(i))F(this[f],e,b),H(d,p),c.fn.call(i,d,p);return this});return d.fn[c.name]};d.fn.getLayers=function(){var c=this[0];return!c||!c.getContext?[]:R(c).layers};
d.fn.getLayer=function(c){var a=this.getLayers(),b;if(!c||!c.layer){if("string"===typeof c)for(b=0;b<a.length;b+=1)if(a[b].name===c){c=b;break}c=a[c||0]}return c};d.fn.setLayer=function(c,a){var b,e;c||(a=c,c=0);for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),z(e,a);return this};d.fn.removeLayer=function(c){var a,b,e,i,f=typeof c;for(a=0;a<this.length;a+=1){b=d(this[a]).getLayers();if("string"===f)for(i=0;i<b.length;i+=1){if(b[i].name===c){e=i;break}}else e="number"===f?c:"";b[e]&&b.splice(e,
1)}return this};d.fn.removeLayers=function(){var c,a;for(a=0;a<this.length;a+=1)c=d(this[a]).getLayers(),c.length=0;return this};d.fn.getLayerGroup=function(c){var a=this.getLayers(),b=[],e;if(c!==y)for(e=0;e<a.length;e+=1)a[e].group===c&&b.push(a[e]);return b};d.fn.setLayerGroup=function(c,a){var b,e,i;for(b=0;b<this.length;b+=1){e=d(this[b]).getLayers();for(i=0;i<e.length;i+=1)e[i].group===c&&z(e[i],a)}return this};d.fn.removeLayerGroup=function(c){var a,b,e;if(c!==y)for(a=0;a<this.length;a+=1){b=
d(this[a]).getLayers();for(e=0;e<b.length;e+=1)b[e].group===c&&(b.splice(e,1),e-=1)}return this};d.fn.drawLayer=function(c){var a,b,e,i;for(a=0;a<this.length;a+=1)e=d(this[a]),b=x(this[a]),i=e.getLayer(c),ga(e,b,i);return this};d.fn.drawLayers=function(c){var a,b,e,i,f,B,p;for(b=0;b<this.length;b+=1)if(a=d(this[b]),e=x(this[b])){e.clearRect(0,0,this[b].width,this[b].height);M===this[b]?p=N:(p=R(this[b]),M=this[b],N=p);i=p.layers;for(B=0;B<i.length;B+=1)if(f=i[B],f.index=B,c&&(f._fired=D),ga(a,e,f),
f._mousedout)f._mousedout=D,f._fired=u,f._hovered=D,f.mouseout&&f.mouseout.call(this[b],f);f=p.intersects[p.intersects.length-1]||{};a=p.event;a=a.type;B=f[a];e=p.drag;if(f._event){if((f.mouseover||f.mouseout)&&!f._hovered&&!f._fired)f._fired=u,f._hovered=u,f.mouseover&&f.mouseover.call(this[b],f);B&&!f._fired&&(f._fired=u,B.call(this[b],f));f.draggable&&(!f.disableDrag&&"mousedown"===a)&&(f.bringToFront&&(i.splice(f.index,1),f.index=i.push(f)),e.layer=f,e.dragging=u,e.startX=f.x,e.startY=f.y,e.endX=
f.mouseX,e.endY=f.mouseY,f.dragstart&&f.dragstart.call(this[b],f))}if(e.layer&&(e.dragging&&"mouseup"===a&&(e.layer.dragstop&&e.layer.dragstop.call(this[b],e.layer),p.drag={}),e.dragging&&"mousemove"===a))e.layer.x=e.layer.mouseX-(e.endX-e.startX),e.layer.y=e.layer.mouseY-(e.endY-e.startY),e.layer.drag&&e.layer.drag.call(this[b],e.layer)}p.intersects=[];return this};d.fn.addLayer=function(c){var a,b,c=c||{};for(a=0;a<this.length;a+=1)if(b=x(this[a]))c.layer=u,F(this[a],c);return this};J=["width",
"height","opacity","lineHeight"];Z={};d.fn.animateLayer=function(){function c(a,b){return function(){ha(b);a.drawLayers();f[4]&&f[4].call(a[0],b)}}function a(a,b){return function(c,e){ha(b);a.drawLayers();f[5]&&f[5].call(a[0],c,e,b)}}var b,e,i,f=[].slice.call(arguments,0);"object"===typeof f[0]&&!f[0].layer&&f.unshift(0);"object"===typeof f[2]?(f.splice(2,0,f[2].duration||g),f.splice(3,0,f[3].easing||g),f.splice(4,0,f[4].complete||g),f.splice(5,0,f[5].step||g)):(f[2]===y?(f.splice(2,0,g),f.splice(3,
0,g),f.splice(4,0,g)):"function"===typeof f[2]&&(f.splice(2,0,g),f.splice(3,0,g)),f[3]===y)?(f[3]=g,f.splice(4,0,g)):"function"===typeof f[3]&&f.splice(3,0,g);for(e=0;e<this.length;e+=1)if(b=d(this[e]),i=x(this[e]))if((i=b.getLayer(f[0]))&&i.method!==d.fn.draw)ia(i),ia(f[1]),i.style=Z,d(i).animate(f[1],{duration:f[2],easing:d.easing[f[3]]?f[3]:g,complete:c(b,i),step:a(b,i)});return this};d.fn.animateLayerGroup=function(c){var a,b,e=[].slice.call(arguments,0),i,f;for(b=0;b<this.length;b+=1){a=d(this[b]);
i=a.getLayerGroup(c);for(f=0;f<i.length;f+=1)a.animateLayer.apply(a,[i[f]].concat(e.slice(1)))}};d.fn.delayLayer=function(c,a){var b,e,a=a||0;for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),d(e).delay(a);return this};d.fn.delayLayerGroup=function(c,a){var b,e,i,f,a=a||0;for(e=0;e<this.length;e+=1){b=d(this[e]);i=b.getLayerGroup(c);for(f=0;f<i.length;f+=1)b.delayLayer.call(b,c,a)}};d.fn.stopLayer=function(c,a){var b,e;for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),d(e).stop(a);return this};
d.fn.stopLayerGroup=function(c,a){var b,e,i,f;for(e=0;e<this.length;e+=1){b=d(this[e]);i=b.getLayerGroup(c);for(f=0;f<i.length;f+=1)b.stopLayer.call(b,c,a)}};(function(c){var a;for(a=0;a<c.length;a+=1)d.fx.step[c[a]]=ma})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));L("click");L("dblclick");L("mousedown");L("mouseup");L("mousemove");L("mouseover");L("mouseout");d.event.fix=function(c){var a,
c=na.call(d.event,c);if(c.pageX!==y&&c.offsetX===y&&(a=d(c.target).offset()))c.offsetX=c.pageX-a.left,c.offsetY=c.pageY-a.top;return c};d.fn.draw=function a(b){var e,i,b=b||{};"function"===typeof b&&(b={fn:b});for(e=0;e<this.length;e+=1)if((i=x(this[e]))&&b.fn)F(this[e],b,a),b.fn.call(this[e],i);return this};d.fn.clearCanvas=function(a){for(var b,e=z(new A,a),a=0;a<this.length;a+=1)if(b=x(this[a]))G(a,b,e,e.width,e.height),!e.x||!e.y||!e.width||!e.height?b.clearRect(0,0,this[a].width,this[a].height):
b.clearRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height);return this};d.fn.saveCanvas=function(){var a,b;for(a=0;a<this.length;a+=1)(b=x(this[a]))&&b.save();return this};d.fn.restoreCanvas=function(){var a,b;for(a=0;a<this.length;a+=1)(b=x(this[a]))&&b.restore();return this};d.fn.translateCanvas=function(a){for(var b,e=z(new A,a),a=0;a<this.length;a+=1)if(b=x(this[a]))e.autosave&&b.save(),da(b,e);return this};d.fn.scaleCanvas=function(a){for(var b,e=z(new A,a),a=0;a<this.length;a+=1)if(b=x(this[a]))e.autosave&&
b.save(),ea(b,e);return this};d.fn.rotateCanvas=function(a){for(var b,e=z(new A,a),a=0;a<this.length;a+=1)if(b=x(this[a]))e.autosave&&b.save(),fa(b,e);return this};d.fn.drawRect=function b(e){var i,f,d=z(new A,e),p,g,r,q,k;for(i=0;i<this.length;i+=1)if(f=x(this[i]))F(this[i],e,b),H(f,d),G(i,f,d,d.width,d.height),f.beginPath(),p=d.x-d.width/2,g=d.y-d.height/2,(k=d.cornerRadius)?(d.closed=u,r=d.x+d.width/2,q=d.y+d.height/2,0>r-p-2*k&&(k=(r-p)/2),0>q-g-2*k&&(k=(q-g)/2),f.moveTo(p+k,g),f.lineTo(r-k,g),
f.arc(r-k,g+k,k,3*C/2,2*C,D),f.lineTo(r,q-k),f.arc(r-k,q-k,k,0,C/2,D),f.lineTo(p+k,q),f.arc(p+k,q-k,k,C/2,C,D),f.lineTo(p,g+k),f.arc(p+k,g+k,k,C,3*C/2,D)):f.rect(p,g,d.width,d.height),d._event&&I(this[i],f,e),K(f,d);return this};d.fn.drawArc=function e(d){var f,g,p=z(new A,d),d=d||{};!p.inDegrees&&360===p.end&&(d.end=p.end=2*C);for(f=0;f<this.length;f+=1)if(g=x(this[f]))F(this[f],d,e),H(g,p),G(f,g,p,2*p.radius),g.beginPath(),g.arc(p.x,p.y,p.radius,p.start*p._toRad-C/2,p.end*p._toRad-C/2,p.ccw),p._event&&
I(this[f],g,d),K(g,p);return this};d.fn.drawEllipse=function i(f){var d,g,t=z(new A,f),r=4*t.width/3,q=t.height;t.closed=u;for(d=0;d<this.length;d+=1)if(g=x(this[d]))F(this[d],f,i),H(g,t),G(d,g,t,t.width,t.height),g.beginPath(),g.moveTo(t.x,t.y-q/2),g.bezierCurveTo(t.x-r/2,t.y-q/2,t.x-r/2,t.y+q/2,t.x,t.y+q/2),g.bezierCurveTo(t.x+r/2,t.y+q/2,t.x+r/2,t.y-q/2,t.x,t.y-q/2),t._event&&I(this[d],g,f),K(g,t);return this};d.fn.drawPolygon=function f(d){var g,t,r=z(new A,d),q=2*C/r.sides,k=C/r.sides,l=k+C/
2,m=r.radius*$(q/2),n,o,j;r.closed=u;for(g=0;g<this.length;g+=1)if(t=x(this[g])){F(this[g],d,f);H(t,r);G(g,t,r,2*r.radius);t.beginPath();for(j=0;j<r.sides;j+=1)n=r.x+P(r.radius*$(l)),o=r.y+P(r.radius*la(l)),t.lineTo(n,o),r.projection&&(n=r.x+P((m+m*r.projection)*$(l+k)),o=r.y+P((m+m*r.projection)*la(l+k)),t.lineTo(n,o)),l+=q;r._event&&I(this[g],t,d);K(t,r)}return this};d.fn.drawLine=function B(d){var g,r,q=z(new A,d),k,l,m;for(g=0;g<this.length;g+=1)if(r=x(this[g])){F(this[g],d,B);H(r,q);G(g,r,q,
0);k=1;for(r.beginPath();u;)if(l=q["x"+k],m=q["y"+k],l!==y&&m!==y)r.lineTo(l,m),k+=1;else break;q._event&&I(this[g],r,d);K(r,q)}return this};d.fn.drawQuad=function p(d){var g,q,k=z(new A,d),l,m,n,o,j;for(g=0;g<this.length;g+=1)if(q=x(this[g])){F(this[g],d,p);H(q,k);G(g,q,k,0);l=2;q.beginPath();for(q.moveTo(k.x1,k.y1);u;)if(m=k["x"+l],n=k["y"+l],o=k["cx"+(l-1)],j=k["cy"+(l-1)],m!==y&&n!==y&&o!==y&&j!==y)q.quadraticCurveTo(o,j,m,n),l+=1;else break;k._event&&I(this[g],q,d);K(q,k)}return this};d.fn.drawBezier=
function t(d){var g,k,l=z(new A,d),m,n,o,j,h,s,v,w;for(g=0;g<this.length;g+=1)if(k=x(this[g])){F(this[g],d,t);H(k,l);G(g,k,l,0);m=2;n=1;k.beginPath();for(k.moveTo(l.x1,l.y1);u;)if(o=l["x"+m],j=l["y"+m],h=l["cx"+n],s=l["cy"+n],v=l["cx"+(n+1)],w=l["cy"+(n+1)],o!==y&&j!==y&&h!==y&&s!==y&&v!==y&&w!==y)k.bezierCurveTo(h,s,v,w,o,j),m+=1,n+=2;else break;l._event&&I(this[g],k,d);K(k,l)}return this};d.fn.drawText=function r(q){var k,l,m=z(new A,q),n,o,j,h;for(k=0;k<this.length;k+=1)if(d(this[k]),l=x(this[k])){F(this[k],
q,r);H(l,m);l.textBaseline=m.baseline;l.textAlign=m.align;l.font=m.font;if(!k&&m.maxWidth!==g){n=l;o=m.text;h=m.maxWidth;var s=m.text.split(" "),v=[],w="";if(n.measureText(o).width<h)v=[o];else for(;0<s.length;)n.measureText(w+s[0]).width<h?w+=s.shift()+" ":(v.push(w),w=""),0===s.length&&v.push(w);n=v;n=n.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}else k||(n=m.text.split("\n"));ka(this[k],l,m,n);G(k,l,m,m.width,m.height);k||(j=m.x,"left"===m.align?j-=m.width/2:"right"===m.align&&(j+=m.width/
2));for(o=0;o<n.length;o+=1)h=m.y+o*m.height/n.length-(n.length-1)*m.height/n.length/2,l.fillText(n[o],j,h),"transparent"!==m.fillStyle&&(l.shadowColor="transparent"),l.strokeText(n[o],m.x,h);m._event?(l.beginPath(),l.rect(m.x-m.width/2,m.y-m.height/2,m.width,m.height),l.restore(),I(this[k],l,q),l.closePath()):l.restore()}T=m.text;U=m.font;X=m.width;V=m.maxWidth;Y=m.height;W=m.lineHeight;return this};d.fn.measureText=function(d){var g;g=d!==y&&"object"!==typeof d?this.getLayer(d):z(new A,d);(d=x(this[0]))&&
g.text!==y&&ka(this[0],d,g,g.text.split("\n"));return g};d.fn.drawImage=function q(d){function l(l,q,j){return function(){q||((w=s.width/s.height,h.width===g&&h.sWidth===g&&(d.width=h.width=h.sWidth=s.width),h.height===g&&h.sHeight===g&&(d.height=h.height=h.sHeight=s.height),h.width===g&&h.sWidth!==g&&(h.width=h.sWidth),h.height===g&&h.sHeight!==g&&(h.height=h.sHeight),h.sWidth===g&&h.width!==g&&(d.sWidth=h.sWidth=s.width),h.sHeight===g&&h.height!==g&&(d.sHeight=h.sHeight=s.height),h.sx===g&&(h.sx=
h.cropFromCenter?s.width/2:0),h.sy===g&&(h.sy=h.cropFromCenter?s.height/2:0),h.cropFromCenter||(h.sx+=h.sWidth/2,h.sy+=h.sHeight/2),h.sx+h.sWidth/2>s.width&&(h.sx=s.width-h.sWidth/2),0>h.sx-h.sWidth/2&&(h.sx=h.sWidth/2),0>h.sy-h.sHeight/2&&(h.sy=h.sHeight/2),h.sy+h.sHeight/2>s.height&&(h.sy=s.height-h.sHeight/2),h.width!==g&&h.height===g)?d.height=h.height=h.width/w:h.width===g&&h.height!==g?d.width=h.width=h.height*w:h.width===g&&h.height===g&&(d.width=h.width=s.width,d.height=h.height=s.height));
G(q,j,h,h.width,h.height);j.drawImage(s,h.sx-h.sWidth/2,h.sy-h.sHeight/2,h.sWidth,h.sHeight,h.x-h.width/2,h.y-h.height/2,h.width,h.height);h._event?(j.beginPath(),j.rect(h.x-h.width/2,h.y-h.height/2,h.width,h.height),j.restore(),I(m[q],j,d),j.closePath()):j.restore();h.load&&h.load.call(l,d)}}var m=this,n,o,j,h=z(new A,d),s,v,w;v=h.source.getContext;h.source.src||v?(s=h.source,h.width=s.width,h.height=s.height):h.source&&(s=new aa,s.src=h.source);for(o=0;o<m.length;o+=1)if(n=m[o],j=x(m[o]))F(m[o],
d,q),H(j,h),s&&(s.complete||v?l(n,o,j)():s.onload=l(n,o,j));return m};d.fn.createPattern=d.fn.pattern=function(d){function k(){j=m.createPattern(o,n.repeat);n.load&&n.load.call(l[0],j)}var l=this,m,n=z(new A,d),o,j;(m=x(l[0]))?"function"===typeof n.source?(o=S.createElement("canvas"),o.width=n.width,o.height=n.height,d=x(o),n.source.call(o,d),k()):(d=n.source.getContext,n.source.src||d?o=n.source:(o=new aa,o.src=n.source),o.complete||d?k():o.onload=k):j=g;return j};d.fn.createGradient=d.fn.gradient=
function(d){var k,d=z(new A,d),l=[],m,n,o,j,h,s,v;if(k=x(this[0])){d.x1=d.x1||0;d.y1=d.y1||0;d.x2=d.x2||0;d.y2=d.y2||0;k=d.r1!==g||d.r2!==g?k.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2):k.createLinearGradient(d.x1,d.y1,d.x2,d.y2);for(j=1;d["c"+j]!==y;j+=1)d["s"+j]!==y?l.push(d["s"+j]):l.push(g);m=l.length;l[0]===g&&(l[0]=0);l[m-1]===g&&(l[m-1]=1);for(j=0;j<m;j+=1){if(l[j]!==g){s=1;v=0;n=l[j];for(h=j+1;h<m;h+=1)if(l[h]!==g){o=l[h];break}else s+=1;n>o&&(l[h]=l[j])}else l[j]===g&&(v+=1,l[j]=
n+v*((o-n)/s));k.addColorStop(l[j],d["c"+(j+1)])}}else k=g;return k};d.fn.setPixels=function k(d){var g,n,o,j=z(new A,d),h={},s,v,w,u;for(n=0;n<this.length;n+=1)if(g=this[n],o=x(g)){F(this[n],d,k);G(n,o,j,j.width,j.height);if(!j.x||!j.y||!j.width||!j.height)j.width=g.width,j.height=g.height,j.x=j.width/2,j.y=j.height/2;s=o.getImageData(j.x-j.width/2,j.y-j.height/2,j.width,j.height);v=s.data;u=v.length;h=[];if(j.each)for(w=0;w<u;w+=4)h.r=v[w],h.g=v[w+1],h.b=v[w+2],h.a=v[w+3],j.each.call(g,h),v[w]=
h.r,v[w+1]=h.g,v[w+2]=h.b,v[w+3]=h.a;o.putImageData(s,j.x-j.width/2,j.y-j.height/2);o.restore()}return this};d.fn.getCanvasImage=function(d,l){var m=this[0];return m&&m.toDataURL?m.toDataURL("image/"+d,l):g};d.support.canvas=S.createElement("canvas").getContext!==y;E.defaults=O;d.jCanvas=E})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
