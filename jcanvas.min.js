/**
 * jCanvas v13.09.15
 * Copyright 2013 Caleb Evans
 * Released under the MIT license
 */(function(e,t,n,r,i,s,o,u,a){function An(e){var t=this;cn(t,e);return t}function On(e){e?cn(An.prototype,e):On.prefs=An.prototype=cn({},ln);return this}function Mn(e){return pn(e)==="string"}function _n(e){return e&&e[A]?e[A]("2d"):u}function Dn(e){e=cn({},e);e.masks=e.masks[Y](0);return e}function Pn(e,t){var n;e.save();n=Dn(t[p]);t[O].push(n)}function Hn(e,t){if(t[O][f]===0)t[p]=Dn(Cn);else{e[Ct]();t[p]=t[O].pop()}}function Bn(e,t,n){dn(n[b])?t[b]=n[b][C](e,n):t[b]=n[b];dn(n[T])?t[T]=n[T][C](e,n):t[T]=n[T];t.lineWidth=n[yt];if(n.rounded)t.lineCap=t.lineJoin="round";else{t.lineCap=n.strokeCap;t.lineJoin=n.strokeJoin;t.miterLimit=n.miterLimit}t.shadowOffsetX=n.shadowX;t.shadowOffsetY=n.shadowY;t[Nt]=n[Nt];t[v]=n[v];t.globalAlpha=n.opacity;t.globalCompositeOperation=n.compositing;n[It]&&(t.webkitImageSmoothingEnabled=t.mozImageSmoothingEnabled=n[It])}function jn(e,t,n){if(n.mask){n[wt]&&Pn(e,t);e.clip();t[p].masks.push(n._args)}}function Fn(e,t){t._transformed&&e[Ct]()}function In(e,t,n){var r;n[ft]&&t[z]();if(n.shadowStroke&&n[yt]!==0){t.stroke();t.fill();t[v]=h;t[Nt]=0;t.stroke()}else{t.fill();n[b]!==h&&(t[v]=h);n[yt]!==0&&t.stroke()}n[ft]||t[z]();Fn(t,n);if(n.mask){r=Wn(e);jn(t,r,n)}}function qn(e,t,n){t[F]=t[kt]?mn/180:1;e[S](t.x,t.y);e[ht](t[ht]*t[F]);e[S](-t.x,-t.y);n&&(n[ht]+=t[ht]*t[F])}function Rn(e,t,n){t.scale!==1&&(t[lt]=t[ct]=t.scale);e[S](t.x,t.y);e.scale(t[lt],t[ct]);e[S](-t.x,-t.y);if(n){n[lt]*=t[lt];n[ct]*=t[ct]}}function Un(e,t,n){t[S]&&(t[j]=t[B]=t[S]);e[S](t[j],t[B]);if(n){n[j]+=t[j];n[B]+=t[B]}}function zn(e,t,n,r,i){n[F]=n[kt]?mn/180:1;n._transformed=s;t.save();i===a&&(i=r);if(!n.fromCenter&&!n._centered){n.x+=r/2;n.y+=i/2;n._centered=s}n[ht]&&qn(t,n,{});(n.scale!==1||n[lt]!==1||n[ct]!==1)&&Rn(t,n,{});(n[S]||n[j]||n[B])&&Un(t,n,{})}function Wn(t){var n;if(xn._canvas===t&&xn._data)n=xn._data;else{n=e.data(t,at);if(!n){n={canvas:t,layers:[],layer:{names:{},groups:{}},intersecting:[],lastIntersected:u,cursor:e(t).css(dt),drag:{},event:{type:u,x:u,y:u},events:{},transforms:Dn(Cn),savedTransforms:[],animating:o,animated:u,pos:0,pixelRatio:1,scaled:!1};e.data(t,at,n)}xn._canvas=t;xn._data=n}return n}function Xn(e,t,n){var r;for(r in On[H])On[H][tn](r)&&(n[r]||n[gt]&&n[gt][r])&&Vn(e,t,n,r)}function Vn(e,t,n,r){r=ur(r);On[H][r](e,t);n[E]=s}function $n(e,t,n){var r,i,o;if(n[Tt]||n[dt]||n[gt]){r=[R,D,tt];for(o=0;o<r[f];o+=1){i=r[o];Vn(e,t,n,i)}if(!t[H].mouseoutdrag){e.bind("mouseout.jCanvas",function(){var n=t[sn][k];if(n){t[sn]={};n.dragcancel&&n.dragcancel[C](e[0],n);e[P]()}});t[H].mouseoutdrag=s}n[E]=s}}function Jn(e,t,n,r){var i=t[k].names;r?r[X]!==a&&Mn(n[X])&&n[X]!==r[X]&&delete i[n[X]]:r=n;Mn(r[X])&&(i[r[X]]=n)}function Kn(e,t,n,r){var i=t[k][d],s,o,l,c,h;if(n[Wt]!==u){n[d]=[n[Wt]];n[Ot]&&(n[pt]=[n[Wt]])}if(r&&r[Wt]!==a)if(r[Wt]===u)r[d]=u;else{r[d]=[r[Wt]];r[Ot]&&(r[pt]=[r[Wt]])}if(!r)r=n;else if(r[d]!==a&&n[d]!==u)for(l=0;l<n[d][f];l+=1){o=n[d][l];s=i[o];if(s){for(h=0;h<s[f];h+=1)if(s[h]===n){c=h;s[m](h,1);break}s[f]===0&&delete i[o]}}if(r[d]!==a&&r[d]!==u)for(l=0;l<r[d][f];l+=1){o=r[d][l];s=i[o];if(!s){s=i[o]=[];s[X]=o}c===a&&(c=s[f]);s[m](c,0,n)}}function Qn(e){var t,n,r;t={};for(n=e[J][f]-1;n>=0;n-=1){t=e[J][n];if(t[Kt]){for(r=t[Kt][f]-1;r>=0;r-=1)if(!t[Kt][r][W]){t[W]=o;break}if(t[W])break}}return t}function Gn(e,t,n,r){if(n&&n[w]&&n[V]){r?n._next=r:n._next=u;n[V][C](e,n)}}function Yn(e,t,n){var r,i,u,a,l,c,h,p;a=t[sn];i=a[k];l=i[pt]||[];r=t[$t];if(n===D||n===vt){if(!a[Mt]){a[Mt]=s;if(i.bringToFront){r[m](i[M],1);i[M]=r.push(i)}for(p=0;p<l[f];p+=1){h=l[p];c=t[k][d][h];if(i[d]&&c)for(u=0;u<c[f];u+=1)if(c[u]!==i){c[u][Lt]=c[u].x;c[u][At]=c[u].y;c[u]._endX=i[it];c[u]._endY=i[ot];if(c[u].bringToFront){c[u][M]=hn(c[u],r);r[m](c[u][M],1);r[m](-1,0,c[u]);c[u][M]=r[f]-2}c[u][Pt]&&c[u][Pt][C](e[0],c[u])}}a[Lt]=i[Lt]=i.x;a[At]=i[At]=i.y;a._endX=i._endX=i[it];a._endY=i._endY=i[ot];Zn(e,i,Pt)}i.x=i[it]-(a._endX-a[Lt]);i.y=i[ot]-(a._endY-a[At]);for(p=0;p<l[f];p+=1){h=l[p];c=t[k][d][h];if(i[d]&&c)for(u=0;u<c[f];u+=1)if(c[u]!==i){c[u].x=i[it]-(c[u]._endX-c[u][Lt]);c[u].y=i[ot]-(c[u]._endY-c[u][At]);c[u][sn]&&c[u][sn][C](e[0],c[u])}}Zn(e,i,sn)}else if(n===tt||n===Et){if(a[Mt]){Zn(e,i,zt);a[Mt]=o}for(p=0;p<l[f];p+=1){h=l[p];c=t[k][d][h];if(i[d]&&c)for(u=0;u<c[f];u+=1)c[u]!==i&&c[u][zt]&&c[u][zt][C](e[0],c[u])}t[sn]={}}}function Zn(e,t,n,r){r||(t[gt]?r=t[gt][n]:r=t[dt]);r&&e.css({cursor:r});t[n]&&t[n][C](e[0],t)}function er(t,n,r,i){var o,a,l=n,c;n._args=r;n.canvas=t;if(n[Tt]||n[pt]){n[k]=s;n[Tt]=s}i?n[V]=i:n.method?n[V]=e.fn[n.method]:n.type?n[V]=e.fn[Sn[n.type]]:n[V]=function(){};if(n[k]&&!n._layer){o=e(t);a=o[L]();c=Wn(t);l=new An(n);l[k]=s;l._layer=s;Jn(o,c,l);Kn(o,c,l);Xn(o,c,l);$n(o,c,l);n[E]=l[E];l[M]===u&&(l[M]=a[f]);a[m](l[M],0,l)}return l}function tr(e){var t,n;for(n=0;n<kn[f];n+=1){t=kn[n];e[t]=e["_"+t]}}function nr(e,t){var n,r;for(r=0;r<kn[f];r+=1){n=kn[r];e["_"+n]=e[n];Ln[n]=s;t&&delete e[n]}}function rr(e,t,n){var r;for(r in n)n[tn](r)&&dn(n[r])&&(n[r]=n[r][C](e,t,r));return n}function ir(n){var r,s,o=[],u=1;if(n[un](/^#?\w+$/gi)){n===h&&(n="rgba(0,0,0,0)");s=t.head;r=s[St][qt];s[St][qt]=n;n=e.css(s,qt);s[St][qt]=r}if(n[un](/^rgb/gi)){o=n[un](/\d+/gi);n[un](/%/gi)&&(u=2.55);o[0]*=u;o[1]*=u;o[2]*=u;o[3]!==a?o[3]=i(o[3]):o[3]=1}return o}function sr(e){var t=3,n;if(pn(e[q])!=="array"){e[q]=ir(e[q]);e.end=ir(e.end)}e.now=[];if(e[q][3]!==1||e.end[3]!==1)t=4;for(n=0;n<t;n+=1){e.now[n]=e[q][n]+(e.end[n]-e[q][n])*e.pos;n<3&&(e.now[n]=vn(e.now[n]))}if(e[q][3]!==1||e.end[3]!==1)e.now="rgba("+e.now.join(",")+")";else{e.now[Y](0,3);e.now="rgb("+e.now.join(",")+")"}e.elem.nodeName?e.elem[St][e.prop]=e.now:e.elem[e.prop]=e.now}function or(t){var n;for(n=0;n<t[f];n+=1)e.fx.step[t[n]]=sr}function ur(e){window.ontouchstart!==undefined&&wn[e]&&(e=wn[e]);return e}function ar(e){En[e]&&(e=En[e]);return e}function fr(e){On[H][e]=function(t,n){var r,i;i=n[G];r=e===Q||e===et?D:e;if(!n[H][r]){t.bind(r+".jCanvas",function(e){i.x=e[Qt];i.y=e.offsetY;i.type=r;i[G]=e;t[P]({resetFire:s});e.preventDefault()});n[H][r]=s}}}function lr(e){var t;for(t=0;t<e[f];t+=1)fr(e[t])}function cr(e,t,n){var r,i,s,o,a,f,l,c;r=n._args;if(r[E]){i=Wn(e);s=i[G];if(s.x!==u&&s.y!==u){f=s.x*i[Ft];l=s.y*i[Ft];o=t.isPointInPath(f,l)||t[Gt]&&t[Gt](f,l)}a=i[p];r.eventX=r.mouseX=s.x;r.eventY=r.mouseY=s.y;r[G]=s[G];c=i[p][ht];f=r.eventX;l=r.eventY;if(c!==0){r[it]=f*yn(-c)-l*gn(-c);r[ot]=l*yn(-c)+f*gn(-c)}else{r[it]=f;r[ot]=l}r[it]/=a[lt];r[ot]/=a[ct];o&&i[J].push(r);r[W]=o}}function hr(e,t){isNaN(Number(t[N]))||(t[N]+="px");e.font=t[Jt]+" "+t[N]+" "+t[jt]}function pr(t,n,r,s){var o,u,a;if(Tn.text===r.text&&Tn[Jt]===r[Jt]&&Tn[N]===r[N]&&Tn[jt]===r[jt]&&Tn[Dt]===r[Dt]&&Tn[st]===r[st]){r[c]=Tn[c];r[l]=Tn[l]}else{r[c]=n[I](s[0])[c];for(a=1;a<s[f];a+=1){u=n[I](s[a])[c];u>r[c]&&(r[c]=u)}o=t[St][N];t[St][N]=r[N];r[l]=i(e.css(t,N))*s[f]*r[st];t[St][N]=o}}function dr(e,t){var n=t.text,r=t[Dt],i=n.split("\n"),s=[],o,u,a,l,h,p;for(a=0;a<i[f];a+=1){l=i[a];h=l.split(" ");o=[];u="";if(h[f]===1||e[I](l)[c]<r)o=[l];else{for(p=0;p<h[f];p+=1){if(e[I](u+h[p])[c]>r){u!==""&&o.push(u);u=""}u+=h[p];p!==h[f]-1&&(u+=" ")}o.push(u)}s=s.concat(o.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return s}var f="length",l="height",c="width",h="transparent",p="transforms",d="groups",v="shadowColor",m="splice",g="beginPath",y="getLayer",b="fillStyle",w="visible",E="_event",S="translate",x="getLayerGroup",T="strokeStyle",N="fontSize",C="call",k="layer",L="getLayers",A="getContext",O="savedTransforms",M="index",_="sHeight",D="mousemove",P="drawLayers",H="events",B="translateY",j="translateX",F="_toRad",I="measureText",q="start",R="mousedown",U="sWidth",z="closePath",W="intersects",X="name",V="_method",$="radius",J="intersecting",K="drawImage",Q="mouseover",G="event",Y="slice",Z="lineTo",et="mouseout",tt="mouseup",nt="lastIntersected",rt="animating",it="_eventX",st="lineHeight",ot="_eventY",ut="touchstart",at="jCanvas",ft="closed",lt="scaleX",ct="scaleY",ht="rotate",pt="dragGroups",dt="cursor",vt="touchmove",mt="bezierCurveTo",gt="cursors",yt="strokeWidth",bt="setLayer",wt="autosave",Et="touchend",St="style",xt="_fired",Tt="draggable",Nt="shadowBlur",Ct="restore",kt="inDegrees",Lt="_startX",At="_startY",Ot="dragGroupWithLayer",Mt="dragging",_t="_hovered",Dt="maxWidth",Pt="dragstart",Ht="animated",Bt="_animating",jt="fontFamily",Ft="pixelRatio",It="imageSmoothing",qt="color",Rt="drawQuadratic",Ut="<canvas />",zt="dragstop",Wt="group",Xt="moveTo",Vt="concavity",$t="layers",Jt="fontStyle",Kt="_masks",Qt="offsetX",Gt="isPointInStroke",Yt="drawPolygon",Zt="drawEllipse",en="load",tn="hasOwnProperty",nn="drawBezier",rn="drawVector",sn="drag",on="restoreCanvas",un="match",an="createPattern",fn="complete",ln,cn=e.extend,hn=e.inArray,pn=e.type,dn=e.isFunction,vn=r.round,mn=r.PI,gn=r.sin,yn=r.cos,bn=e[G].fix,wn,En,Sn,xn={},Tn={},Nn={},Cn={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},kn,Ln;e.fn[at]=On;On[H]={};ln={align:"center",autosave:s,baseline:"middle",bringToFront:o,ccw:o,closed:o,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:s,cursor:u,cursors:u,disableEvents:o,draggable:o,dragGroups:u,group:u,groups:u,data:{},each:u,end:360,fillStyle:h,fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:s,fn:u,height:u,imageSmoothing:s,inDegrees:s,index:u,lineHeight:1,layer:o,load:u,mask:o,maxWidth:u,miterLimit:10,name:u,opacity:1,r1:u,r2:u,radius:0,repeat:"repeat",respectAlign:o,rotate:0,rounded:o,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:h,shadowStroke:!1,shadowX:0,shadowY:0,sHeight:u,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeJoin:"miter",strokeStyle:h,strokeWidth:1,sWidth:u,sx:u,sy:u,text:"",translate:0,translateX:0,translateY:0,type:u,visible:s,width:u,x:0,y:0};On();On.extend=function(n){On.defaults=cn(ln,n.props);On();n[X]&&(e.fn[n[X]]=function r(e){var t=this,i,s,o,u,a;for(s=0;s<t[f];s+=1){i=t[s];o=_n(i);if(o){u=new An(e);a=er(i,u,e,r);Bn(i,o,u);n.fn[C](i,o,u)}}return t});return e.fn[n[X]]};e.fn[L]=function(t){var n=this[0],r,i,s,o=[];if(n&&n[A]){r=Wn(n);i=r[$t];if(dn(t))for(s=0;s<i[f];s+=1)t[C](n,i[s])&&o.push(i[s]);else o=i}return o};e.fn[y]=function(t){var n=this[0],r=Wn(n),i=r[$t],s=pn(t),o,u;if(t&&t[k])o=t;else if(s==="number"){t<0&&(t=i[f]+t);o=i[t]}else if(s==="regexp"){for(u=0;u<i[f];u+=1)if(Mn(i[u][X])&&i[u][X][un](t)){o=i[u];break}}else o=r[k].names[t];return o};e.fn[x]=function(t){var n=pn(t),r,i,s,o;if(n==="array")return t;if(n==="regexp"){o=Wn(this[0]);r=o[d];for(i in r)if(i[un](t)){s=r[i];break}}else{o=Wn(this[0]);s=o[k][d][t]}return s};e.fn.getLayerIndex=function(t){var n=this,r=n[L](),i=n[y](t);return hn(i,r)};e.fn[bt]=function(n,r){var i=this,s,o,u,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=Wn(i[o]);l=e(i[o])[y](n);if(l){Jn(s,u,l,r);Kn(s,u,l,r);r[M]!==a&&s.moveLayer(l,r[M]);cn(l,r);Xn(s,u,l);$n(s,u,l)}}return i};e.fn.setLayerGroup=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[x](n);if(u)for(a=0;a<u[f];a+=1)s[bt](u[a],r)}return i};e.fn.setLayers=function(n){var r=this,i,s,o,u;for(s=0;s<r[f];s+=1){i=e(r[s]);o=i[L]();for(u=0;u<o[f];u+=1)i[bt](o[u],n)}return r};e.fn.moveLayer=function(n,r){var i=this,s,o,u,a;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[L]();a=s[y](n);if(a){a[M]=hn(a,u);u[m](a[M],1);u[m](r,0,a);r<0&&(r=u[f]+r);a[M]=r}}return i};e.fn.removeLayer=function(n){var r=this,i,s,o,a,l;for(s=0;s<r[f];s+=1){i=e(r[s]);o=Wn(r[s]);a=i[L]();l=i[y](n);if(l){l[M]=hn(l,a);a[m](l[M],1);Jn(i,o,l,{name:u});Kn(i,o,l,{groups:u})}}return r};e.fn.removeLayerGroup=function(n){var r=this,i,s,o,l,c,h,p;if(n!==a)for(s=0;s<r[f];s+=1){i=e(r[s]);o=Wn(r[s]);l=i[L]();c=i[x](n);if(c){for(p=0;p<c[f];p+=1){h=c[p];h[M]=hn(h,l);l[m](h[M],1);Jn(i,o,h,{name:u})}delete o[k][d][c[X]]}}return r};e.fn.removeLayers=function(){var n=this,r,i,s;for(i=0;i<n[f];i+=1){r=e(n[i]);s=Wn(n[i]);s[$t][f]=0;s[k].names={};s[k][d]={}}return n};e.fn.addLayerToGroup=function(n,r){var i=this,s,o,u,a=[];for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[y](n);if(u[d]&&hn(r,u[d])===-1){a=u[d][Y](0);a.push(r);s[bt](u,{groups:a})}}return i};e.fn.removeLayerFromGroup=function(n,r){var i=this,s,o,u,a=[],l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[y](n);l=hn(r,u[d]);if(l!==-1){a=u[d][Y](0);a[m](l,1);s[bt](u,{groups:a})}}return i};e.fn.drawLayer=function(n){var r=this,i,s,o,u;for(i=0;i<r[f];i+=1){o=e(r[i]);s=_n(r[i]);u=o[y](n);Gn(o,s,u)}return r};e.fn[P]=function(n){var r=this,i,a,l,c=cn({},n),h,d,v,m,g,y,b,S,x;c[M]||(c[M]=0);for(a=0;a<r[f];a+=1){i=e(r[a]);l=_n(r[a]);if(l){y=Wn(r[a]);c.clear!==o&&i.clearCanvas();h=y[$t];for(m=c[M];m<h[f];m+=1){d=h[m];d[M]=m;c.resetFire&&(d[xt]=o);d[E]=!d.disableEvents;Gn(i,l,d,m+1);d[Kt]=y[p].masks[Y](0);if(d[V]===e.fn[K]&&d[w])break}g=m;d=Qn(y);b=y[G];S=b.type;d[S]||(S=ar(S));x=y[sn];v=y[nt];if(v!==u&&d!==v&&v[_t]&&!v[xt]){y[nt]=u;v[xt]=s;v[_t]=o;Zn(i,v,et,y[dt])}if(d[E]&&d[W]){y[nt]=d;if(d[Q]||d[et]||d[dt]||d[gt])if(!d[_t]&&!d[xt]){d[xt]=s;d[_t]=s;Zn(i,d,Q)}if(!d[xt]){d[xt]=s;b.type=u;Zn(i,d,S)}d[Tt]&&(S===R||S===ut)&&(x[k]=d)}x[k]&&Yn(i,y,S);if(g===h[f]){y[J][f]=0;y[p]=Dn(Cn);y[O][f]=0}}}return r};e.fn.addLayer=function(t){var n=this,r,i,o;for(r=0;r<n[f];r+=1){i=_n(n[r]);if(i){o=new An(t);o[k]=s;er(n[r],o,t)}}return n};kn=[c,l,"opacity",st];Ln={};e.fn.animateLayer=function(){function v(e,t,n){return function(){tr(n);(!t[rt]||t[Ht]===n)&&e[P]();c[4]&&c[4][C](e[0],n);n[Bt]=o;t[rt]=o;t[Ht]=u}}function g(e,t,n){return function(r,i){if(t.pos!==i.pos){t.pos=i.pos;tr(n);if(!n[Bt]&&!t[rt]){n[Bt]=s;t[rt]=s;t[Ht]=n}(!t[rt]||t[Ht]===n)&&e[P]();c[5]&&c[5][C](e[0],r,i,n)}}}var n=this,r,i,l,c=[][Y][C](arguments,0),h,p,d;if(pn(c[2])==="object"){c[m](2,0,c[2].duration||u);c[m](3,0,c[3].easing||u);c[m](4,0,c[4].done||c[4][fn]||u);c[m](5,0,c[5].step||u)}else{if(c[2]===a){c[m](2,0,u);c[m](3,0,u);c[m](4,0,u)}else if(dn(c[2])){c[m](2,0,u);c[m](3,0,u)}if(c[3]===a){c[3]=u;c[m](4,0,u)}else dn(c[3])&&c[m](3,0,u)}for(i=0;i<n[f];i+=1){r=e(n[i]);l=_n(n[i]);if(l){h=Wn(n[i]);p=r[y](c[0]);if(p&&p[V]!==e.fn.draw){d=cn({},c[1]);d=rr(n[i],p,d);nr(d,s);nr(p);p[St]=Ln;e(p).animate(d,{duration:c[2],easing:e.easing[c[3]]?c[3]:u,complete:v(r,h,p),step:g(r,h,p)})}}}return n};e.fn.animateLayerGroup=function(n){var r=this,i,s,o=[][Y][C](arguments,0),u,a;for(s=0;s<r[f];s+=1){i=e(r[s]);u=i[x](n);if(u)for(a=0;a<u[f];a+=1)i.animateLayer.apply(i,[u[a]].concat(o[Y](1)))}return r};e.fn.delayLayer=function(n,r){var i=this,s,o;r=r||0;for(s=0;s<i[f];s+=1){o=e(i[s])[y](n);e(o).delay(r)}return i};e.fn.delayLayerGroup=function(n,r){var i=this,s,o,u,a,l;r=r||0;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[x](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).delay(r)}}return i};e.fn.stopLayer=function(n,r){var i=this,s,o,u;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[y](n);u&&e(u).stop(r)}return i};e.fn.stopLayerGroup=function(n,r){var i=this,s,o,u,a,l;for(o=0;o<i[f];o+=1){s=e(i[o]);u=s[x](n);if(u)for(l=0;l<u[f];l+=1){a=u[l];a&&e(a).stop(r)}}return i};or([qt,"backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor",b,"outlineColor",T,v]);wn={mousedown:ut,mouseup:Et,mousemove:vt};En={touchstart:R,touchend:tt,touchmove:D};lr(["click","dblclick",R,tt,D,Q,et,ut,vt,Et]);e[G].fix=function(t){var n,r,i;t=bn[C](e[G],t);r=t.originalEvent;if(r){i=r.changedTouches;if(t.pageX!==a&&t[Qt]===a){n=e(t.target).offset();if(n){t[Qt]=t.pageX-n.left;t.offsetY=t.pageY-n.top}}else if(i){n=e(r.target).offset();if(n){t[Qt]=i[0].pageX-n.left;t.offsetY=i[0].pageY-n.top}}}return t};Sn={arc:"drawArc",bezier:nn,ellipse:Zt,"function":"draw",image:K,line:"drawLine",polygon:Yt,slice:"drawSlice",quadratic:Rt,rectangle:"drawRect",text:"drawText",vector:rn};e.fn.draw=function vr(t){var n=this,r,i,s,o=new An(t),u;if(Sn[o.type])n[Sn[o.type]](o);else for(i=0;i<n[f];i+=1){r=e(n[i]);s=_n(n[i]);if(s){o=new An(t);u=er(n[i],o,t,vr);o[w]&&o.fn&&o.fn[C](n[i],s,o)}}return n};e.fn.clearCanvas=function mr(e){var t=this,n,r,i=new An(e),s;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r)if(i[c]===u||i[l]===u){r.save();r.setTransform(1,0,0,1,0,0);r.clearRect(0,0,t[n][c],t[n][l]);r[Ct]()}else{s=er(t[n],i,e,mr);zn(t[n],r,i,i[c],i[l]);r.clearRect(i.x-i[c]/2,i.y-i[l]/2,i[c],i[l]);Fn(r,i)}}return t};e.fn.saveCanvas=function gr(e){var t=this,n,r,i,s,o,u;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){o=Wn(t[n]);i=new An(e);s=er(t[n],i,e,gr);for(u=0;u<i.count;u+=1)Pn(r,o)}}return t};e.fn[on]=function yr(e){var t=this,n,r,i,s,o,u;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){o=Wn(t[n]);i=new An(e);s=er(t[n],i,e,yr);for(u=0;u<i.count;u+=1)Hn(r,o)}}return t};e.fn.restoreCanvasOnRedraw=function(t){var n=this,r=cn({},t);r[k]=s;n[on](r);return n};e.fn.rotateCanvas=function br(e){var t=this,n,r,i,s,o;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){o=Wn(t[n]);i=new An(e);s=er(t[n],i,e,br);i[wt]&&Pn(r,o);qn(r,i,o[p])}}return t};e.fn.scaleCanvas=function wr(e){var t=this,n,r,i,s,o;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){o=Wn(t[n]);i=new An(e);s=er(t[n],i,e,wr);i[wt]&&Pn(r,o);Rn(r,i,o[p])}}return t};e.fn.translateCanvas=function Er(e){var t=this,n,r,i,s,o;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){o=Wn(t[n]);i=new An(e);s=er(t[n],i,e,Er);i[wt]&&Pn(r,o);Un(r,i,o[p])}}return t};e.fn.drawRect=function Sr(e){var t=this,n,r,i,u,a,h,p,d,v;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);u=er(t[n],i,e,Sr);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,i[c],i[l]);r[g]();a=i.x-i[c]/2;h=i.y-i[l]/2;v=i.cornerRadius;if(v){i[ft]=s;p=i.x+i[c]/2;d=i.y+i[l]/2;p-a-2*v<0&&(v=(p-a)/2);d-h-2*v<0&&(v=(d-h)/2);r[Xt](a+v,h);r[Z](p-v,h);r.arc(p-v,h+v,v,3*mn/2,mn*2,o);r[Z](p,d-v);r.arc(p-v,d-v,v,0,mn/2,o);r[Z](a+v,d);r.arc(a+v,d-v,v,mn/2,mn,o);r[Z](a,h+v);r.arc(a+v,h+v,v,mn,3*mn/2,o)}else r.rect(a,h,i[c],i[l]);i[E]&&cr(t[n],r,i);In(t[n],r,i)}}}return t};e.fn.drawArc=function xr(e){var t=this,n,r,i,s;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);s=er(t[n],i,e,xr);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,i[$]*2);!i[kt]&&i.end===360&&(i.end=mn*2);i[q]*=i[F];i.end*=i[F];i[q]-=mn/2;i.end-=mn/2;r[g]();r.arc(i.x,i.y,i[$],i[q],i.end,i.ccw);i[E]&&cr(t[n],r,i);In(t[n],r,i)}}}return t};e.fn[Zt]=function Tr(e){var t=this,n,r,i,o,u,a;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);o=er(t[n],i,e,Tr);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,i[c],i[l]);u=i[c]*(4/3);a=i[l];r[g]();r[Xt](i.x,i.y-a/2);r[mt](i.x-u/2,i.y-a/2,i.x-u/2,i.y+a/2,i.x,i.y+a/2);r[mt](i.x+u/2,i.y+a/2,i.x+u/2,i.y-a/2,i.x,i.y-a/2);i[E]&&cr(t[n],r,i);i[ft]=s;In(t[n],r,i)}}}return t};e.fn[Yt]=function Nr(e){var t=this,n,r,i,o,u,a,l,c,h,p,d;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);o=er(t[n],i,e,Nr);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,i[$]*2);a=2*mn/i.sides;l=a/2;u=l+mn/2;c=i[$]*yn(l);r[g]();for(d=0;d<i.sides;d+=1){h=i.x+i[$]*yn(u);p=i.y+i[$]*gn(u);r[Z](h,p);if(i[Vt]){h=i.x+(c+ -c*i[Vt])*yn(u+l);p=i.y+(c+ -c*i[Vt])*gn(u+l);r[Z](h,p)}u+=a}i[E]&&cr(t[n],r,i);i[ft]=s;In(t[n],r,i)}}}return t};e.fn.drawSlice=function Cr(t){var n=this,r,i,o,u,a,l,c,h;for(i=0;i<n[f];i+=1){r=e(n[i]);o=_n(n[i]);if(o){u=new An(t);a=er(n[i],u,t,Cr);if(u[w]){Bn(n[i],o,u);zn(n[i],o,u,u[$]*2);u[q]*=u[F];u.end*=u[F];u[q]-=mn/2;u.end-=mn/2;while(u[q]<0)u[q]+=2*mn;while(u.end<0)u.end+=2*mn;u.end<u[q]&&(u.end+=2*mn);l=(u[q]+u.end)/2;c=u[$]*u.spread*yn(l);h=u[$]*u.spread*gn(l);u.x+=c;u.y+=h;o[g]();o.arc(u.x,u.y,u[$],u[q],u.end,u.ccw);o[Z](u.x,u.y);u[E]&&cr(n[i],o,u);u[ft]=s;In(n[i],o,u)}}}return n};e.fn.drawLine=function kr(e){var t=this,n,r,i,o,u,l,c;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);o=er(t[n],i,e,kr);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,0);u=1;r[g]();while(s){l=i["x"+u];c=i["y"+u];if(l===a||c===a)break;r[Z](l+i.x,c+i.y);u+=1}i[E]&&cr(t[n],r,i);In(t[n],r,i)}}}return t};e.fn[Rt]=function Lr(e){var t=this,n,r,i,o,u,l,c,h,p;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);o=er(t[n],i,e,Lr);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,0);u=2;r[g]();r[Xt](i.x1+i.x,i.y1+i.y);while(s){l=i["x"+u];c=i["y"+u];h=i["cx"+(u-1)];p=i["cy"+(u-1)];if(l===a||c===a||h===a||p===a)break;r.quadraticCurveTo(h+i.x,p+i.y,l+i.x,c+i.y);u+=1}i[E]&&cr(t[n],r,i);In(t[n],r,i)}}}return t};e.fn[nn]=function Ar(e){var t=this,n,r,i,o,u,l,c,h,p,d,v,m;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);o=er(t[n],i,e,Ar);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,0);u=2;l=1;r[g]();r[Xt](i.x1+i.x,i.y1+i.y);while(s){c=i["x"+u];h=i["y"+u];p=i["cx"+l];d=i["cy"+l];v=i["cx"+(l+1)];m=i["cy"+(l+1)];if(c===a||h===a||p===a||d===a||v===a||m===a)break;r[mt](p+i.x,d+i.y,v+i.x,m+i.y,c+i.x,h+i.y);u+=1;l+=2}i[E]&&cr(t[n],r,i);In(t[n],r,i)}}}return t};e.fn[rn]=function Or(e){var t=this,n,r,i,o,u,l,c,h,p;for(n=0;n<t[f];n+=1){r=_n(t[n]);if(r){i=new An(e);o=er(t[n],i,e,Or);if(i[w]){Bn(t[n],r,i);zn(t[n],r,i,0);u=1;r[g]();h=i.x;p=i.y;r[Xt](i.x,i.y);while(s){l=i["a"+u];c=i["l"+u];if(l===a||c===a)break;l*=i[F];l-=mn/2;h+=c*yn(l);p+=c*gn(l);r[Z](h,p);u+=1}i[E]&&cr(t[n],r,i);In(t[n],r,i)}}}return t};e.fn.drawText=function Mr(t){var n=this,r,i,s,o,a,p,d,m,y;for(i=0;i<n[f];i+=1){r=e(n[i]);s=_n(n[i]);if(s){o=new An(t);a=er(n[i],o,t,Mr);if(o[w]){Bn(n[i],s,o);s.textBaseline=o.baseline;s.textAlign=o.align;hr(s,o);o[Dt]!==u?p=dr(s,o):p=o.text.toString().split("\n");pr(n[i],s,o,p);if(t&&o[k]){t[c]=o[c];t[l]=o[l]}m=o.x;o.align==="left"?o.respectAlign?o.x+=o[c]/2:m-=o[c]/2:o.align==="right"&&(o.respectAlign?o.x-=o[c]/2:m+=o[c]/2);zn(n[i],s,o,o[c],o[l]);for(d=0;d<p[f];d+=1){s[v]=o[v];y=o.y+d*o[l]/p[f]-(p[f]-1)*o[l]/p[f]/2;s.fillText(p[d],m,y);o[b]!==h&&(s[v]=h);s.strokeText(p[d],m,y)}if(o[E]){s[g]();s.rect(o.x-o[c]/2,o.y-o[l]/2,o[c],o[l]);cr(n[i],s,o);s[z]()}Fn(s,o)}}}Tn=o;return n};e.fn[I]=function(t){var n=this,r,i,s;t&&t[k]||pn(t)==="string"?i=n[y](t):i=new An(t);if(!i)i={};else{r=_n(n[0]);if(r){hr(r,i);s=dr(r,i);pr(n[0],r,i,s)}}return i};e.fn[K]=function _r(t){function T(e,t,n,i,s){i[c]===u&&i[U]===u&&(i[c]=i[U]=b[c]);i[l]===u&&i[_]===u&&(i[l]=i[_]=b[l]);if(s){s[c]=i[c];s[l]=i[l]}if(i[U]!==u&&i[_]!==u&&i.sx!==u&&i.sy!==u){i[c]===u&&(i[c]=i[U]);i[l]===u&&(i[l]=i[_]);if(!i.cropFromCenter){i.sx+=i[U]/2;i.sy+=i[_]/2}i.sy-i[_]/2<0&&(i.sy=i[_]/2);i.sy+i[_]/2>b[l]&&(i.sy=b[l]-i[_]/2);i.sx-i[U]/2<0&&(i.sx=i[U]/2);i.sx+i[U]/2>b[c]&&(i.sx=b[c]-i[U]/2);zn(r[e],t,i,i[c],i[l]);t[K](b,i.sx-i[U]/2,i.sy-i[_]/2,i[U],i[_],i.x-i[c]/2,i.y-i[l]/2,i[c],i[l])}else{zn(r[e],t,i,i[c],i[l]);t[K](b,i.x-i[c]/2,i.y-i[l]/2,i[c],i[l])}Bn(r[e],t,i);t[g]();t.rect(i.x-i[c]/2,i.y-i[l]/2,i[c],i[l]);i[E]&&cr(r[e],t,i);t[z]();t.stroke();Fn(t,i);jn(t,n,i)}function N(t,n,r,i,u,a){return function(){T(n,r,i,u,a);u[en]&&u[en][C](t,a);if(u[k]){u._args[Kt]=i[p].masks[Y](0);u._next&&e(t)[P]({clear:o,resetFire:s,index:u._next})}}}var r=this,i,h,d,v,m,y,b,S,x;for(h=0;h<r[f];h+=1){i=r[h];d=_n(r[h]);if(d){v=Wn(r[h]);m=new An(t);y=er(r[h],m,t,_r);if(m[w]){x=m.source;S=x[A];if(x.src||S)b=x;else if(x)if(Nn[x]!==a)b=Nn[x];else{b=new n;b.src=x;Nn[x]=b}if(b)if(b[fn]||S)N(i,h,d,v,m,y)();else{e(b).bind(en,N(i,h,d,v,m,y));b.src=b.src}}}}return r};e.fn[an]=function(r){function d(){h=s[an](a,o.repeat);o[en]&&o[en][C](i[0],h)}var i=this,s,o,a,f,h,p;s=_n(i[0]);if(s){o=new An(r);p=o.source;if(dn(p)){a=e(Ut)[0];a[c]=o[c];a[l]=o[l];f=_n(a);p[C](a,f);d()}else{f=p[A];if(p.src||f)a=p;else{a=new n;a.src=p}if(a[fn]||f)d();else{e(a).bind(en,d);a.src=a.src}}}else h=u;return h};e.fn.createGradient=function(t){var n=this,r,i,s,o=[],l,c,h,p,d,v,m;i=new An(t);r=_n(n[0]);if(r){i.x1=i.x1||0;i.y1=i.y1||0;i.x2=i.x2||0;i.y2=i.y2||0;i.r1!==u||i.r2!==u?s=r.createRadialGradient(i.x1,i.y1,i.r1,i.x2,i.y2,i.r2):s=r.createLinearGradient(i.x1,i.y1,i.x2,i.y2);for(p=1;i["c"+p]!==a;p+=1)i["s"+p]!==a?o.push(i["s"+p]):o.push(u);l=o[f];o[0]===u&&(o[0]=0);o[l-1]===u&&(o[l-1]=1);for(p=0;p<l;p+=1){if(o[p]!==u){v=1;m=0;c=o[p];for(d=p+1;d<l;d+=1){if(o[d]!==u){h=o[d];break}v+=1}c>h&&(o[d]=o[p])}else if(o[p]===u){m+=1;o[p]=c+m*((h-c)/v)}s.addColorStop(o[p],i["c"+(p+1)])}}else s=u;return s};e.fn.setPixels=function Dr(e){var t=this,n,r,i,s,o,a,h,p,d,v;for(r=0;r<t[f];r+=1){n=t[r];i=_n(n);if(i){s=new An(e);o=er(n,s,e,Dr);zn(t[r],i,s,s[c],s[l]);if(s[c]===u||s[l]===u){s[c]=n[c];s[l]=n[l];s.x=s[c]/2;s.y=s[l]/2}if(s[c]!==0&&s[l]!==0){h=i.getImageData(s.x-s[c]/2,s.y-s[l]/2,s[c],s[l]);p=h.data;v=p[f];if(s.each)for(d=0;d<v;d+=4){a={r:p[d],g:p[d+1],b:p[d+2],a:p[d+3]};s.each[C](n,a,s);p[d]=a.r;p[d+1]=a.g;p[d+2]=a.b;p[d+3]=a.a}i.putImageData(h,s.x-s[c]/2,s.y-s[l]/2);i[Ct]()}}}return t};e.fn.getCanvasImage=function(t,n){var r=this[0];n===a&&(n=1);return r&&r.toDataURL?r.toDataURL("image/"+t,n):u};e.fn.detectPixelRatio=function(n){var r=this,i,o,u,a,h,p,d,v,m,g;for(u=0;u<r[f];u+=1){o=r[u];i=e(r[u]);a=_n(o);g=Wn(r[u]);if(!g.scaled){h=window.devicePixelRatio||1;p=a.webkitBackingStorePixelRatio||a.mozBackingStorePixelRatio||a.msBackingStorePixelRatio||a.oBackingStorePixelRatio||a.backingStorePixelRatio||1;d=h/p;if(d!==1){v=o[c];m=o[l];o[c]=v*d;o[l]=m*d;o[St][c]=v+"px";o[St][l]=m+"px";a.scale(d,d)}g[Ft]=d;g.scaled=s;n&&n[C](o,d)}}return r};e.support.canvas=e(Ut)[0][A];On.defaults=ln;On.transformShape=zn;On.detectEvents=cr;On[z]=In;On.getTouchEventName=ur;e[at]=On})(jQuery,document,Image,Math,parseFloat,!0,!1,null);