/**
 * @license jCanvas v15.06.16
 * Copyright 2015 Caleb Evans
 * Released under the MIT license
 */
!function(e,t,r){"object"==typeof module&&"object"==typeof module.exports?module.exports=t.document?r(t,!0):function(e,t){return r(e,t)}:r(e,t)}("undefined"!=typeof window?window.$:{},"undefined"!=typeof window?window:this,function($,e){function t(e){var t=this,r;for(r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t}function r(){be(this,r.baseDefaults)}function n(e){return"string"===Le(e)}function a(e){return!isNaN(ue(e))&&!isNaN(ye(e))}function o(e){return e&&e.getContext?e.getContext("2d"):me}function i(e){var t,r,n;for(t in e)e.hasOwnProperty(t)&&(n=e[t],r=Le(n),"string"===r&&a(n)&&"text"!==t&&(e[t]=ye(n)));void 0!==e.text&&(e.text=String(e.text))}function s(e){return e=be({},e),e.masks=e.masks.slice(0),e}function l(e,t){var r;e.save(),r=s(t.transforms),t.savedTransforms.push(r)}function h(e,t){0===t.savedTransforms.length?t.transforms=s(He):(e.restore(),t.transforms=t.savedTransforms.pop())}function c(e,t,r,n){r[n]&&(ke(r[n])?t[n]=r[n].call(e,r):t[n]=r[n])}function g(e,t,r){c(e,t,r,"fillStyle"),c(e,t,r,"strokeStyle"),t.lineWidth=r.strokeWidth,r.rounded?t.lineCap=t.lineJoin="round":(t.lineCap=r.strokeCap,t.lineJoin=r.strokeJoin,t.miterLimit=r.miterLimit),r.strokeDash||(r.strokeDash=[]),t.setLineDash&&t.setLineDash(r.strokeDash),t.webkitLineDash=t.mozDash=r.strokeDash,t.lineDashOffset=t.webkitLineDashOffset=t.mozDashOffset=r.strokeDashOffset,t.shadowOffsetX=r.shadowX,t.shadowOffsetY=r.shadowY,t.shadowBlur=r.shadowBlur,t.shadowColor=r.shadowColor,t.globalAlpha=r.opacity,t.globalCompositeOperation=r.compositing,r.imageSmoothing&&(t.imageSmoothingEnabled=t.mozImageSmoothingEnabled=r.imageSmoothingEnabled)}function d(e,t,r){r.mask&&(r.autosave&&l(e,t),e.clip(),t.transforms.masks.push(r._args))}function f(e,t){t._transformed&&e.restore()}function u(e,t,r){var n;r.closed&&t.closePath(),r.shadowStroke&&0!==r.strokeWidth?(t.stroke(),t.fill(),t.shadowColor="transparent",t.shadowBlur=0,t.stroke()):(t.fill(),"transparent"!==r.fillStyle&&(t.shadowColor="transparent"),0!==r.strokeWidth&&t.stroke()),r.closed||t.closePath(),f(t,r),r.mask&&(n=v(e),d(t,n,r))}function y(e,t,r,n,a){r._toRad=r.inDegrees?Te/180:1,r._transformed=ve,t.save(),r.fromCenter||r._centered||n===we||(a===we&&(a=n),r.x+=n/2,r.y+=a/2,r._centered=ve),r.rotate&&B(t,r,me),(1!==r.scale||1!==r.scaleX||1!==r.scaleY)&&N(t,r,me),(r.translate||r.translateX||r.translateY)&&J(t,r,me)}function v(e){var t=ze.dataCache,r;return t._canvas===e&&t._data?r=t._data:(r=$.data(e,"jCanvas"),r||(r={canvas:e,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:me,cursor:$(e).css("cursor"),drag:{layer:me,dragging:pe},event:{type:me,x:me,y:me},events:{},transforms:s(He),savedTransforms:[],animating:pe,animated:me,pixelRatio:1,scaled:pe},$.data(e,"jCanvas",r)),t._canvas=e,t._data=r),r}function p(e,t,r){var n;for(n in Ee.events)Ee.events.hasOwnProperty(n)&&(r[n]||r.cursors&&r.cursors[n])&&m(e,t,r,n);t.events.mouseout||(e.bind("mouseout.jCanvas",function(){var r=t.drag.layer,n;for(r&&(t.drag={},R(e,t,r,"dragcancel")),n=0;n<t.layers.length;n+=1)r=t.layers[n],r._hovered&&e.triggerLayerEvent(t.layers[n],"mouseout");e.drawLayers()}),t.events.mouseout=ve)}function m(e,t,r,n){Ee.events[n](e,t),r._event=ve}function w(e,t,r){var n,a,o;if(r.draggable||r.cursors){for(n=["mousedown","mousemove","mouseup"],o=0;o<n.length;o+=1)a=n[o],m(e,t,r,a);r._event=ve}}function x(e,t,r,a){var o=t.layer.names;a?a.name!==we&&n(r.name)&&r.name!==a.name&&delete o[r.name]:a=r,n(a.name)&&(o[a.name]=r)}function b(e,t,r,n){var a=t.layer.groups,o,i,s,l,h;if(n){if(n.groups!==we&&r.groups!==me)for(s=0;s<r.groups.length;s+=1)if(i=r.groups[s],o=a[i]){for(h=0;h<o.length;h+=1)if(o[h]===r){l=h,o.splice(h,1);break}0===o.length&&delete a[i]}}else n=r;if(n.groups!==we&&n.groups!==me)for(s=0;s<n.groups.length;s+=1)i=n.groups[s],o=a[i],o||(o=a[i]=[],o.name=i),l===we&&(l=o.length),o.splice(l,0,r)}function _(e){var t,r,n,a;for(t=me,r=e.intersecting.length-1;r>=0;r-=1)if(t=e.intersecting[r],t._masks){for(a=t._masks.length-1;a>=0;a-=1)if(n=t._masks[a],!n.intersects){t.intersects=pe;break}if(t.intersects&&!t.intangible)break}return t&&t.intangible&&(t=me),t}function L(e,t,r,n){r&&r.visible&&r._method&&(n?r._next=n:r._next=me,r._method.call(e,r))}function k(e,t,r){var n,a,o,i,s,l,h,c,g,d;if(i=t.drag,a=i.layer,s=a&&a.dragGroups||[],n=t.layers,"mousemove"===r||"touchmove"===r){if(i.dragging||(i.dragging=ve,a.dragging=ve,a.bringToFront&&(n.splice(a.index,1),a.index=n.push(a)),a._startX=a.x,a._startY=a.y,a._endX=a._eventX,a._endY=a._eventY,R(e,t,a,"dragstart")),i.dragging)for(g=a._eventX-(a._endX-a._startX),d=a._eventY-(a._endY-a._startY),a.dx=g-a.x,a.dy=d-a.y,"y"!==a.restrictDragToAxis&&(a.x=g),"x"!==a.restrictDragToAxis&&(a.y=d),R(e,t,a,"drag"),c=0;c<s.length;c+=1)if(h=s[c],l=t.layer.groups[h],a.groups&&l)for(o=0;o<l.length;o+=1)l[o]!==a&&("y"!==a.restrictDragToAxis&&"y"!==l[o].restrictDragToAxis&&(l[o].x+=a.dx),"x"!==a.restrictDragToAxis&&"x"!==l[o].restrictDragToAxis&&(l[o].y+=a.dy))}else("mouseup"===r||"touchend"===r)&&(i.dragging&&(a.dragging=pe,i.dragging=pe,R(e,t,a,"dragstop")),t.drag={})}function C(e,t,r){var n;t.cursors&&(n=t.cursors[r]),-1!==$.inArray(n,We.cursors)&&(n=We.prefix+n),n&&e.css({cursor:n})}function T(e,t){e.css({cursor:t.cursor})}function S(e,t,r,n,a){n[r]&&t._running&&!t._running[r]&&(t._running[r]=ve,n[r].call(e[0],t,a),t._running[r]=pe)}function P(e,t){return!(e.disableEvents||e.intangible&&-1!==$.inArray(t,je))}function R(e,t,r,n,a){P(r,n)&&("mouseout"!==n&&C(e,r,n),S(e,r,n,r,a),S(e,r,n,t.eventHooks,a),S(e,r,n,Ee.eventHooks,a))}function X(e,r,a,o){var s,l,h,c=r._layer?a:r;return r._args=a,(r.draggable||r.dragGroups)&&(r.layer=ve,r.draggable=ve),r._method||(o?r._method=o:r.method?r._method=$.fn[r.method]:r.type?r._method=$.fn[Ae.drawings[r.type]]:r._method=function(){}),r.layer&&!r._layer?(s=$(e),l=v(e),h=l.layers,(c.name===me||n(c.name)&&l.layer.names[c.name]===we)&&(i(r),c=new t(r),c.canvas=e,c.layer=ve,c._layer=ve,c._running={},c.data!==me?c.data=be({},c.data):c.data={},c.groups!==me?c.groups=c.groups.slice(0):c.groups=[],x(s,l,c),b(s,l,c),p(s,l,c),w(s,l,c),r._event=c._event,c._method===$.fn.drawText&&s.measureText(c),c.index===me&&(c.index=h.length),h.splice(c.index,0,c),r._args=c,R(s,l,c,"add"))):r.layer||i(r),c}function Y(e){var t,r;for(r=0;r<We.props.length;r+=1)t=We.props[r],e[t]=e["_"+t]}function O(e,t){var r,n;for(n=0;n<We.props.length;n+=1)r=We.props[n],e[r]!==we&&(e["_"+r]=e[r],We.propsObj[r]=ve,t&&delete e[r])}function D(e,t,r){var n,a,o,i;for(n in r)if(r.hasOwnProperty(n)&&(a=r[n],ke(a)&&(r[n]=a.call(e,t,n)),"object"===Le(a)&&Ce(a))){for(o in a)a.hasOwnProperty(o)&&(i=a[o],t[n]!==we&&(t[n+"."+o]=t[n][o],r[n+"."+o]=i));delete r[n]}return r}function A(e){var t;for(t in e)e.hasOwnProperty(t)&&-1!==t.indexOf(".")&&delete e[t]}function z(e){var t,r,n=[],a=1;return e.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&("transparent"===e&&(e="rgba(0, 0, 0, 0)"),r=he.head,t=r.style.color,r.style.color=e,e=$.css(r,"color"),r.style.color=t),e.match(/^rgb/gi)&&(n=e.match(/(\d+(\.\d+)?)/gi),e.match(/%/gi)&&(a=2.55),n[0]*=a,n[1]*=a,n[2]*=a,n[3]!==we?n[3]=ye(n[3]):n[3]=1),n}function H(e){var t=3,r;for("array"!==Le(e.start)&&(e.start=z(e.start),e.end=z(e.end)),e.now=[],(1!==e.start[3]||1!==e.end[3])&&(t=4),r=0;t>r;r+=1)e.now[r]=e.start[r]+(e.end[r]-e.start[r])*e.pos,3>r&&(e.now[r]=Se(e.now[r]));1!==e.start[3]||1!==e.end[3]?e.now="rgba( "+e.now.join(",")+" )":(e.now.slice(0,3),e.now="rgb( "+e.now.join(",")+" )"),e.elem.nodeName?e.elem.style[e.prop]=e.now:e.elem[e.prop]=e.now}function W(e){var t;for(t=0;t<e.length;t+=1)$.fx.step[e[t]]=H}function j(e){return Ae.touchEvents[e]&&(e=Ae.touchEvents[e]),e}function E(e){return Ae.mouseEvents[e]&&(e=Ae.mouseEvents[e]),e}function G(e){Ee.events[e]=function(t,r){function n(e){i.x=e.offsetX,i.y=e.offsetY,i.type=a,i.event=e,t.drawLayers({resetFire:ve}),e.preventDefault()}var a,o,i;i=r.event,a="mouseover"===e||"mouseout"===e?"mousemove":e,o=j(a),r.events[a]||(o!==a?t.bind(a+".jCanvas "+o+".jCanvas",n):t.bind(a+".jCanvas",n),r.events[a]=ve)}}function I(e){var t;for(t=0;t<e.length;t+=1)G(e[t])}function F(e,t,r){var n,a,o,i,s,l,h,c;n=r._args,n&&(a=v(e),o=a.event,o.x!==me&&o.y!==me&&(l=o.x*a.pixelRatio,h=o.y*a.pixelRatio,i=t.isPointInPath(l,h)||t.isPointInStroke&&t.isPointInStroke(l,h)),s=a.transforms,n.eventX=o.x,n.eventY=o.y,n.event=o.event,c=a.transforms.rotate,l=n.eventX,h=n.eventY,0!==c?(n._eventX=l*Xe(-c)-h*Re(-c),n._eventY=h*Xe(-c)+l*Re(-c)):(n._eventX=l,n._eventY=h),n._eventX/=s.scaleX,n._eventY/=s.scaleY,i&&a.intersecting.push(n),n.intersects=!!i)}function B(e,t,r){t._toRad=t.inDegrees?Te/180:1,e.translate(t.x,t.y),e.rotate(t.rotate*t._toRad),e.translate(-t.x,-t.y),r&&(r.rotate+=t.rotate*t._toRad)}function N(e,t,r){1!==t.scale&&(t.scaleX=t.scaleY=t.scale),e.translate(t.x,t.y),e.scale(t.scaleX,t.scaleY),e.translate(-t.x,-t.y),r&&(r.scaleX*=t.scaleX,r.scaleY*=t.scaleY)}function J(e,t,r){t.translate&&(t.translateX=t.translateY=t.translate),e.translate(t.translateX,t.translateY),r&&(r.translateX+=t.translateX,r.translateY+=t.translateY)}function q(e){for(;0>e;)e+=2*Te;return e}function Q(e,t){return e.x+e.radius*Xe(t)}function U(e,t){return e.y+e.radius*Re(t)}function V(e,t,r,n){var a,o,i,s,l,h,c,g,d,f,u;r===n?(d=0,f=0):(d=r.x,f=r.y),n.inDegrees||360!==n.end||(n.end=2*Te),n.start*=r._toRad,n.end*=r._toRad,n.start-=Te/2,n.end-=Te/2,u=Te/180,n.ccw&&(u*=-1),a=Q(n,n.start+u),o=U(n,n.start+u),i=Q(n,n.start),s=U(n,n.start),K(e,t,r,n,a,o,i,s),t.arc(n.x+d,n.y+f,n.radius,n.start,n.end,n.ccw),l=Q(n,n.end+u),h=U(n,n.end+u),c=Q(n,n.end),g=U(n,n.end),Z(e,t,r,n,c,g,l,h)}function M(e,t,r,n,a,o,i,s){var l,h,c,g,d,f,u;n.arrowRadius&&!r.closed&&(u=Ye(s-o,i-a),u-=Te,d=r.strokeWidth*Xe(u),f=r.strokeWidth*Re(u),l=i+n.arrowRadius*Xe(u+n.arrowAngle/2),h=s+n.arrowRadius*Re(u+n.arrowAngle/2),c=i+n.arrowRadius*Xe(u-n.arrowAngle/2),g=s+n.arrowRadius*Re(u-n.arrowAngle/2),t.moveTo(l-d,h-f),t.lineTo(i-d,s-f),t.lineTo(c-d,g-f),t.moveTo(i-d,s-f),t.lineTo(i+d,s+f),t.moveTo(i,s))}function K(e,t,r,n,a,o,i,s){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=ve),n.startArrow&&M(e,t,r,n,a,o,i,s)}function Z(e,t,r,n,a,o,i,s){n._arrowAngleConverted||(n.arrowAngle*=r._toRad,n._arrowAngleConverted=ve),n.endArrow&&M(e,t,r,n,a,o,i,s)}function ee(e,t,r,n){var a,o,i;for(a=2,K(e,t,r,n,n.x2+r.x,n.y2+r.y,n.x1+r.x,n.y1+r.y),n.x1!==we&&n.y1!==we&&t.moveTo(n.x1+r.x,n.y1+r.y);ve&&(o=n["x"+a],i=n["y"+a],o!==we&&i!==we);)t.lineTo(o+r.x,i+r.y),a+=1;a-=1,Z(e,t,r,n,n["x"+(a-1)]+r.x,n["y"+(a-1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function te(e,t,r,n){var a,o,i,s,l;for(a=2,K(e,t,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),n.x1!==we&&n.y1!==we&&t.moveTo(n.x1+r.x,n.y1+r.y);ve&&(o=n["x"+a],i=n["y"+a],s=n["cx"+(a-1)],l=n["cy"+(a-1)],o!==we&&i!==we&&s!==we&&l!==we);)t.quadraticCurveTo(s+r.x,l+r.y,o+r.x,i+r.y),a+=1;a-=1,Z(e,t,r,n,n["cx"+(a-1)]+r.x,n["cy"+(a-1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function re(e,t,r,n){var a,o,i,s,l,h,c,g;for(a=2,o=1,K(e,t,r,n,n.cx1+r.x,n.cy1+r.y,n.x1+r.x,n.y1+r.y),n.x1!==we&&n.y1!==we&&t.moveTo(n.x1+r.x,n.y1+r.y);ve&&(i=n["x"+a],s=n["y"+a],l=n["cx"+o],h=n["cy"+o],c=n["cx"+(o+1)],g=n["cy"+(o+1)],i!==we&&s!==we&&l!==we&&h!==we&&c!==we&&g!==we);)t.bezierCurveTo(l+r.x,h+r.y,c+r.x,g+r.y,i+r.x,s+r.y),a+=1,o+=2;a-=1,o-=2,Z(e,t,r,n,n["cx"+(o+1)]+r.x,n["cy"+(o+1)]+r.y,n["x"+a]+r.x,n["y"+a]+r.y)}function ne(e,t,r){return t*=e._toRad,t-=Te/2,r*Xe(t)}function ae(e,t,r){return t*=e._toRad,t-=Te/2,r*Re(t)}function oe(e,t,r,n){var a,o,i,s,l,h,c,g,d,f,u,y,v;for(r===n?(s=0,l=0):(s=r.x,l=r.y),a=1,h=g=f=y=n.x+s,c=d=u=v=n.y+l,K(e,t,r,n,h+ne(r,n.a1,n.l1),c+ae(r,n.a1,n.l1),h,c),n.x!==we&&n.y!==we&&t.moveTo(h,c);ve&&(o=n["a"+a],i=n["l"+a],o!==we&&i!==we);)f=y,u=v,y+=ne(r,o,i),v+=ae(r,o,i),1===a&&(g=y,d=v),t.lineTo(y,v),a+=1;Z(e,t,r,n,f,u,y,v)}function ie(e,t,r){isNaN(ue(r.fontSize))||(r.fontSize+="px"),t.font=r.fontStyle+" "+r.fontSize+" "+r.fontFamily}function se(e,t,r,n){var a,o,i,s=ze.propCache;if(s.text===r.text&&s.fontStyle===r.fontStyle&&s.fontSize===r.fontSize&&s.fontFamily===r.fontFamily&&s.maxWidth===r.maxWidth&&s.lineHeight===r.lineHeight)r.width=s.width,r.height=s.height;else{for(r.width=t.measureText(n[0]).width,i=1;i<n.length;i+=1)o=t.measureText(n[i]).width,o>r.width&&(r.width=o);a=e.style.fontSize,e.style.fontSize=r.fontSize,r.height=ye($.css(e,"fontSize"))*n.length*r.lineHeight,e.style.fontSize=a}}function le(e,t){var r=t.text,n=t.maxWidth,a=r.split("\n"),o=[],i,s,l,h,c,g;for(l=0;l<a.length;l+=1){if(h=a[l],c=h.split(" "),i=[],s="",1===c.length||e.measureText(h).width<n)i=[h];else{for(g=0;g<c.length;g+=1)e.measureText(s+c[g]).width>n&&(""!==s&&i.push(s),s=""),s+=c[g],g!==c.length-1&&(s+=" ");i.push(s)}o=o.concat(i.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return o}var he=e.document,ce=e.Image,ge=e.Array,de=e.getComputedStyle,fe=e.Math,ue=e.Number,ye=e.parseFloat,ve=!0,pe=!1,me=null,we=void 0,xe,be=$.extend,_e=$.inArray,Le=function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()},ke=$.isFunction,Ce=$.isPlainObject,Te=fe.PI,Se=fe.round,Pe=fe.abs,Re=fe.sin,Xe=fe.cos,Ye=fe.atan2,Oe=ge.prototype.slice,De=$.event.fix,Ae={},ze={dataCache:{},propCache:{},imageCache:{}},He={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},We={},je=["mousedown","mousemove","mouseup","mouseover","mouseout","touchstart","touchmove","touchend"],Ee={events:{},eventHooks:{},future:{}};r.baseDefaults={align:"center",arrowAngle:90,arrowRadius:0,autosave:ve,baseline:"middle",bringToFront:pe,ccw:pe,closed:pe,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:ve,crossOrigin:me,cursors:me,disableEvents:pe,draggable:pe,dragGroups:me,groups:me,data:me,dx:me,dy:me,end:360,eventX:me,eventY:me,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:ve,height:me,imageSmoothing:ve,inDegrees:ve,intangible:pe,index:me,letterSpacing:me,lineHeight:1,layer:pe,mask:pe,maxWidth:me,miterLimit:10,name:me,opacity:1,r1:me,r2:me,radius:0,repeat:"repeat",respectAlign:pe,restrictDragToAxis:null,rotate:0,rounded:pe,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:pe,shadowX:0,shadowY:0,sHeight:me,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeDash:me,strokeDashOffset:0,strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:me,sx:me,sy:me,text:"",translate:0,translateX:0,translateY:0,type:me,visible:ve,width:me,x:0,y:0},xe=new r,t.prototype=xe,Ee.extend=function Ge(e){return e.name&&(e.props&&be(xe,e.props),$.fn[e.name]=function r(n){var a=this,i,s,l,h,c;for(s=0;s<a.length;s+=1)i=a[s],l=o(i),l&&(h=new t(n),c=X(i,h,n,r),g(i,l,h),e.fn.call(i,l,h));return a},e.type&&(Ae.drawings[e.type]=e.name)),$.fn[e.name]},$.fn.getEventHooks=function Ie(){var e=this,t,r,n={};return 0!==e.length&&(t=e[0],r=v(t),n=r.eventHooks),n},$.fn.setEventHooks=function Fe(e){var t=this,r,n,a;for(n=0;n<t.length;n+=1)r=$(t[n]),a=v(t[n]),be(a.eventHooks,e);return t},$.fn.getLayers=function Be(e){var t=this,r,n,a,o,i,s=[];if(0!==t.length)if(r=t[0],n=v(r),a=n.layers,ke(e))for(i=0;i<a.length;i+=1)o=a[i],e.call(r,o)&&s.push(o);else s=a;return s},$.fn.getLayer=function Ne(e){var t=this,r,a,o,i,s,l;if(0!==t.length)if(r=t[0],a=v(r),o=a.layers,l=Le(e),e&&e.layer)i=e;else if("number"===l)0>e&&(e=o.length+e),i=o[e];else if("regexp"===l){for(s=0;s<o.length;s+=1)if(n(o[s].name)&&o[s].name.match(e)){i=o[s];break}}else i=a.layer.names[e];return i},$.fn.getLayerGroup=function Je(e){var t=this,r,n,a,o,i,s=Le(e);if(0!==t.length)if(r=t[0],"array"===s)i=e;else if("regexp"===s){n=v(r),a=n.layer.groups;for(o in a)if(o.match(e)){i=a[o];break}}else n=v(r),i=n.layer.groups[e];return i},$.fn.getLayerIndex=function $e(e){var t=this,r=t.getLayers(),n=t.getLayer(e);return _e(n,r)},$.fn.setLayer=function qe(e,t){var r=this,n,o,s,l,h,c,g;for(o=0;o<r.length;o+=1)if(n=$(r[o]),s=v(r[o]),l=$(r[o]).getLayer(e)){x(n,s,l,t),b(n,s,l,t),i(t);for(h in t)t.hasOwnProperty(h)&&(c=t[h],g=Le(c),"object"===g&&Ce(c)?(l[h]=be({},c),i(l[h])):"array"===g?l[h]=c.slice(0):"string"===g?0===c.indexOf("+=")?l[h]+=ye(c.substr(2)):0===c.indexOf("-=")?l[h]-=ye(c.substr(2)):!isNaN(c)&&a(c)?l[h]=ye(c):l[h]=c:l[h]=c);p(n,s,l),w(n,s,l),$.isEmptyObject(t)===pe&&R(n,s,l,"change",t)}return r},$.fn.setLayers=function Qe(e,t){var r=this,n,a,o,i;for(a=0;a<r.length;a+=1)for(n=$(r[a]),o=n.getLayers(t),i=0;i<o.length;i+=1)n.setLayer(o[i],e);return r},$.fn.setLayerGroup=function Ue(e,t){var r=this,n,a,o,i;for(a=0;a<r.length;a+=1)if(n=$(r[a]),o=n.getLayerGroup(e))for(i=0;i<o.length;i+=1)n.setLayer(o[i],t);return r},$.fn.moveLayer=function Ve(e,t){var r=this,n,a,o,i,s;for(a=0;a<r.length;a+=1)n=$(r[a]),o=v(r[a]),i=o.layers,s=n.getLayer(e),s&&(s.index=_e(s,i),i.splice(s.index,1),i.splice(t,0,s),0>t&&(t=i.length+t),s.index=t,R(n,o,s,"move"));return r},$.fn.removeLayer=function Me(e){var t=this,r,n,a,o,i;for(n=0;n<t.length;n+=1)r=$(t[n]),a=v(t[n]),o=r.getLayers(),i=r.getLayer(e),i&&(i.index=_e(i,o),o.splice(i.index,1),delete i._layer,x(r,a,i,{name:me}),b(r,a,i,{groups:me}),R(r,a,i,"remove"));return t},$.fn.removeLayers=function Ke(e){var t=this,r,n,a,o,i,s;for(n=0;n<t.length;n+=1){for(r=$(t[n]),a=v(t[n]),o=r.getLayers(e),s=0;s<o.length;s+=1)i=o[s],r.removeLayer(i),s-=1;a.layer.names={},a.layer.groups={}}return t},$.fn.removeLayerGroup=function Ze(e){var t=this,r,n,a,o,i,s;if(e!==we)for(n=0;n<t.length;n+=1)if(r=$(t[n]),a=v(t[n]),o=r.getLayers(),i=r.getLayerGroup(e))for(i=i.slice(0),s=0;s<i.length;s+=1)r.removeLayer(i[s]);return t},$.fn.addLayerToGroup=function et(e,t){var r=this,n,a,o,i=[t];for(a=0;a<r.length;a+=1)n=$(r[a]),o=n.getLayer(e),o.groups&&(i=o.groups.slice(0),-1===_e(t,o.groups)&&i.push(t)),n.setLayer(o,{groups:i});return r},$.fn.removeLayerFromGroup=function tt(e,t){var r=this,n,a,o,i=[],s;for(a=0;a<r.length;a+=1)n=$(r[a]),o=n.getLayer(e),o.groups&&(s=_e(t,o.groups),-1!==s&&(i=o.groups.slice(0),i.splice(s,1),n.setLayer(o,{groups:i})));return r},We.cursors=["grab","grabbing","zoom-in","zoom-out"],We.prefix=function(){var e=de(he.documentElement,""),t=(Oe.call(e).join("").match(/-(moz|webkit|ms)-/)||""===e.OLink&&["","o"])[1];return"-"+t+"-"}(),$.fn.triggerLayerEvent=function(e,t){var r=this,n,a,o;for(a=0;a<r.length;a+=1)n=$(r[a]),o=v(r[a]),e=n.getLayer(e),e&&R(n,o,e,t);return r},$.fn.drawLayer=function rt(e){var t=this,r,n,a,i;for(r=0;r<t.length;r+=1)a=$(t[r]),n=o(t[r]),n&&(i=a.getLayer(e),L(a,n,i));return t},$.fn.drawLayers=function nt(e){var t=this,r,n,a,i=e||{},l,h,c,g,d,f,u,y,p,m;for(d=i.index,d||(d=0),n=0;n<t.length;n+=1)if(r=$(t[n]),a=o(t[n])){for(u=v(t[n]),i.clear!==pe&&r.clearCanvas(),l=u.layers,g=d;g<l.length;g+=1)if(h=l[g],h.index=g,i.resetFire&&(h._fired=pe),L(r,a,h,g+1),h._masks=u.transforms.masks.slice(0),h._method===$.fn.drawImage&&h.visible){m=!0;break}if(m)break;f=g,h=_(u),y=u.event,p=y.type,u.drag.layer&&k(r,u,p),c=u.lastIntersected,c===me||h===c||!c._hovered||c._fired||u.drag.dragging||(u.lastIntersected=me,c._fired=ve,c._hovered=pe,R(r,u,c,"mouseout"),T(r,u)),h&&(h[p]||(p=E(p)),h._event&&h.intersects&&(u.lastIntersected=h,(h.mouseover||h.mouseout||h.cursors)&&!u.drag.dragging&&(h._hovered||h._fired||(h._fired=ve,h._hovered=ve,R(r,u,h,"mouseover"))),h._fired||(h._fired=ve,y.type=me,R(r,u,h,p)),!h.draggable||h.disableEvents||"mousedown"!==p&&"touchstart"!==p||(u.drag.layer=h))),h!==me||u.drag.dragging||T(r,u),f===l.length&&(u.intersecting.length=0,u.transforms=s(He),u.savedTransforms.length=0)}return t},$.fn.addLayer=function at(e){var r=this,n,a,i;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),i.layer=ve,X(r[n],i,e));return r},We.props=["width","height","opacity","lineHeight"],We.propsObj={},$.fn.animateLayer=function ot(){function e(e,t,r){return function(){Y(r),A(r),t.animating&&t.animated!==r||e.drawLayers(),r._animating=pe,t.animating=pe,t.animated=me,s[4]&&s[4].call(e[0],r),R(e,t,r,"animateend")}}function t(e,t,r){return function(n,a){var o,i,l,h=!1;"_"===a.prop[0]&&(h=!0,a.prop=a.prop.replace("_",""),r[a.prop]=r["_"+a.prop]),-1!==a.prop.indexOf(".")&&(o=a.prop.split("."),i=o[0],l=o[1],r[i]&&(r[i][l]=a.now)),r._pos!==a.pos&&(r._pos=a.pos,r._animating||t.animating||(r._animating=ve,t.animating=ve,t.animated=r),t.animating&&t.animated!==r||e.drawLayers()),s[5]&&s[5].call(e[0],n,a,r),R(e,t,r,"animate",a),h&&(a.prop="_"+a.prop)}}var r=this,n,a,i,s=Oe.call(arguments,0),l,h,c;for("object"===Le(s[2])?(s.splice(2,0,s[2].duration||me),s.splice(3,0,s[3].easing||me),s.splice(4,0,s[4].complete||me),s.splice(5,0,s[5].step||me)):(s[2]===we?(s.splice(2,0,me),s.splice(3,0,me),s.splice(4,0,me)):ke(s[2])&&(s.splice(2,0,me),s.splice(3,0,me)),s[3]===we?(s[3]=me,s.splice(4,0,me)):ke(s[3])&&s.splice(3,0,me)),a=0;a<r.length;a+=1)n=$(r[a]),i=o(r[a]),i&&(l=v(r[a]),h=n.getLayer(s[0]),h&&h._method!==$.fn.draw&&(c=be({},s[1]),c=D(r[a],h,c),O(c,ve),O(h),h.style=We.propsObj,$(h).animate(c,{duration:s[2],easing:$.easing[s[3]]?s[3]:me,complete:e(n,l,h),step:t(n,l,h)}),R(n,l,h,"animatestart")));return r},$.fn.animateLayerGroup=function it(e){var t=this,r,n,a=Oe.call(arguments,0),o,i;for(n=0;n<t.length;n+=1)if(r=$(t[n]),o=r.getLayerGroup(e))for(i=0;i<o.length;i+=1)a[0]=o[i],r.animateLayer.apply(r,a);return t},$.fn.delayLayer=function st(e,t){var r=this,n,a,o,i;for(t=t||0,a=0;a<r.length;a+=1)n=$(r[a]),o=v(r[a]),i=n.getLayer(e),i&&($(i).delay(t),R(n,o,i,"delay"));return r},$.fn.delayLayerGroup=function lt(e,t){var r=this,n,a,o,i,s;for(t=t||0,a=0;a<r.length;a+=1)if(n=$(r[a]),o=n.getLayerGroup(e))for(s=0;s<o.length;s+=1)i=o[s],n.delayLayer(i,t);return r},$.fn.stopLayer=function ht(e,t){var r=this,n,a,o,i;for(a=0;a<r.length;a+=1)n=$(r[a]),o=v(r[a]),i=n.getLayer(e),i&&($(i).stop(t),R(n,o,i,"stop"));return r},$.fn.stopLayerGroup=function ct(e,t){var r=this,n,a,o,i,s;for(a=0;a<r.length;a+=1)if(n=$(r[a]),o=n.getLayerGroup(e))for(s=0;s<o.length;s+=1)i=o[s],n.stopLayer(i,t);return r},W(["color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fillStyle","outlineColor","strokeStyle","shadowColor"]),Ae.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},Ae.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"},I(["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","touchstart","touchmove","touchend","contextmenu"]),$.event.fix=function(e){var t,r,n;return e=De.call($.event,e),r=e.originalEvent,r&&(n=r.changedTouches,e.pageX!==we&&e.offsetX===we?(t=$(e.currentTarget).offset(),t&&(e.offsetX=e.pageX-t.left,e.offsetY=e.pageY-t.top)):n&&(t=$(e.currentTarget).offset(),t&&(e.offsetX=n[0].pageX-t.left,e.offsetY=n[0].pageY-t.top))),e},Ae.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"},$.fn.draw=function gt(e){var r=this,n,a,i,s=new t(e),l;if(Ae.drawings[s.type]&&"function"!==s.type)r[Ae.drawings[s.type]](e);else for(a=0;a<r.length;a+=1)n=$(r[a]),i=o(r[a]),i&&(s=new t(e),l=X(r[a],s,e,gt),s.visible&&s.fn&&s.fn.call(r[a],i,s));return r},$.fn.clearCanvas=function dt(e){var r=this,n,a,i=new t(e),s;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i.width===me||i.height===me?(a.save(),a.setTransform(1,0,0,1,0,0),a.clearRect(0,0,r[n].width,r[n].height),a.restore()):(s=X(r[n],i,e,dt),y(r[n],a,i,i.width,i.height),a.clearRect(i.x-i.width/2,i.y-i.height/2,i.width,i.height),f(a,i)));return r},$.fn.saveCanvas=function ft(e){var r=this,n,a,i,s,h,c;for(n=0;n<r.length;n+=1)if(a=o(r[n]))for(h=v(r[n]),i=new t(e),s=X(r[n],i,e,ft),c=0;c<i.count;c+=1)l(a,h);return r},$.fn.restoreCanvas=function ut(e){var r=this,n,a,i,s,l,c;for(n=0;n<r.length;n+=1)if(a=o(r[n]))for(l=v(r[n]),i=new t(e),s=X(r[n],i,e,ut),c=0;c<i.count;c+=1)h(a,l);return r},$.fn.rotateCanvas=function yt(e){var r=this,n,a,i,s,h;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(h=v(r[n]),i=new t(e),s=X(r[n],i,e,yt),i.autosave&&l(a,h),B(a,i,h.transforms));return r},$.fn.scaleCanvas=function vt(e){var r=this,n,a,i,s,h;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(h=v(r[n]),i=new t(e),s=X(r[n],i,e,vt),i.autosave&&l(a,h),N(a,i,h.transforms));return r},$.fn.translateCanvas=function pt(e){var r=this,n,a,i,s,h;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(h=v(r[n]),i=new t(e),s=X(r[n],i,e,pt),i.autosave&&l(a,h),J(a,i,h.transforms));return r},$.fn.drawRect=function mt(e){var r=this,n,a,i,s,l,h,c,d,f,v;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,mt),i.visible&&(y(r[n],a,i,i.width,i.height),g(r[n],a,i),a.beginPath(),i.width&&i.height&&(l=i.x-i.width/2,h=i.y-i.height/2,f=Pe(i.cornerRadius),f?(c=i.x+i.width/2,d=i.y+i.height/2,i.width<0&&(v=l,l=c,c=v),i.height<0&&(v=h,h=d,d=v),0>c-l-2*f&&(f=(c-l)/2),0>d-h-2*f&&(f=(d-h)/2),a.moveTo(l+f,h),a.lineTo(c-f,h),a.arc(c-f,h+f,f,3*Te/2,2*Te,pe),a.lineTo(c,d-f),a.arc(c-f,d-f,f,0,Te/2,pe),a.lineTo(l+f,d),a.arc(l+f,d-f,f,Te/2,Te,pe),a.lineTo(l,h+f),a.arc(l+f,h+f,f,Te,3*Te/2,pe),i.closed=ve):a.rect(l,h,i.width,i.height)),F(r[n],a,i),u(r[n],a,i)));return r},$.fn.drawArc=function wt(e){var r=this,n,a,i,s;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,wt),i.visible&&(y(r[n],a,i,2*i.radius),g(r[n],a,i),a.beginPath(),V(r[n],a,i,i),F(r[n],a,i),u(r[n],a,i)));return r},$.fn.drawEllipse=function xt(e){var r=this,n,a,i,s,l,h;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,xt),i.visible&&(y(r[n],a,i,i.width,i.height),g(r[n],a,i),l=i.width*(4/3),h=i.height,a.beginPath(),a.moveTo(i.x,i.y-h/2),a.bezierCurveTo(i.x-l/2,i.y-h/2,i.x-l/2,i.y+h/2,i.x,i.y+h/2),a.bezierCurveTo(i.x+l/2,i.y+h/2,i.x+l/2,i.y-h/2,i.x,i.y-h/2),F(r[n],a,i),i.closed=ve,u(r[n],a,i)));return r},$.fn.drawPolygon=function bt(e){var r=this,n,a,i,s,l,h,c,d,f,v,p;for(n=0;n<r.length;n+=1)if(a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,bt),i.visible)){for(y(r[n],a,i,2*i.radius),g(r[n],a,i),h=2*Te/i.sides,c=h/2,l=c+Te/2,d=i.radius*Xe(c),a.beginPath(),p=0;p<i.sides;p+=1)f=i.x+i.radius*Xe(l),v=i.y+i.radius*Re(l),a.lineTo(f,v),i.concavity&&(f=i.x+(d+-d*i.concavity)*Xe(l+c),v=i.y+(d+-d*i.concavity)*Re(l+c),a.lineTo(f,v)),l+=h;F(r[n],a,i),i.closed=ve,u(r[n],a,i)}return r},$.fn.drawSlice=function _t(e){var r=this,n,a,i,s,l,h,c,d;for(a=0;a<r.length;a+=1)n=$(r[a]),i=o(r[a]),i&&(s=new t(e),l=X(r[a],s,e,_t),s.visible&&(y(r[a],i,s,2*s.radius),g(r[a],i,s),s.start*=s._toRad,s.end*=s._toRad,s.start-=Te/2,s.end-=Te/2,s.start=q(s.start),s.end=q(s.end),s.end<s.start&&(s.end+=2*Te),h=(s.start+s.end)/2,c=s.radius*s.spread*Xe(h),d=s.radius*s.spread*Re(h),s.x+=c,s.y+=d,i.beginPath(),i.arc(s.x,s.y,s.radius,s.start,s.end,s.ccw),i.lineTo(s.x,s.y),F(r[a],i,s),s.closed=ve,u(r[a],i,s)));return r},$.fn.drawLine=function Lt(e){var r=this,n,a,i,s;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,Lt),i.visible&&(y(r[n],a,i),g(r[n],a,i),a.beginPath(),ee(r[n],a,i,i),F(r[n],a,i),u(r[n],a,i)));return r},$.fn.drawQuadratic=function kt(e){var r=this,n,a,i,s;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,kt),i.visible&&(y(r[n],a,i),g(r[n],a,i),a.beginPath(),te(r[n],a,i,i),F(r[n],a,i),u(r[n],a,i)));return r},$.fn.drawBezier=function Ct(e){var r=this,n,a,i,s;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,Ct),i.visible&&(y(r[n],a,i),g(r[n],a,i),a.beginPath(),re(r[n],a,i,i),F(r[n],a,i),u(r[n],a,i)));return r},$.fn.drawVector=function Tt(e){var r=this,n,a,i,s;for(n=0;n<r.length;n+=1)a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,Tt),i.visible&&(y(r[n],a,i),g(r[n],a,i),a.beginPath(),oe(r[n],a,i,i),F(r[n],a,i),u(r[n],a,i)));return r},$.fn.drawPath=function St(e){var r=this,n,a,i,s,l,h;for(n=0;n<r.length;n+=1)if(a=o(r[n]),a&&(i=new t(e),s=X(r[n],i,e,St),i.visible)){for(y(r[n],a,i),g(r[n],a,i),a.beginPath(),l=1;ve&&(h=i["p"+l],h!==we);)h=new t(h),"line"===h.type?ee(r[n],a,i,h):"quadratic"===h.type?te(r[n],a,i,h):"bezier"===h.type?re(r[n],a,i,h):"vector"===h.type?oe(r[n],a,i,h):"arc"===h.type&&V(r[n],a,i,h),l+=1;F(r[n],a,i),u(r[n],a,i)}return r},$.fn.drawText=function Pt(e){var r=this,n,a,i,s,l,h,c,d,u,v=500,p,m,w,x,b;for(a=0;a<r.length;a+=1)if(n=$(r[a]),i=o(r[a]),i&&(s=new t(e),l=X(r[a],s,e,Pt),s.visible)){if(i.textBaseline=s.baseline,i.textAlign=s.align,ie(r[a],i,s),h=s.maxWidth!==me?le(i,s):s.text.toString().split("\n"),se(r[a],i,s,h),l&&(l.width=s.width,l.height=s.height),y(r[a],i,s,s.width,s.height),g(r[a],i,s),x=s.x,"left"===s.align?s.respectAlign?s.x+=s.width/2:x-=s.width/2:"right"===s.align&&(s.respectAlign?s.x-=s.width/2:x+=s.width/2),s.radius)for(u=ye(s.fontSize),s.letterSpacing===me&&(s.letterSpacing=u/v),d=0;d<h.length;d+=1){for(i.save(),i.translate(s.x,s.y),c=h[d],p=c.length,i.rotate(-(Te*s.letterSpacing*(p-1))/2),w=0;p>w;w+=1)m=c[w],0!==w&&i.rotate(Te*s.letterSpacing),i.save(),i.translate(0,-s.radius),i.fillText(m,0,0),i.restore();s.radius-=u,s.letterSpacing+=u/(2*v*Te),i.restore()}else for(d=0;d<h.length;d+=1)c=h[d],b=s.y+d*s.height/h.length-(h.length-1)*s.height/h.length/2,i.shadowColor=s.shadowColor,i.fillText(c,x,b),"transparent"!==s.fillStyle&&(i.shadowColor="transparent"),0!==s.strokeWidth&&i.strokeText(c,x,b);b=0,"top"===s.baseline?b+=s.height/2:"bottom"===s.baseline&&(b-=s.height/2),s._event&&(i.beginPath(),i.rect(s.x-s.width/2,s.y-s.height/2+b,s.width,s.height),F(r[a],i,s),i.closePath()),f(i,s)}return ze.propCache=s,r},$.fn.measureText=function Rt(e){var r=this,n,a,i;return a=r.getLayer(e),(!a||a&&!a._layer)&&(a=new t(e)),n=o(r[0]),n&&(ie(r[0],n,a),i=le(n,a),se(r[0],n,a,i)),a},$.fn.drawImage=function Xt(e){function r(e,t,r,n,a){n.width===me&&n.sWidth===me&&(n.width=n.sWidth=p.width),n.height===me&&n.sHeight===me&&(n.height=n.sHeight=p.height),a&&(a.width=n.width,a.height=n.height),n.sWidth!==me&&n.sHeight!==me&&n.sx!==me&&n.sy!==me?(n.width===me&&(n.width=n.sWidth),n.height===me&&(n.height=n.sHeight),n.cropFromCenter&&(n.sx+=n.sWidth/2,n.sy+=n.sHeight/2),n.sy-n.sHeight/2<0&&(n.sy=n.sHeight/2),n.sy+n.sHeight/2>p.height&&(n.sy=p.height-n.sHeight/2),n.sx-n.sWidth/2<0&&(n.sx=n.sWidth/2),n.sx+n.sWidth/2>p.width&&(n.sx=p.width-n.sWidth/2),y(e,t,n,n.width,n.height),g(e,t,n),t.drawImage(p,n.sx-n.sWidth/2,n.sy-n.sHeight/2,n.sWidth,n.sHeight,n.x-n.width/2,n.y-n.height/2,n.width,n.height)):(y(e,t,n,n.width,n.height),t.drawImage(p,n.x-n.width/2,n.y-n.height/2,n.width,n.height)),t.beginPath(),t.rect(n.x-n.width/2,n.y-n.height/2,n.width,n.height),F(e,t,n),t.closePath(),f(t,n),d(t,r,n)}function n(e,t,n,a,o){return function(){var i=$(e);r(e,t,n,a,o),a.layer?R(i,n,o,"load"):a.load&&a.load.call(i[0],o),a.layer&&(o._masks=n.transforms.masks.slice(0),a._next&&i.drawLayers({clear:pe,resetFire:ve,index:a._next}))}}var a=this,i,s,l,h,c,u,p,m,w,x=ze.imageCache;for(s=0;s<a.length;s+=1)i=a[s],l=o(a[s]),l&&(h=v(a[s]),c=new t(e),u=X(a[s],c,e,Xt),c.visible&&(w=c.source,m=w.getContext,w.src||m?p=w:w&&(x[w]&&x[w].complete?p=x[w]:(p=new ce,w.match(/^data:/i)||(p.crossOrigin=c.crossOrigin),p.src=w,x[w]=p)),p&&(p.complete||m?n(i,l,h,c,u)():(p.onload=n(i,l,h,c,u),p.src=p.src))));return a},$.fn.createPattern=function Yt(e){function r(){h=a.createPattern(s,i.repeat),i.load&&i.load.call(n[0],h)}var n=this,a,i,s,l,h,c;return a=o(n[0]),a?(i=new t(e),c=i.source,ke(c)?(s=$("<canvas />")[0],s.width=i.width,s.height=i.height,l=o(s),c.call(s,l),r()):(l=c.getContext,c.src||l?s=c:(s=new ce,c.match(/^data:/i)||(s.crossOrigin=i.crossOrigin),s.src=c),s.complete||l?r():(s.onload=r(),s.src=s.src))):h=me,h},$.fn.createGradient=function Ot(e){var r=this,n,a,i,s=[],l,h,c,g,d,f,u;if(a=new t(e),n=o(r[0])){for(a.x1=a.x1||0,a.y1=a.y1||0,a.x2=a.x2||0,a.y2=a.y2||0,i=a.r1!==me&&a.r2!==me?n.createRadialGradient(a.x1,a.y1,a.r1,a.x2,a.y2,a.r2):n.createLinearGradient(a.x1,a.y1,a.x2,a.y2),g=1;a["c"+g]!==we;g+=1)a["s"+g]!==we?s.push(a["s"+g]):s.push(me);for(l=s.length,s[0]===me&&(s[0]=0),s[l-1]===me&&(s[l-1]=1),g=0;l>g;g+=1){if(s[g]!==me){for(f=1,u=0,h=s[g],d=g+1;l>d;d+=1){if(s[d]!==me){c=s[d];break}f+=1}h>c&&(s[d]=s[g])}else s[g]===me&&(u+=1,s[g]=h+u*((c-h)/f));i.addColorStop(s[g],a["c"+(g+1)])}}else i=me;
return i},$.fn.setPixels=function Dt(e){var r=this,n,a,i,s,l,h,c,g,d,f;for(a=0;a<r.length;a+=1)if(n=r[a],i=o(n),i&&(s=new t(e),l=X(n,s,e,Dt),y(r[a],i,s,s.width,s.height),(s.width===me||s.height===me)&&(s.width=n.width,s.height=n.height,s.x=s.width/2,s.y=s.height/2),0!==s.width&&0!==s.height)){if(c=i.getImageData(s.x-s.width/2,s.y-s.height/2,s.width,s.height),g=c.data,f=g.length,s.each)for(d=0;f>d;d+=4)h={r:g[d],g:g[d+1],b:g[d+2],a:g[d+3]},s.each.call(n,h,s),g[d]=h.r,g[d+1]=h.g,g[d+2]=h.b,g[d+3]=h.a;i.putImageData(c,s.x-s.width/2,s.y-s.height/2),i.restore()}return r},$.fn.getCanvasImage=function At(e,t){var r=this,n,a=me;return 0!==r.length&&(n=r[0],n.toDataURL&&(t===we&&(t=1),a=n.toDataURL("image/"+e,t))),a},$.fn.detectPixelRatio=function zt(t){var r=this,n,a,i,s,l,h,c,g,d,f;for(i=0;i<r.length;i+=1)a=r[i],n=$(r[i]),s=o(a),f=v(r[i]),f.scaled||(l=e.devicePixelRatio||1,h=s.webkitBackingStorePixelRatio||s.mozBackingStorePixelRatio||s.msBackingStorePixelRatio||s.oBackingStorePixelRatio||s.backingStorePixelRatio||1,c=l/h,1!==c&&(g=a.width,d=a.height,a.width=g*c,a.height=d*c,a.style.width=g+"px",a.style.height=d+"px",s.scale(c,c)),f.pixelRatio=c,f.scaled=ve,t&&t.call(a,c));return r},Ee.clearCache=function Ht(){var e;for(e in ze)ze.hasOwnProperty(e)&&(ze[e]={})},$.support.canvas=$("<canvas />")[0].getContext!==we,be(Ee,{defaults:xe,setGlobalProps:g,transformShape:y,detectEvents:F,closePath:u,setCanvasFont:ie,measureText:se}),$.jCanvas=Ee,$.jCanvasObject=t});