/*
 jCanvas v6.1b
Copyright 2012, Caleb Evans
Licensed under the MIT license
*/
(function(d,R,$,P,aa,r,C,g,w){var L,M,S,T,U,V,W;function z(){}function D(c){c?y(ba,c):D.prefs=ba=z.prototype=y({},N);return this}function G(c,a){c.fillStyle=a.fillStyle;c.strokeStyle=a.strokeStyle;c.lineWidth=a.strokeWidth;a.rounded?(c.lineCap="round",c.lineJoin="round"):(c.lineCap=a.strokeCap,c.lineJoin=a.strokeJoin,c.miterLimit=a.miterLimit);c.shadowOffsetX=a.shadowX;c.shadowOffsetY=a.shadowY;c.shadowBlur=a.shadowBlur;c.shadowColor=a.shadowColor;c.globalAlpha=a.opacity;c.globalCompositeOperation=
a.compositing}function x(c){return c&&c.getContext?c.getContext("2d"):g}function J(c,a){a.closed&&c.closePath();c.fill();"transparent"!==a.fillStyle&&(c.shadowColor="transparent");c.stroke();a.closed||c.closePath();a._toRad&&c.restore();a.mask&&(a.autosave&&c.save(),c.clip())}function ca(c,a){if(!a.translateX&&!a.translateY&&(a.x||a.y))a.translateX=a.x,a.translateY=a.y;a.translate&&(a.translateX=a.translateY=a.translate);c.translate(a.translateX,a.translateY)}function da(c,a){1!==a.scale&&(a.scaleX=
a.scaleY=a.scale);c.translate(a.x,a.y);c.scale(a.scaleX,a.scaleY);c.translate(-a.x,-a.y)}function ea(c,a){a._toRad=a.inDegrees?B/180:1;a.rotate=a.rotate||a.angle;c.translate(a.x,a.y);c.rotate(a.rotate*a._toRad);c.translate(-a.x,-a.y)}function F(c,a,b,e,i){b._toRad=b.inDegrees?B/180:1;a.save();i=i||e;!c&&!b.fromCenter&&(b.x+=e/2,b.y+=i/2);(b.rotate||b.angle)&&ea(a,b);(1!==b.scale||1!==b.scaleX||1!==b.scaleY)&&da(a,b);(b.translate||b.translateX||b.translateY)&&ca(a,b)}function Q(c){var a;L===c?a=M:
((a=d.data(c,"jCanvas"))||(a=d.data(c,"jCanvas",{layers:[],intersects:[],drag:{},event:{}})),L=c,M=a);return a}function fa(c,a,b){b&&b.visible&&(b.method===d.fn.draw?b.fn.call(c[0],a):b.method&&b.method.call(c,b))}function E(c,a,b){var e,i,f,A="function"===typeof a,p,a=a||{};if(a.layer&&!a._layer){e=d(c);i=e.getLayers();A&&(a={method:d.fn.draw,fn:a});a=y(new z,a);if(!A){a.method=d.fn[a.method]||b;p=Q(c);for(f in D.events)D.events.hasOwnProperty(f)&&a[f]&&(D.events[f](e,p),a._event=r);if(a.draggable){a._event=
r;c=["mousedown","mousemove","mouseup"];for(b=0;b<c.length;b+=1)f=c[b],D.events[f](e,p);p.mouseout||(e.bind("mouseout.jCanvas",function(){p.drag={};e.drawLayers()}),p.mouseout=r)}}a.layer=r;a._layer=r;a.index===w&&(a.index=i.length);i.splice(a.index,0,a)}}function ga(c){var a;for(a=0;a<I.length;a+=1)c[I[a]]=c["_"+I[a]]}function ha(c){var a;for(a=0;a<I.length;a+=1)c["_"+I[a]]=c[I[a]],X[I[a]]=1}function ia(c){var a,b,e=[],i=1;c.match(/^#?[a-z0-9]+$/i)&&("transparent"===c&&(c="rgba(0,0,0,0)"),b=R.head,
a=b.style.color,b.style.color=c,c=d.css(b,"color"),b.style.color=a);c.match(/^rgb/i)&&(e=c.match(/[0-9]+/gi),c.match(/%/gi)&&(i=2.55),e[0]*=i,e[1]*=i,e[2]*=i,e[3]=e[3]!==w?aa(e[3]):1);return e}function la(c){var a=3,b;"object"!==typeof c.start&&(c.start=ia(c.start),c.end=ia(c.end));c.now=[];if(1!==c.start[3]||1!==c.end[3])a=4;for(b=0;b<a;b+=1)c.now[b]=c.start[b]+(c.end[b]-c.start[b])*c.pos,3>b&&(c.now[b]=O(c.now[b]));1!==c.start[3]||1!==c.end[3]?c.now="rgba("+c.now.join(",")+")":(c.now.slice(0,3),
c.now="rgb("+c.now.join(",")+")");c.elem.nodeName?c.elem.style[c.prop]=c.now:c.elem[c.prop]=c.now}function K(c){D.events[c]=function(a,b){var e="mouseover"===c||"mouseout"===c?"mousemove":c,i=b.event;b[e]||(a.bind(e+".jCanvas",function(b){i.x=b.offsetX;i.y=b.offsetY;i.type=e;a.drawLayers(r);b.preventDefault()}),b[e]=r)}}function H(c,a,b){var c=Q(c),e=c.event,a=a.isPointInPath(e.x,e.y);b.mouseX=e.x;b.mouseY=e.y;!a&&(b._hovered&&!b._fired)&&(b._mousedout=r);a&&c.intersects.push(b)}function ja(c,a,b,
e){var i,f=/\b(\d*\.?\d*)\w\w\b/gi,A;if(S===b.text&&T===b.font&&U===b.maxWidth)b.width=V,b.height=W;else{b.width=a.measureText(e[0]).width;for(i=1;i<e.length;i+=1)A=a.measureText(e[i]).width,A>b.width&&(b.width=A);a=c.style.fontSize;if(i=b.font.match(f))c.style.fontSize=b.font.match(f)[0];b.height=aa(d.css(c,"fontSize"))*e.length;c.style.fontSize=a}}var N,ba,y=d.extend,O=P.round,B=P.PI,ka=P.sin,Y=P.cos,ma=d.event.fix;W=V=U=T=S=M=L=void 0;var I,X;d.fn.jCanvas=D;D.version="6.1b";D.events={};N={angle:0,
align:"center",autosave:r,baseline:"middle",bringToFront:C,ccw:C,closed:C,compositing:"source-over",cornerRadius:0,cropFromCenter:r,draggable:C,disableDrag:C,each:g,end:360,fillStyle:"transparent",font:"12pt sans-serif",fromCenter:r,height:g,inDegrees:r,load:g,mask:C,maxWidth:g,method:g,miterLimit:10,opacity:1,projection:0,r1:g,r2:g,radius:0,repeat:"repeat",rotate:0,rounded:C,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowX:0,shadowY:0,sHeight:g,sides:3,source:"",start:0,strokeCap:"butt",
strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:g,sx:g,sy:g,text:"",translate:0,translateX:0,translateY:0,visible:r,width:g,x:0,y:0};D();D.extend=function(c){N=y(N,c.props);D();c.name&&(d.fn[c.name]=function b(e){var i,f,d,p=y(new z,e);for(f=0;f<this.length;f+=1)if(i=this[f],d=x(i))E(this[f],e,b),G(d,p),c.fn.call(i,d,p);return this});return d.fn[c.name]};d.fn.getLayers=function(){var c=this[0];return!c||!c.getContext?[]:Q(c).layers};d.fn.getLayer=function(c){var a=this.getLayers(),
b;if(!c||!c.layer){if("string"===typeof c)for(b=0;b<a.length;b+=1)if(a[b].name===c){c=b;break}c=a[c||0]}return c};d.fn.setLayer=function(c,a){var b,e;c||(a=c,c=0);for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),y(e,a);return this};d.fn.removeLayer=function(c){var a,b,e,i,f=typeof c;for(a=0;a<this.length;a+=1){b=d(this[a]).getLayers();if("string"===f)for(i=0;i<b.length;i+=1){if(b[i].name===c){e=i;break}}else e="number"===f?c:"";b[e]&&b.splice(e,1)}return this};d.fn.removeLayers=function(){var c,
a;for(a=0;a<this.length;a+=1)c=d(this[a]).getLayers(),c.length=0;return this};d.fn.getLayerGroup=function(c){var a=this.getLayers(),b=[],e;if(c!==w)for(e=0;e<a.length;e+=1)a[e].group===c&&b.push(a[e]);return b};d.fn.setLayerGroup=function(c,a){var b,e,i;for(b=0;b<this.length;b+=1){e=d(this[b]).getLayers();for(i=0;i<e.length;i+=1)e[i].group===c&&y(e[i],a)}return this};d.fn.removeLayerGroup=function(c){var a,b,e;if(c!==w)for(a=0;a<this.length;a+=1){b=d(this[a]).getLayers();for(e=0;e<b.length;e+=1)b[e].group===
c&&(b.splice(e,1),e-=1)}return this};d.fn.drawLayer=function(c){var a,b,e,i;for(a=0;a<this.length;a+=1)e=d(this[a]),b=x(this[a]),i=e.getLayer(c),fa(e,b,i);return this};d.fn.drawLayers=function(c){var a,b,e,i,f,A,p;for(b=0;b<this.length;b+=1)if(a=d(this[b]),e=x(this[b])){e.clearRect(0,0,this[b].width,this[b].height);L===this[b]?p=M:(p=Q(this[b]),L=this[b],M=p);i=p.layers;for(A=0;A<i.length;A+=1)if(f=i[A],f.index=A,c&&(f._fired=C),fa(a,e,f),f._mousedout)f._mousedout=C,f._fired=r,f._hovered=C,f.mouseout&&
f.mouseout.call(this[b],f);f=p.intersects[p.intersects.length-1]||{};a=p.event;a=a.type;A=f[a];e=p.drag;if(f._event){if((f.mouseover||f.mouseout)&&!f._hovered&&!f._fired)f._fired=r,f._hovered=r,f.mouseover&&f.mouseover.call(this[b],f);A&&!f._fired&&(f._fired=r,A.call(this[b],f));f.draggable&&(!f.disableDrag&&"mousedown"===a)&&(f.bringToFront&&(i.splice(f.index,1),f.index=i.push(f)),e.layer=f,e.dragging=r,e.startX=f.x,e.startY=f.y,e.endX=f.mouseX,e.endY=f.mouseY,f.dragstart&&f.dragstart.call(this[b],
f))}if(e.layer&&(e.dragging&&"mouseup"===a&&(e.layer.dragstop&&e.layer.dragstop.call(this[b],e.layer),p.drag={}),e.dragging&&"mousemove"===a))e.layer.x=e.layer.mouseX-(e.endX-e.startX),e.layer.y=e.layer.mouseY-(e.endY-e.startY),e.layer.drag&&e.layer.drag.call(this[b],e.layer)}p.intersects=[];return this};d.fn.addLayer=function(c){var a,b,c=c||{};for(a=0;a<this.length;a+=1)if(b=x(this[a]))c.layer=r,E(this[a],c);return this};I=["width","height","opacity"];X={};d.fn.animateLayer=function(){function c(a,
b){return function(){ga(b);a.drawLayers();f[4]&&f[4].call(a[0],b)}}function a(a,b){return function(c,e){ga(b);a.drawLayers();f[5]&&f[5].call(a[0],c,e,b)}}var b,e,i,f=[].slice.call(arguments,0);"object"===typeof f[0]&&!f[0].layer&&f.unshift(0);"object"===typeof f[2]?(f.splice(2,0,f[2].duration||g),f.splice(3,0,f[3].easing||g),f.splice(4,0,f[4].complete||g),f.splice(5,0,f[5].step||g)):(f[2]===w?(f.splice(2,0,g),f.splice(3,0,g),f.splice(4,0,g)):"function"===typeof f[2]&&(f.splice(2,0,g),f.splice(3,0,
g)),f[3]===w)?(f[3]=g,f.splice(4,0,g)):"function"===typeof f[3]&&f.splice(3,0,g);for(e=0;e<this.length;e+=1)if(b=d(this[e]),i=x(this[e]))if((i=b.getLayer(f[0]))&&i.method!==d.fn.draw)ha(i),ha(f[1]),i.style=X,d(i).animate(f[1],{duration:f[2],easing:d.easing[f[3]]?f[3]:g,complete:c(b,i),step:a(b,i)});return this};d.fn.animateLayerGroup=function(c){var a,b,e=[].slice.call(arguments,0),i,f;for(b=0;b<this.length;b+=1){a=d(this[b]);i=a.getLayerGroup(c);for(f=0;f<i.length;f+=1)a.animateLayer.apply(a,[i[f]].concat(e.slice(1)))}};
d.fn.delayLayer=function(c,a){var b,e,a=a||0;for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),d(e).delay(a);return this};d.fn.delayLayerGroup=function(c,a){var b,e,i,f,a=a||0;for(e=0;e<this.length;e+=1){b=d(this[e]);i=b.getLayerGroup(c);for(f=0;f<i.length;f+=1)b.delayLayer.call(b,c,a)}};d.fn.stopLayer=function(c,a){var b,e;for(b=0;b<this.length;b+=1)e=d(this[b]).getLayer(c),d(e).stop(a);return this};d.fn.stopLayerGroup=function(c,a){var b,e,i,f;for(e=0;e<this.length;e+=1){b=d(this[e]);i=b.getLayerGroup(c);
for(f=0;f<i.length;f+=1)b.stopLayer.call(b,c,a)}};(function(c){var a;for(a=0;a<c.length;a+=1)d.fx.step[c[a]]=la})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));K("click");K("dblclick");K("mousedown");K("mouseup");K("mousemove");K("mouseover");K("mouseout");d.event.fix=function(c){var a,c=ma.call(d.event,c);if(c.pageX!==w&&c.offsetX===w&&(a=d(c.target).offset()))c.offsetX=c.pageX-a.left,
c.offsetY=c.pageY-a.top;return c};d.fn.draw=function a(b){var e,i,b=b||{};"function"===typeof b&&(b={fn:b});for(e=0;e<this.length;e+=1)if((i=x(this[e]))&&b.fn)E(this[e],b,a),b.fn.call(this[e],i);return this};d.fn.clearCanvas=function(a){for(var b,e=y(new z,a),a=0;a<this.length;a+=1)if(b=x(this[a]))F(a,b,e,e.width,e.height),!e.x||!e.y||!e.width||!e.height?b.clearRect(0,0,this[a].width,this[a].height):b.clearRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height);return this};d.fn.saveCanvas=function(){var a,
b;for(a=0;a<this.length;a+=1)(b=x(this[a]))&&b.save();return this};d.fn.restoreCanvas=function(){var a,b;for(a=0;a<this.length;a+=1)(b=x(this[a]))&&b.restore();return this};d.fn.translateCanvas=function(a){for(var b,e=y(new z,a),a=0;a<this.length;a+=1)if(b=x(this[a]))e.autosave&&b.save(),ca(b,e);return this};d.fn.scaleCanvas=function(a){for(var b,e=y(new z,a),a=0;a<this.length;a+=1)if(b=x(this[a]))e.autosave&&b.save(),da(b,e);return this};d.fn.rotateCanvas=function(a){for(var b,e=y(new z,a),a=0;a<
this.length;a+=1)if(b=x(this[a]))e.autosave&&b.save(),ea(b,e);return this};d.fn.drawRect=function b(e){var i,f,d=y(new z,e),p,g,s,q,k;for(i=0;i<this.length;i+=1)if(f=x(this[i]))E(this[i],e,b),G(f,d),F(i,f,d,d.width,d.height),f.beginPath(),p=d.x-d.width/2,g=d.y-d.height/2,(k=d.cornerRadius)?(d.closed=r,s=d.x+d.width/2,q=d.y+d.height/2,0>s-p-2*k&&(k=(s-p)/2),0>q-g-2*k&&(k=(q-g)/2),f.moveTo(p+k,g),f.lineTo(s-k,g),f.arc(s-k,g+k,k,3*B/2,2*B,C),f.lineTo(s,q-k),f.arc(s-k,q-k,k,0,B/2,C),f.lineTo(p+k,q),f.arc(p+
k,q-k,k,B/2,B,C),f.lineTo(p,g+k),f.arc(p+k,g+k,k,B,3*B/2,C)):f.rect(p,g,d.width,d.height),d._event&&H(this[i],f,e),J(f,d);return this};d.fn.drawArc=function e(d){var f,g,p=y(new z,d),d=d||{};!p.inDegrees&&360===p.end&&(d.end=p.end=2*B);for(f=0;f<this.length;f+=1)if(g=x(this[f]))E(this[f],d,e),G(g,p),F(f,g,p,2*p.radius),g.beginPath(),g.arc(p.x,p.y,p.radius,p.start*p._toRad-B/2,p.end*p._toRad-B/2,p.ccw),p._event&&H(this[f],g,d),J(g,p);return this};d.fn.drawEllipse=function i(f){var d,g,u=y(new z,f),
s=4*u.width/3,q=u.height;u.closed=r;for(d=0;d<this.length;d+=1)if(g=x(this[d]))E(this[d],f,i),G(g,u),F(d,g,u,u.width,u.height),g.beginPath(),g.moveTo(u.x,u.y-q/2),g.bezierCurveTo(u.x-s/2,u.y-q/2,u.x-s/2,u.y+q/2,u.x,u.y+q/2),g.bezierCurveTo(u.x+s/2,u.y+q/2,u.x+s/2,u.y-q/2,u.x,u.y-q/2),u._event&&H(this[d],g,f),J(g,u);return this};d.fn.drawPolygon=function f(d){var g,u,s=y(new z,d),q=2*B/s.sides,k=B/s.sides,l=k+B/2,m=s.radius*Y(q/2),n,o,j;s.closed=r;for(g=0;g<this.length;g+=1)if(u=x(this[g])){E(this[g],
d,f);G(u,s);F(g,u,s,2*s.radius);u.beginPath();for(j=0;j<s.sides;j+=1)n=s.x+O(s.radius*Y(l)),o=s.y+O(s.radius*ka(l)),u.lineTo(n,o),s.projection&&(n=s.x+O((m+m*s.projection)*Y(l+k)),o=s.y+O((m+m*s.projection)*ka(l+k)),u.lineTo(n,o)),l+=q;s._event&&H(this[g],u,d);J(u,s)}return this};d.fn.drawLine=function A(d){var g,s,q=y(new z,d),k,l,m;for(g=0;g<this.length;g+=1)if(s=x(this[g])){E(this[g],d,A);G(s,q);F(g,s,q,0);k=1;for(s.beginPath();r;)if(l=q["x"+k],m=q["y"+k],l!==w&&m!==w)s.lineTo(l,m),k+=1;else break;
q._event&&H(this[g],s,d);J(s,q)}return this};d.fn.drawQuad=function p(d){var g,q,k=y(new z,d),l,m,n,o,j;for(g=0;g<this.length;g+=1)if(q=x(this[g])){E(this[g],d,p);G(q,k);F(g,q,k,0);l=2;q.beginPath();for(q.moveTo(k.x1,k.y1);r;)if(m=k["x"+l],n=k["y"+l],o=k["cx"+(l-1)],j=k["cy"+(l-1)],m!==w&&n!==w&&o!==w&&j!==w)q.quadraticCurveTo(o,j,m,n),l+=1;else break;k._event&&H(this[g],q,d);J(q,k)}return this};d.fn.drawBezier=function u(d){var g,k,l=y(new z,d),m,n,o,j,h,t,v,Z;for(g=0;g<this.length;g+=1)if(k=x(this[g])){E(this[g],
d,u);G(k,l);F(g,k,l,0);m=2;n=1;k.beginPath();for(k.moveTo(l.x1,l.y1);r;)if(o=l["x"+m],j=l["y"+m],h=l["cx"+n],t=l["cy"+n],v=l["cx"+(n+1)],Z=l["cy"+(n+1)],o!==w&&j!==w&&h!==w&&t!==w&&v!==w&&Z!==w)k.bezierCurveTo(h,t,v,Z,o,j),m+=1,n+=2;else break;l._event&&H(this[g],k,d);J(k,l)}return this};d.fn.drawText=function s(q){var k,l,m=y(new z,q),n,o,j;for(k=0;k<this.length;k+=1)if(d(this[k]),l=x(this[k])){E(this[k],q,s);G(l,m);l.textBaseline=m.baseline;l.textAlign=m.align;l.font=m.font;if(!k&&m.maxWidth!==
g){n=l;o=m.text;j=m.maxWidth;var h=m.text.split(" "),t=[],v="";if(n.measureText(o).width<j)t=[o];else for(;0<h.length;)n.measureText(v+h[0]).width<j?v+=h.shift()+" ":(t.push(v),v=""),0===h.length&&t.push(v);n=t;n=n.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n")}else k||(n=m.text.split("\n"));ja(this[k],l,m,n);F(k,l,m,m.width,m.height);k||(m.y-=(n.length-1)*m.height/n.length/2);for(o=0;o<n.length;o+=1)j=m.y+o*m.height/n.length,l.fillText(n[o],m.x,j),"transparent"!==m.fillStyle&&(l.shadowColor=
"transparent"),l.strokeText(n[o],m.x,j);m._event?(l.beginPath(),l.rect(m.x-m.width/2,m.y-m.height/2,m.width,m.height),l.restore(),H(this[k],l,q),l.closePath()):l.restore()}S=m.text;T=m.font;V=m.width;U=m.maxWidth;W=m.height;return this};d.fn.measureText=function(d){var g;g=d!==w&&"object"!==typeof d?this.getLayer(d):y(new z,d);(d=x(this[0]))&&g.text!==w&&ja(this[0],d,g,g.text.split("\n"));return g};d.fn.drawImage=function q(d){function l(l,q,j){return function(){q||((r=t.width/t.height,h.width===
g&&h.sWidth===g&&(d.width=h.width=h.sWidth=t.width),h.height===g&&h.sHeight===g&&(d.height=h.height=h.sHeight=t.height),h.width===g&&h.sWidth!==g&&(h.width=h.sWidth),h.height===g&&h.sHeight!==g&&(h.height=h.sHeight),h.sWidth===g&&h.width!==g&&(d.sWidth=h.sWidth=t.width),h.sHeight===g&&h.height!==g&&(d.sHeight=h.sHeight=t.height),h.sx===g&&(h.sx=h.cropFromCenter?t.width/2:0),h.sy===g&&(h.sy=h.cropFromCenter?t.height/2:0),h.cropFromCenter||(h.sx+=h.sWidth/2,h.sy+=h.sHeight/2),h.sx+h.sWidth/2>t.width&&
(h.sx=t.width-h.sWidth/2),0>h.sx-h.sWidth/2&&(h.sx=h.sWidth/2),0>h.sy-h.sHeight/2&&(h.sy=h.sHeight/2),h.sy+h.sHeight/2>t.height&&(h.sy=t.height-h.sHeight/2),h.width!==g&&h.height===g)?d.height=h.height=h.width/r:h.width===g&&h.height!==g?d.width=h.width=h.height*r:h.width===g&&h.height===g&&(d.width=h.width=t.width,d.height=h.height=t.height));F(q,j,h,h.width,h.height);j.drawImage(t,h.sx-h.sWidth/2,h.sy-h.sHeight/2,h.sWidth,h.sHeight,h.x-h.width/2,h.y-h.height/2,h.width,h.height);h._event?(j.beginPath(),
j.rect(h.x-h.width/2,h.y-h.height/2,h.width,h.height),j.restore(),H(m[q],j,d),j.closePath()):j.restore();h.load&&h.load.call(l,d)}}var m=this,n,o,j,h=y(new z,d),t,v,r;v=h.source.getContext;h.source.src||v?(t=h.source,h.width=t.width,h.height=t.height):h.source&&(t=new $,t.src=h.source);for(o=0;o<m.length;o+=1)if(n=m[o],j=x(m[o]))E(m[o],d,q),G(j,h),t&&(t.complete||v?l(n,o,j)():t.onload=l(n,o,j));return m};d.fn.createPattern=d.fn.pattern=function(d){function k(){j=m.createPattern(o,n.repeat);n.load&&
n.load.call(l[0],j)}var l=this,m,n=y(new z,d),o,j;(m=x(l[0]))?"function"===typeof n.source?(o=R.createElement("canvas"),o.width=n.width,o.height=n.height,d=x(o),n.source.call(o,d),k()):(d=n.source.getContext,n.source.src||d?o=n.source:(o=new $,o.src=n.source),o.complete||d?k():o.onload=k):j=g;return j};d.fn.createGradient=d.fn.gradient=function(d){var k,d=y(new z,d),l=[],m,n,o,j,h,t,v;if(k=x(this[0])){d.x1=d.x1||0;d.y1=d.y1||0;d.x2=d.x2||0;d.y2=d.y2||0;k=d.r1!==g||d.r2!==g?k.createRadialGradient(d.x1,
d.y1,d.r1,d.x2,d.y2,d.r2):k.createLinearGradient(d.x1,d.y1,d.x2,d.y2);for(j=1;d["c"+j]!==w;j+=1)d["s"+j]!==w?l.push(d["s"+j]):l.push(g);m=l.length;l[0]===g&&(l[0]=0);l[m-1]===g&&(l[m-1]=1);for(j=0;j<m;j+=1){if(l[j]!==g){t=1;v=0;n=l[j];for(h=j+1;h<m;h+=1)if(l[h]!==g){o=l[h];break}else t+=1;n>o&&(l[h]=l[j])}else l[j]===g&&(v+=1,l[j]=n+v*((o-n)/t));k.addColorStop(l[j],d["c"+(j+1)])}}else k=g;return k};d.fn.setPixels=function k(d){var g,n,o,j=y(new z,d),h={},t,v,r,w;for(n=0;n<this.length;n+=1)if(g=this[n],
o=x(g)){E(this[n],d,k);F(n,o,j,j.width,j.height);if(!j.x||!j.y||!j.width||!j.height)j.width=g.width,j.height=g.height,j.x=j.width/2,j.y=j.height/2;t=o.getImageData(j.x-j.width/2,j.y-j.height/2,j.width,j.height);v=t.data;w=v.length;h=[];if(j.each)for(r=0;r<w;r+=4)h.r=v[r],h.g=v[r+1],h.b=v[r+2],h.a=v[r+3],j.each.call(g,h),v[r]=h.r,v[r+1]=h.g,v[r+2]=h.b,v[r+3]=h.a;o.putImageData(t,j.x-j.width/2,j.y-j.height/2);o.restore()}return this};d.fn.getCanvasImage=function(d,l){var m=this[0];return m&&m.toDataURL?
m.toDataURL("image/"+d,l):g};d.support.canvas=R.createElement("canvas").getContext!==w;D.defaults=N;d.jCanvas=D})(jQuery,document,Image,Math,parseFloat,!0,!1,null);
