/*
jCanvas v3.1b
Caleb Evans
*/
(function(d,a,c,e){function b(f,g){if(f===e){b.prefs=b.defaults}else{if(g===true){b.defaults=d.extend({},b.defaults,f);b.prefs=d.extend({},b.defaults)}else{b.prefs=d.extend({},b.prefs,f)}}return this}(function(f){f.defaults={width:0,height:0,cornerRadius:0,fillStyle:"transparent",strokeStyle:"transparent",strokeWidth:1,strokeCap:"butt",strokeJoin:"miter",shadowX:0,shadowY:0,shadowBlur:3,shadowColor:"transparent",opacity:1,compositing:"source-over",mask:false,x:0,y:0,x1:0,y1:0,x2:0,y2:0,r1:10,r2:100,radius:0,start:0,end:360,ccw:false,inDegrees:true,fromCenter:true,closed:false,sides:3,angle:0,text:"",font:"normal 12pt sans-serif",align:"center",baseline:"middle",source:"",repeat:"repeat"};f.prefs=d.extend({},f.defaults);f.setGlobals=function(g,h){g.fillStyle=h.fillColor||h.fillStyle;g.strokeStyle=h.strokeColor||h.strokeStyle;g.lineWidth=h.strokeWidth;g.lineCap=h.strokeCap;g.lineJoin=h.strokeJoin;g.shadowOffsetX=h.shadowX;g.shadowOffsetY=h.shadowY;g.shadowBlur=h.shadowBlur;g.shadowColor=h.shadowColor;g.globalAlpha=h.globalAlpha||h.opacity;g.globalCompositeOperation=h.compositing};f.closePath=function(g,h){if(h.mask===true){g.save();g.clip()}if(h.closed===true){g.closePath();g.fill();g.stroke()}else{g.fill();g.stroke();g.closePath()}};f.checkUnits=function(g){if(g.inDegrees===true){return c.PI/180}else{return 1}};f.rotate=function(h,j,i,g){if(j.fromCenter===false){j.x+=i/2;j.y+=g/2}j.toRad=f.checkUnits(j);h.save();h.translate(j.x,j.y);h.rotate(j.angle*j.toRad);h.translate(-j.x,-j.y)};d.fn.loadCanvas=function(g){return this[0].getContext("2d")};d.fn.draw=function(i){var g,h;for(h=0;h<this.length;h+=1){g=this[h].getContext("2d");i.call(this[h],g)}};d.fn.gradient=function(h){var g=this.loadCanvas(),n=d.extend({},f.prefs,h),m,l=0,k,j=1;if(h.r1===e&&h.r2===e){m=g.createLinearGradient(n.x1,n.y1,n.x2,n.y2)}else{m=g.createRadialGradient(n.x1,n.y1,n.r1,n.x2,n.y2,n.r2)}while(n["c"+j]!==e){l+=1;j+=1}for(j=1;j<=l;j+=1){k=c.round((l-1)*(j-1));if(n["s"+j]===e){n["s"+j]=k}m.addColorStop(n["s"+j],n["c"+j])}return m};d.fn.pattern=function(i){var g=this.loadCanvas(),m=d.extend({},f.prefs,i),k,h=a.createElement("img");h.src=m.source;function j(){if(h.complete===true){k=g.createPattern(h,m.repeat);return true}else{return false}}function l(){j();if(m.load){m.load(k)}}if(m.load){h.onload=l}else{if(j()===false){h.onload=l}}return k};d.fn.clearCanvas=function(h){var g,i,j=d.extend({},f.prefs,h);if(j.fromCenter===true){j.x-=j.width/2;j.y-=j.height/2}for(i=0;i<this.length;i+=1){g=this[i].getContext("2d");f.setGlobals(g,j);g.beginPath();if(h===e){g.clearRect(0,0,this.width(),this.height())}else{g.clearRect(j.x,j.y,j.width||this.width(),j.height||this.height())}g.closePath()}return this};d.fn.saveCanvas=function(){var g,h;for(h=0;h<this.length;h+=1){g=this[h].getContext("2d");g.save()}return this};d.fn.restoreCanvas=function(){var g,h;for(h=0;h<this.length;h+=1){g=this[h].getContext("2d");g.restore()}return this};d.fn.scaleCanvas=function(h){var g,i,j=d.extend({},f.prefs,h);for(i=0;i<this.length;i+=1){g=this[i].getContext("2d");g.save();g.translate(j.x,j.y);g.scale(j.width,j.height);g.translate(-j.x,-j.y)}return this};d.fn.translateCanvas=function(h){var g,i,j=d.extend({},f.prefs,h);for(i=0;i<this.length;i+=1){g=this[i].getContext("2d");g.save();g.translate(j.x,j.y)}return this};d.fn.rotateCanvas=function(h){var g,i,j=d.extend({},f.prefs,h);j.toRad=f.checkUnits(j);for(i=0;i<this.length;i+=1){g=this[i].getContext("2d");g.save();g.translate(j.x,j.y);g.rotate(j.angle*j.toRad);g.translate(-j.x,-j.y)}return this};d.fn.drawRect=function(l){var o,k,j=d.extend({},f.prefs,l),i,n,h,m,g;for(k=0;k<this.length;k+=1){o=this[k].getContext("2d");f.setGlobals(o,j);f.rotate(o,j,j.width,j.height);if(j.cornerRadius>0){i=j.x;n=j.y;h=j.x+j.width;m=j.y+j.height;g=j.cornerRadius;if((h-i)-(2*g)<0){g=(h-i)/2}if((m-n)-(2*g)<0){g=(m-n)/2}o.beginPath();o.moveTo(i+g,n);o.lineTo(h-g,n);o.arc(h-g,n+g,g,270*j.toRad,360*j.toRad,false);o.lineTo(h,m-g);o.arc(h-g,m-g,g,0,90*j.toRad,false);o.lineTo(i+g,m);o.arc(i+g,m-g,g,90*j.toRad,180*j.toRad,false);o.lineTo(i,n+g);o.arc(i+g,n+g,g,180*j.toRad,270*j.toRad,false);o.fill();o.stroke();o.closePath()}else{o.beginPath();o.rect(j.x-j.width/2,j.y-j.height/2,j.width,j.height);o.fill();o.stroke();o.restore()}}return this};d.fn.drawArc=function(h){var g,i,j=d.extend({},f.prefs,h);if(j.inDegrees===false&&j.end===360){j.end*=c.PI/180}for(i=0;i<this.length;i+=1){g=this[i].getContext("2d");f.setGlobals(g,j);f.rotate(g,j,j.radius,j.radius);g.beginPath();g.arc(j.x,j.y,j.radius,(j.start*j.toRad)-(c.PI/2),(j.end*j.toRad)-(c.PI/2),j.ccw);f.closePath(g,j);g.restore()}return this};d.fn.drawEllipse=function(h){var g,j,k=d.extend({},f.prefs,h),i=k.width*(4/3);for(j=0;j<this.length;j+=1){g=this[j].getContext("2d");f.setGlobals(g,k);f.rotate(g,k,k.width,k.height);g.beginPath();g.moveTo(k.x,k.y-k.height/2);g.bezierCurveTo(k.x-i/2,k.y-k.height/2,k.x-i/2,k.y+k.height/2,k.x,k.y+k.height/2);g.bezierCurveTo(k.x+i/2,k.y+k.height/2,k.x+i/2,k.y-k.height/2,k.x,k.y-k.height/2);g.closePath();g.fill();g.stroke();g.restore()}return this};d.fn.drawLine=function(i){var h,m,n=d.extend({},f.prefs,i),g=2,k=0,j=0;for(m=0;m<this.length;m+=1){h=this[m].getContext("2d");f.setGlobals(h,n);h.beginPath();h.moveTo(n.x1,n.y1);while(1){k=n["x"+g];j=n["y"+g];if(k!==e&&j!==e){h.lineTo(k,j)}else{break}g+=1}f.closePath(h,n)}return this};d.fn.drawQuad=function(m){var p,k,j=d.extend({},f.prefs,m),i=2,h=0,g=0,o=0,n=0;for(k=0;k<this.length;k+=1){p=this[k].getContext("2d");f.setGlobals(p,j);p.beginPath();p.moveTo(j.x1,j.y1);while(1){h=j["x"+i];g=j["y"+i];o=j["cx"+(i-1)];n=j["cy"+(i-1)];if(h!==e&&g!==e&&o!==e&&n!==e){p.quadraticCurveTo(o,n,h,g)}else{break}i+=1}f.closePath(p,j)}return this};d.fn.drawBezier=function(r){var s,q,n=d.extend({},f.prefs,r),m=2,i=1,k=0,j=0,p=0,h=0,o=0,g=0;for(q=0;q<this.length;q+=1){s=this[q].getContext("2d");f.setGlobals(s,n);s.beginPath();s.moveTo(n.x1,n.y1);while(1){k=n["x"+m];j=n["y"+m];p=n["cx"+i];h=n["cy"+i];o=n["cx"+(i+1)];g=n["cy"+(i+1)];if(k!==e&&j!==e&&p!==e&&h!==e&&o!==e&&g!==e){s.bezierCurveTo(p,h,o,g,k,j)}else{break}m+=1;i+=2}f.closePath(s,n)}return this};d.fn.drawText=function(h){var g,i,j=d.extend({},f.prefs,h);for(i=0;i<this.length;i+=1){g=this[i].getContext("2d");f.setGlobals(g,j);g.textBaseline=j.baseline;g.textAlign=j.align;g.font=j.font;g.strokeText(j.text,j.x,j.y);g.fillText(j.text,j.x,j.y)}return this};d.fn.drawImage=function(k){var h,m,n=d.extend({},f.prefs,k),i=a.createElement("img"),j;i.src=n.source;function g(o){if(i.complete===true){j=i.width/i.height;if(k.width!==e&&k.height!==e){i.width=k.width;i.height=k.height}else{if(k.width!==e&&k.height===e){i.width=k.width;i.height=i.width/j}else{if(k.width===e&&k.height!==e){i.height=k.height;i.width=i.height*j}}}f.rotate(o,n,i.width,i.height);o.drawImage(i,n.x-i.width/2,n.y-i.height/2,i.width,i.height);o.restore();return true}else{return false}}function l(){g(h);if(n.load){n.load()}}for(m=0;m<this.length;m+=1){h=this[m].getContext("2d");f.setGlobals(h,n);if(n.load){i.onload=l}else{if(g(h)===false){i.onload=l}}}return this};d.fn.drawPolygon=function(l){var p,k,h=d.extend({},f.prefs,l),g,o,n,m,j;h.closed=true;g=(c.PI/2)+(c.PI/h.sides);o=(c.PI*2)/h.sides;for(k=0;k<this.length;k+=1){p=this[k].getContext("2d");f.setGlobals(p,h);if(h.sides>=3){f.rotate(p,h,h.radius,h.radius);p.beginPath();for(j=0;j<h.sides;j+=1){n=h.x+(h.radius*c.cos(g));m=h.y+(h.radius*c.sin(g));if(j===0){p.moveTo(n,m)}else{p.lineTo(n,m)}g+=o}f.closePath(p,h);p.restore()}}return this};d.fn.setPixels=function(o){var r=this.loadCanvas(),h,n,l,j=d.extend({},f.prefs,o),g,k,m,q;for(n=0;n<this.length;n+=1){try{h=this[n];r=h.getContext("2d");g=r.getImageData(j.x,j.y,j.width||h.width,j.height||h.height);k=g.data;m=k.length;q=[];if(j.each!==e){for(l=0;l<m;l+=4){q=j.each.call(h,k[l],k[l+1],k[l+2],k[l+3]);k[l]=q[0];k[l+1]=q[1];k[l+2]=q[2];k[l+3]=q[3]}}r.putImageData(g,j.x,j.y)}catch(p){}}return this};f.retrofit=function(){d.fn.drawQuadCurve=d.fn.drawQuad;d.fn.drawBezierCurve=d.fn.drawBezier;d.fn.canvasDefaults=f;d.fn.canvas=f;return d};return(d.jCanvas=f)}(b))}(jQuery,document,Math));